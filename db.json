{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"source/CNAME","path":"CNAME","modified":0,"renderable":0},{"_id":"source/README.MD","path":"README.MD","modified":0,"renderable":0},{"_id":"themes/next/source/404.html","path":"404.html","modified":0,"renderable":1},{"_id":"source/images/picture.jpg","path":"images/picture.jpg","modified":0,"renderable":0},{"_id":"themes/next/source/css/main.styl","path":"css/main.styl","modified":0,"renderable":1},{"_id":"themes/next/source/images/algolia_logo.svg","path":"images/algolia_logo.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/apple-touch-icon-next.png","path":"images/apple-touch-icon-next.png","modified":0,"renderable":1},{"_id":"themes/next/source/images/avatar.gif","path":"images/avatar.gif","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","path":"images/cc-by-nc-nd.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","path":"images/cc-by-nc-sa.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc.svg","path":"images/cc-by-nc.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-nd.svg","path":"images/cc-by-nd.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-sa.svg","path":"images/cc-by-sa.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by.svg","path":"images/cc-by.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-zero.svg","path":"images/cc-zero.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/favicon-16x16-next.png","path":"images/favicon-16x16-next.png","modified":0,"renderable":1},{"_id":"themes/next/source/images/loading.gif","path":"images/loading.gif","modified":0,"renderable":1},{"_id":"themes/next/source/images/favicon-32x32-next.png","path":"images/favicon-32x32-next.png","modified":0,"renderable":1},{"_id":"themes/next/source/images/logo.svg","path":"images/logo.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/placeholder.gif","path":"images/placeholder.gif","modified":0,"renderable":1},{"_id":"themes/next/source/images/picture.jpg","path":"images/picture.jpg","modified":0,"renderable":1},{"_id":"themes/next/source/images/quote-r.svg","path":"images/quote-r.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/searchicon.png","path":"images/searchicon.png","modified":0,"renderable":1},{"_id":"themes/next/source/images/quote-l.svg","path":"images/quote-l.svg","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/algolia-search.js","path":"js/src/algolia-search.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/affix.js","path":"js/src/affix.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/bootstrap.js","path":"js/src/bootstrap.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/codescrollbar.js","path":"js/src/codescrollbar.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/custom.js","path":"js/src/custom.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/customeFlipClock.js","path":"js/src/customeFlipClock.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/exturl.js","path":"js/src/exturl.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/function.js","path":"js/src/function.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/hook-duoshuo.js","path":"js/src/hook-duoshuo.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/js.cookie.js","path":"js/src/js.cookie.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/love.js","path":"js/src/love.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/motion.js","path":"js/src/motion.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/post-details.js","path":"js/src/post-details.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/scroll-cookie.js","path":"js/src/scroll-cookie.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/scrollspy.js","path":"js/src/scrollspy.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/utils.js","path":"js/src/utils.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.css","path":"lib/algolia-instant-search/instantsearch.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/canvas-nest/canvas-nest.min.js","path":"lib/canvas-nest/canvas-nest.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/canvas-ribbon/canvas-ribbon.js","path":"lib/canvas-ribbon/canvas-ribbon.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fastclick/LICENSE","path":"lib/fastclick/LICENSE","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fastclick/README.md","path":"lib/fastclick/README.md","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fastclick/bower.json","path":"lib/fastclick/bower.json","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/HELP-US-OUT.txt","path":"lib/font-awesome/HELP-US-OUT.txt","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/bower.json","path":"lib/font-awesome/bower.json","modified":0,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/CONTRIBUTING.md","path":"lib/jquery_lazyload/CONTRIBUTING.md","modified":0,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/README.md","path":"lib/jquery_lazyload/README.md","modified":0,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/bower.json","path":"lib/jquery_lazyload/bower.json","modified":0,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.lazyload.js","path":"lib/jquery_lazyload/jquery.lazyload.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.scrollstop.js","path":"lib/jquery_lazyload/jquery.scrollstop.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/needsharebutton/font-embedded.css","path":"lib/needsharebutton/font-embedded.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/needsharebutton/needsharebutton.css","path":"lib/needsharebutton/needsharebutton.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/needsharebutton/needsharebutton.js","path":"lib/needsharebutton/needsharebutton.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-barber-shop.min.css","path":"lib/pace/pace-theme-barber-shop.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-big-counter.min.css","path":"lib/pace/pace-theme-big-counter.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-bounce.min.css","path":"lib/pace/pace-theme-bounce.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-atom.min.css","path":"lib/pace/pace-theme-center-atom.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-radar.min.css","path":"lib/pace/pace-theme-center-radar.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-circle.min.css","path":"lib/pace/pace-theme-center-circle.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-simple.min.css","path":"lib/pace/pace-theme-center-simple.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-corner-indicator.min.css","path":"lib/pace/pace-theme-corner-indicator.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-fill-left.min.css","path":"lib/pace/pace-theme-fill-left.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-flash.min.css","path":"lib/pace/pace-theme-flash.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-loading-bar.min.css","path":"lib/pace/pace-theme-loading-bar.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-minimal.min.css","path":"lib/pace/pace-theme-minimal.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-mac-osx.min.css","path":"lib/pace/pace-theme-mac-osx.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace.min.js","path":"lib/pace/pace.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/three/canvas_lines.min.js","path":"lib/three/canvas_lines.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/three/three-waves.min.js","path":"lib/three/three-waves.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/three/canvas_sphere.min.js","path":"lib/three/canvas_sphere.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/velocity/bower.json","path":"lib/velocity/bower.json","modified":0,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.min.js","path":"lib/velocity/velocity.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","path":"lib/velocity/velocity.ui.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.ui.js","path":"lib/velocity/velocity.ui.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/zclip/clipboard.js","path":"lib/zclip/clipboard.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/zclip/clipboard.min.js","path":"lib/zclip/clipboard.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/jquery/index.js","path":"lib/jquery/index.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/schemes/pisces.js","path":"js/src/schemes/pisces.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.css","path":"lib/Han/dist/han.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.min.css","path":"lib/Han/dist/han.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.min.js","path":"lib/Han/dist/han.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.min.js","path":"lib/fastclick/lib/fastclick.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.js","path":"lib/fastclick/lib/fastclick.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/blank.gif","path":"lib/fancybox/source/blank.gif","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading.gif","path":"lib/fancybox/source/fancybox_loading.gif","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading@2x.gif","path":"lib/fancybox/source/fancybox_loading@2x.gif","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_overlay.png","path":"lib/fancybox/source/fancybox_overlay.png","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite.png","path":"lib/fancybox/source/fancybox_sprite.png","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite@2x.png","path":"lib/fancybox/source/fancybox_sprite@2x.png","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.css","path":"lib/fancybox/source/jquery.fancybox.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.js","path":"lib/fancybox/source/jquery.fancybox.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.pack.js","path":"lib/fancybox/source/jquery.fancybox.pack.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css","path":"lib/font-awesome/css/font-awesome.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","path":"lib/font-awesome/css/font-awesome.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css.map","path":"lib/font-awesome/css/font-awesome.css.map","modified":0,"renderable":1},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.pack.js","path":"lib/ua-parser-js/dist/ua-parser.pack.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.min.js","path":"lib/ua-parser-js/dist/ua-parser.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.js","path":"lib/Han/dist/han.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","path":"lib/font-awesome/fonts/fontawesome-webfont.woff","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","path":"lib/font-awesome/fonts/fontawesome-webfont.woff2","modified":0,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.js","path":"lib/velocity/velocity.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han.otf","path":"lib/Han/dist/font/han.otf","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han-space.otf","path":"lib/Han/dist/font/han-space.otf","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han.woff","path":"lib/Han/dist/font/han.woff","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han-space.woff","path":"lib/Han/dist/font/han-space.woff","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han.woff2","path":"lib/Han/dist/font/han.woff2","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.js","path":"lib/fancybox/source/helpers/jquery.fancybox-buttons.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/fancybox_buttons.png","path":"lib/fancybox/source/helpers/fancybox_buttons.png","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.css","path":"lib/fancybox/source/helpers/jquery.fancybox-buttons.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-media.js","path":"lib/fancybox/source/helpers/jquery.fancybox-media.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","path":"lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","path":"lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/FontAwesome.otf","path":"lib/font-awesome/fonts/FontAwesome.otf","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","path":"lib/font-awesome/fonts/fontawesome-webfont.eot","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.ttf","path":"lib/font-awesome/fonts/fontawesome-webfont.ttf","modified":0,"renderable":1},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.js","path":"lib/algolia-instant-search/instantsearch.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/three/three.min.js","path":"lib/three/three.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.svg","path":"lib/font-awesome/fonts/fontawesome-webfont.svg","modified":0,"renderable":1}],"Cache":[{"_id":"themes/next/.bowerrc","hash":"3228a58ed0ece9f85e1e3136352094080b8dece1","modified":1526271330246},{"_id":"themes/next/.editorconfig","hash":"792fd2bd8174ece1a75d5fd24ab16594886f3a7f","modified":1526271330249},{"_id":"themes/next/.gitattributes","hash":"44bd4729c74ccb88110804f41746fec07bf487d4","modified":1526271330273},{"_id":"themes/next/.gitignore","hash":"e293d46d886f30ce9a4c8aff824b58967025491a","modified":1542699085858},{"_id":"themes/next/.hound.yml","hash":"b76daa84c9ca3ad292c78412603370a367cc2bc3","modified":1526271330290},{"_id":"themes/next/.jshintrc","hash":"9928f81bd822f6a8d67fdbc909b517178533bca9","modified":1526271330295},{"_id":"themes/next/.javascript_ignore","hash":"8a224b381155f10e6eb132a4d815c5b52962a9d1","modified":1526271330292},{"_id":"themes/next/.travis.yml","hash":"d60d4a5375fea23d53b2156b764a99b2e56fa660","modified":1526271330300},{"_id":"themes/next/.stylintrc","hash":"b28e24704a5d8de08346c45286574c8e76cc109f","modified":1526271330298},{"_id":"themes/next/LICENSE","hash":"f293bcfcdc06c0b77ba13570bb8af55eb5c059fd","modified":1526271330303},{"_id":"themes/next/README.cn.md","hash":"2c766b3369ed477bce134a5450dab45bef161504","modified":1526271330306},{"_id":"themes/next/README.md","hash":"8ce60ce578963eb4e1eb5e33e1efc2fc4779af9c","modified":1526271330308},{"_id":"themes/next/_config.yml","hash":"227565a59f9af984baeb29c9fbc1facada602a60","modified":1542703404449},{"_id":"themes/next/bower.json","hash":"0674f11d3d514e087a176da0e1d85c2286aa5fba","modified":1526271330315},{"_id":"themes/next/gulpfile.coffee","hash":"031bffc483e417b20e90eceb6cf358e7596d2e69","modified":1526271330317},{"_id":"themes/next/package.json","hash":"036d3a1346203d2f1a3958024df7f74e7ac07bfe","modified":1526271330573},{"_id":"source/CNAME","hash":"a43bf4f5a67b2c5076edd8c750af620c25596333","modified":1541650741021},{"_id":"source/README.MD","hash":"67f84d79c1f305bd0153deecafbbc101095f49bf","modified":1542700741962},{"_id":"themes/next/.github/CONTRIBUTING.md","hash":"3b5eafd32abb718e56ccf8d1cee0607ad8ce611d","modified":1526271330276},{"_id":"themes/next/.github/ISSUE_TEMPLATE.md","hash":"50d48c47162817a3810a9d9ad51104e83947419a","modified":1526271330279},{"_id":"themes/next/.github/PULL_REQUEST_TEMPLATE.md","hash":"902f627155a65099e0a37842ff396a58d0dc306f","modified":1526271330283},{"_id":"themes/next/.github/browserstack_logo.png","hash":"a6c43887f64a7f48a2814e3714eaa1215e542037","modified":1526271330285},{"_id":"themes/next/languages/en.yml","hash":"7e680d9bb8f3a3a9d1ba1c9d312b3d257183dded","modified":1526271330325},{"_id":"themes/next/languages/default.yml","hash":"44ef3f26917f467459326c2c8be2f73e4d947f35","modified":1530245417029},{"_id":"themes/next/languages/de.yml","hash":"057e7df11ddeb1c8c15a5d7c5ff29430d725ec6b","modified":1526271330321},{"_id":"themes/next/languages/fr-FR.yml","hash":"7e4eb7011b8feee641cfb11c6e73180b0ded1c0f","modified":1526271330327},{"_id":"themes/next/languages/id.yml","hash":"b5de1ea66dd9ef54cac9a1440eaa4e3f5fc011f5","modified":1526271330330},{"_id":"themes/next/languages/it.yml","hash":"aa595f2bda029f73ef7bfa104b4c55c3f4e9fb4c","modified":1526271330333},{"_id":"themes/next/languages/ja.yml","hash":"3c76e16fd19b262864475faa6854b718bc08c4d8","modified":1526271330335},{"_id":"themes/next/languages/ko.yml","hash":"ea5b46056e73ebcee121d5551627af35cbffc900","modified":1526271330338},{"_id":"themes/next/languages/nl-NL.yml","hash":"edca4f3598857dbc3cbf19ed412213329b6edd47","modified":1526271330340},{"_id":"themes/next/languages/pt-BR.yml","hash":"b1694ae766ed90277bcc4daca4b1cfa19cdcb72b","modified":1526271330343},{"_id":"themes/next/languages/pt.yml","hash":"44b61f2d085b827b507909a0b8f8ce31c6ef5d04","modified":1526271330345},{"_id":"themes/next/languages/ru.yml","hash":"98ec6f0b7183282e11cffc7ff586ceb82400dd75","modified":1526271330348},{"_id":"themes/next/languages/vi.yml","hash":"fd08d3c8d2c62965a98ac420fdaf95e54c25d97c","modified":1526271330351},{"_id":"themes/next/languages/zh-Hans.yml","hash":"802c1468a009fe504300d2fd1f4808f558b7fab3","modified":1539252469329},{"_id":"themes/next/languages/zh-hk.yml","hash":"9396f41ae76e4fef99b257c93c7354e661f6e0fa","modified":1526271330357},{"_id":"themes/next/languages/zh-tw.yml","hash":"50b71abb3ecc0686f9739e179e2f829cd074ecd9","modified":1526271330359},{"_id":"themes/next/layout/_layout.swig","hash":"f2f7b1fa74169e2be0d2b0329adc8b258ad3d42e","modified":1528271698780},{"_id":"themes/next/layout/archive.swig","hash":"f0a8225feafd971419837cdb4bcfec98a4a59b2f","modified":1528190120364},{"_id":"themes/next/layout/category.swig","hash":"4472255f4a3e3dd6d79201523a9526dcabdfbf18","modified":1526271330557},{"_id":"themes/next/layout/index.swig","hash":"783611349c941848a0e26ee2f1dc44dd14879bd1","modified":1526271330559},{"_id":"themes/next/layout/page.swig","hash":"969caaee05bdea725e99016eb63d810893a73e99","modified":1526271330562},{"_id":"themes/next/layout/post.swig","hash":"b3589a8e46288a10d20e41c7a5985d2493725aec","modified":1528187671122},{"_id":"themes/next/layout/schedule.swig","hash":"d86f8de4e118f8c4d778b285c140474084a271db","modified":1526271330567},{"_id":"themes/next/layout/tag.swig","hash":"7e0a7d7d832883eddb1297483ad22c184e4368de","modified":1526271330570},{"_id":"themes/next/scripts/merge-configs.js","hash":"81e86717ecfb775986b945d17f0a4ba27532ef07","modified":1526271330577},{"_id":"themes/next/scripts/merge.js","hash":"9130dabe6a674c54b535f322b17d75fe6081472f","modified":1526271330580},{"_id":"themes/next/source/404.html","hash":"9eb955271b03c72a4bb23a06b60e4ecb4070a880","modified":1528187452751},{"_id":"themes/next/test/.jshintrc","hash":"19f93d13d1689fe033c82eb2d5f3ce30b6543cc0","modified":1526271331356},{"_id":"themes/next/test/helpers.js","hash":"a1f5de25154c3724ffc24a91ddc576cdbd60864f","modified":1526271331358},{"_id":"themes/next/test/intern.js","hash":"11fa8a4f5c3b4119a179ae0a2584c8187f907a73","modified":1526271331360},{"_id":"source/_posts/CentOS7配置LNMP.md","hash":"da1f7b77fb43b047229b1b432a5da2c261cce1c7","modified":1542784346297},{"_id":"source/_posts/Form表单校验插件.md","hash":"e7620f8d2b227f38f80ffc059f485a027e83ea7d","modified":1541650741028},{"_id":"source/_posts/Docker学习笔记.md","hash":"ee66f38400697446b05fdc90395f10806a3f4c42","modified":1541650741025},{"_id":"source/_posts/Hexo博客Next主题配置.md","hash":"df1dbd5384df935f8a74e55a12764842ffd5388d","modified":1541650741030},{"_id":"source/_posts/Linux命令学习.md","hash":"5d22a7b9ee5374143e94e00fcb7271b3f0bdc606","modified":1541655532536},{"_id":"source/_posts/MySQL要点.md","hash":"81374e13b2bb3fb8d30d8bd628f0d9b680c2b5ee","modified":1541650741035},{"_id":"source/_posts/hello-world.md","hash":"8443ae2c5fa3660b28aaa4088a70f99ba8787a5b","modified":1541650741039},{"_id":"source/_posts/shell代码自动部署脚本.md","hash":"f3f432d26a3e2ebeda5758e95baf128a743db353","modified":1541650741042},{"_id":"source/_posts/即书服务器搭建记录.md","hash":"538527c4222c94ae07630e4a4b3bbf053bcabd33","modified":1542784354518},{"_id":"source/_posts/搭建博客记录.md","hash":"4557dc20b2ec49e6b45d5550eff0642fbc2a71d1","modified":1541650741063},{"_id":"source/_posts/深入理解 Nginx 和 PHP-FPM.md","hash":"5258e118a441d192b69acab7a3a68e4b58eade01","modified":1541650741066},{"_id":"source/_posts/秒杀架构和优化思路.md","hash":"84a40032bdb56cf8b553ba997233c41a4cd783c1","modified":1541650741067},{"_id":"source/_posts/阿里图标库爬虫.md","hash":"63f21c34a79e309287360692bda761930b6aacc8","modified":1541650741069},{"_id":"source/about/index.md","hash":"aa741dd136121690bfa7fcf05149117c7533fac7","modified":1541650741075},{"_id":"source/categories/index.md","hash":"54ecbc5616a3b17f67c2094220d2a113ec359820","modified":1541650741079},{"_id":"source/images/picture.jpg","hash":"6033a52ce94365318736221555ca85b7c65f10c6","modified":1520043183851},{"_id":"source/tags/index.md","hash":"08855b134aa70d0ab10a3406a57b11878ad68538","modified":1541650741083},{"_id":"themes/next/source/fonts/.gitkeep","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1526271331013},{"_id":"themes/next/layout/_custom/custom.swig","hash":"3218008de118f94b25bfcc6d057ccf0f06488229","modified":1528376711634},{"_id":"themes/next/layout/_custom/sidebar.swig","hash":"9155a03bf511a8ac7bd80a069f9fe378d9e03d50","modified":1542861270001},{"_id":"themes/next/layout/_custom/copyright.swig","hash":"1f12056c01d814d2cbada063b2579e9374af34d0","modified":1541565700934},{"_id":"themes/next/layout/_custom/header.swig","hash":"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc","modified":1526271330364},{"_id":"themes/next/layout/_macro/my-copyright.swig","hash":"d7421e23d9ceb2065ec7fe5cdbd8f4a879480067","modified":1526358974044},{"_id":"themes/next/layout/_macro/post-collapse.swig","hash":"31322a7f57936cf2dc62e824af5490da5354cf02","modified":1526271330372},{"_id":"themes/next/layout/_macro/post-copyright.swig","hash":"665a928604f99d2ba7dc4a4a9150178229568cc6","modified":1541566677351},{"_id":"themes/next/layout/_macro/post.swig","hash":"cb9286d0e0b40ab5cc5f2dee6e3335fd3f00d1e6","modified":1541567097449},{"_id":"themes/next/layout/_macro/reward.swig","hash":"56e8d8556cf474c56ae1bef9cb7bbd26554adb07","modified":1526271330380},{"_id":"themes/next/layout/_macro/sidebar.swig","hash":"86f0dd35813a0c043e861267751b5589a8dc3c97","modified":1530245366598},{"_id":"themes/next/layout/_macro/wechat-subscriber.swig","hash":"39852700e4084ecccffa6d4669168e5cc0514c9e","modified":1526271330385},{"_id":"themes/next/layout/_partials/comments.swig","hash":"4a6f5b1792b2e5262b7fdab9a716b3108e2f09c7","modified":1526271330389},{"_id":"themes/next/layout/_partials/footer.swig","hash":"9cd29e1c5a6d283a28226d42057fc5f194771205","modified":1542703783424},{"_id":"themes/next/layout/_partials/head.swig","hash":"919f19d902f278adccbba57eaac6dadd4e53100d","modified":1528254440613},{"_id":"themes/next/layout/_partials/header.swig","hash":"34efa6fd5419c8669d5dbdf90290f107e6123959","modified":1541404514711},{"_id":"themes/next/layout/_partials/page-header.swig","hash":"1efd925d34a5d4ba2dc0838d9c86ba911e705fc9","modified":1526271330406},{"_id":"themes/next/layout/_partials/pagination.swig","hash":"9e8e21d194ef44d271b1cca0bc1448c14d7edf4f","modified":1526271330409},{"_id":"themes/next/layout/_partials/search.swig","hash":"9dbd378e94abfcb3f864a5b8dbbf18d212ca2ee0","modified":1526271330411},{"_id":"themes/next/layout/_scripts/boostrap.swig","hash":"03aaebe9d50f6acb007ec38cc04acd1cfceb404d","modified":1526271330435},{"_id":"themes/next/layout/_scripts/commons.swig","hash":"766b2bdda29523ed6cd8d7aa197f996022f8fd94","modified":1526271330438},{"_id":"themes/next/layout/_scripts/vendors.swig","hash":"a266f96ad06ee87bdeae6e105a4b53cd587bbd04","modified":1526271330456},{"_id":"themes/next/layout/_third-party/duoshuo-hot-articles.swig","hash":"5d4638c46aef65bf32a01681495b62416ccc98db","modified":1526271330518},{"_id":"themes/next/layout/_third-party/mathjax.swig","hash":"6d25596d6a7c57700d37b607f8d9a62d89708683","modified":1526271330522},{"_id":"themes/next/layout/_third-party/exturl.swig","hash":"7c04a42319d728be356746363aff8ea247791d24","modified":1526271330520},{"_id":"themes/next/layout/_third-party/needsharebutton.swig","hash":"5fe0447cc88a5a63b530cf0426f93c4634811876","modified":1526271330525},{"_id":"themes/next/layout/_third-party/rating.swig","hash":"fc93b1a7e6aed0dddb1f3910142b48d8ab61174e","modified":1526271330528},{"_id":"themes/next/layout/_third-party/schedule.swig","hash":"22369026c87fc23893c35a7f250b42f3bb1b60f1","modified":1526271330531},{"_id":"themes/next/layout/_third-party/scroll-cookie.swig","hash":"1ddb2336a1a19b47af3017047012c01ec5f54529","modified":1526271330533},{"_id":"themes/next/scripts/tags/center-quote.js","hash":"535fc542781021c4326dec24d8495cbb1387634a","modified":1526271330585},{"_id":"themes/next/scripts/tags/button.js","hash":"d023f10a00077f47082b0517e2ad666e6e994f60","modified":1526271330583},{"_id":"themes/next/scripts/tags/full-image.js","hash":"8eeb3fb89540299bdbb799edfdfdac3743b50596","modified":1526271330590},{"_id":"themes/next/scripts/tags/exturl.js","hash":"8d7e60f60779bde050d20fd76f6fdc36fc85e06d","modified":1526271330587},{"_id":"themes/next/scripts/tags/group-pictures.js","hash":"49252824cd53184dc9b97b2f2d87ff28e1b3ef27","modified":1526271330593},{"_id":"themes/next/scripts/tags/label.js","hash":"2f8f41a7316372f0d1ed6b51190dc4acd3e16fff","modified":1526271330595},{"_id":"themes/next/scripts/tags/lazy-image.js","hash":"eeeabede68cf263de9e6593ecf682f620da16f0a","modified":1526271330598},{"_id":"themes/next/scripts/tags/note.js","hash":"64de4e9d01cf3b491ffc7d53afdf148ee5ad9779","modified":1526271330601},{"_id":"themes/next/scripts/tags/tabs.js","hash":"5786545d51c38e8ca38d1bfc7dd9e946fc70a316","modified":1526271330603},{"_id":"themes/next/source/css/main.styl","hash":"20702c48d6053c92c5bcdbc68e8d0ef1369848a0","modified":1526271331010},{"_id":"themes/next/source/images/algolia_logo.svg","hash":"ec119560b382b2624e00144ae01c137186e91621","modified":1526271331016},{"_id":"themes/next/source/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1526271331018},{"_id":"themes/next/source/images/avatar.gif","hash":"264082bb3a1af70d5499c7d22b0902cb454b6d12","modified":1526271331020},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","hash":"c6524ece3f8039a5f612feaf865d21ec8a794564","modified":1526271331023},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","hash":"3031be41e8753c70508aa88e84ed8f4f653f157e","modified":1526271331026},{"_id":"themes/next/source/images/cc-by-nc.svg","hash":"8d39b39d88f8501c0d27f8df9aae47136ebc59b7","modified":1526271331028},{"_id":"themes/next/source/images/cc-by-nd.svg","hash":"c563508ce9ced1e66948024ba1153400ac0e0621","modified":1526271331030},{"_id":"themes/next/source/images/cc-by-sa.svg","hash":"aa4742d733c8af8d38d4c183b8adbdcab045872e","modified":1526271331033},{"_id":"themes/next/source/images/cc-by.svg","hash":"28a0a4fe355a974a5e42f68031652b76798d4f7e","modified":1526271331036},{"_id":"themes/next/source/images/cc-zero.svg","hash":"87669bf8ac268a91d027a0a4802c92a1473e9030","modified":1526271331038},{"_id":"themes/next/source/images/favicon-16x16-next.png","hash":"2e0f16370245fe437d6d51945810b050322a0748","modified":1528185051231},{"_id":"themes/next/source/images/loading.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1526271331045},{"_id":"themes/next/source/images/favicon-32x32-next.png","hash":"8f4e0fba42b12f37813a3b87bfc28832d1c38bdb","modified":1528185026537},{"_id":"themes/next/source/images/logo.svg","hash":"d29cacbae1bdc4bbccb542107ee0524fe55ad6de","modified":1526271331048},{"_id":"themes/next/source/images/placeholder.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1526271331050},{"_id":"themes/next/source/images/picture.jpg","hash":"6033a52ce94365318736221555ca85b7c65f10c6","modified":1520043183851},{"_id":"themes/next/source/images/quote-r.svg","hash":"e60ae504f9d99b712c793c3740c6b100d057d4ec","modified":1526271331055},{"_id":"themes/next/source/images/searchicon.png","hash":"67727a6a969be0b2659b908518fa6706eed307b8","modified":1526271331057},{"_id":"themes/next/source/images/quote-l.svg","hash":"94e870b4c8c48da61d09522196d4dd40e277a98f","modified":1526271331052},{"_id":"themes/next/layout/_scripts/schemes/mist.swig","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1526271330448},{"_id":"themes/next/layout/_scripts/schemes/muse.swig","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1526271330450},{"_id":"themes/next/source/css/_mixins/Mist.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1526271330909},{"_id":"themes/next/source/css/_mixins/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1526271330912},{"_id":"themes/next/source/css/_mixins/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1526271330923},{"_id":"themes/next/source/css/_variables/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1526271331000},{"_id":"themes/next/source/css/_variables/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1526271331007},{"_id":"themes/next/layout/_partials/head/custom-head.swig","hash":"9e1b9666efa77f4cf8d8261bcfa445a9ac608e53","modified":1526271330398},{"_id":"themes/next/layout/_partials/head/external-fonts.swig","hash":"7ce76358411184482bb0934e70037949dd0da8ca","modified":1526271330401},{"_id":"themes/next/layout/_partials/search/localsearch.swig","hash":"957701729b85fb0c5bfcf2fb99c19d54582f91ed","modified":1526271330414},{"_id":"themes/next/layout/_partials/search/swiftype.swig","hash":"959b7e04a96a5596056e4009b73b6489c117597e","modified":1526271330416},{"_id":"themes/next/layout/_partials/search/tinysou.swig","hash":"eefe2388ff3d424694045eda21346989b123977c","modified":1526271330419},{"_id":"themes/next/layout/_partials/share/add-this.swig","hash":"23e23dc0f76ef3c631f24c65277adf7ea517b383","modified":1526271330423},{"_id":"themes/next/layout/_partials/share/baidushare.swig","hash":"1f1107468aaf03f7d0dcd7eb2b653e2813a675b4","modified":1526271330425},{"_id":"themes/next/layout/_partials/share/duoshuo_share.swig","hash":"89c5a5240ecb223acfe1d12377df5562a943fd5d","modified":1526271330427},{"_id":"themes/next/layout/_partials/share/jiathis.swig","hash":"048fd5e98149469f8c28c21ba3561a7a67952c9b","modified":1526271330430},{"_id":"themes/next/layout/_scripts/pages/post-details.swig","hash":"069d1357c717572256e5cdee09574ebce529cbae","modified":1526271330443},{"_id":"themes/next/layout/_scripts/schemes/gemini.swig","hash":"a44acf9b0d0f44ef3dfc767376a95c984cc127de","modified":1526271330446},{"_id":"themes/next/layout/_scripts/schemes/pisces.swig","hash":"a44acf9b0d0f44ef3dfc767376a95c984cc127de","modified":1526271330453},{"_id":"themes/next/layout/_third-party/analytics/analytics-with-widget.swig","hash":"98df9d72e37dd071e882f2d5623c9d817815b139","modified":1526271330461},{"_id":"themes/next/layout/_third-party/analytics/application-insights.swig","hash":"60426bf73f8a89ba61fb1be2df3ad5398e32c4ef","modified":1526271330464},{"_id":"themes/next/layout/_third-party/analytics/baidu-analytics.swig","hash":"deda6a814ed48debc694c4e0c466f06c127163d0","modified":1526271330467},{"_id":"themes/next/layout/_third-party/analytics/busuanzi-counter.swig","hash":"18e7bef8923d83ea42df6c97405e515a876cede4","modified":1526271330469},{"_id":"themes/next/layout/_third-party/analytics/cnzz-analytics.swig","hash":"8160b27bee0aa372c7dc7c8476c05bae57f58d0f","modified":1526271330470},{"_id":"themes/next/layout/_third-party/analytics/facebook-sdk.swig","hash":"a234c5cd1f75ca5731e814d0dbb92fdcf9240d1b","modified":1526271330472},{"_id":"themes/next/layout/_third-party/analytics/firestore.swig","hash":"1cd01c6e92ab1913d48e556a92bb4f28b6dc4996","modified":1526271330474},{"_id":"themes/next/layout/_third-party/analytics/google-analytics.swig","hash":"5d9943d74cc2e0a91badcf4f755c6de77eab193a","modified":1526271330477},{"_id":"themes/next/layout/_third-party/analytics/index.swig","hash":"5e9bb24c750b49513d9a65799e832f07410002ac","modified":1526271330479},{"_id":"themes/next/layout/_third-party/analytics/lean-analytics.swig","hash":"fc65b9c98a0a8ab43a5e7aabff6c5f03838e09c8","modified":1526271330482},{"_id":"themes/next/layout/_third-party/analytics/tencent-analytics.swig","hash":"3658414379e0e8a34c45c40feadc3edc8dc55f88","modified":1526271330484},{"_id":"themes/next/layout/_third-party/analytics/tencent-mta.swig","hash":"0ddc94ed4ba0c19627765fdf1abc4d8efbe53d5a","modified":1526271330486},{"_id":"themes/next/layout/_third-party/analytics/vkontakte-api.swig","hash":"c3971fd154d781088e1cc665035f8561a4098f4c","modified":1526271330488},{"_id":"themes/next/layout/_third-party/comments/changyan.swig","hash":"0e3378f7c39b2b0f69638290873ede6b6b6825c0","modified":1526271330491},{"_id":"themes/next/layout/_third-party/comments/disqus.swig","hash":"c316758546dc9ba6c60cb4d852c17ca6bb6d6724","modified":1526271330494},{"_id":"themes/next/layout/_third-party/comments/duoshuo.swig","hash":"a356b2185d40914447fde817eb3d358ab6b3e4c3","modified":1526271330496},{"_id":"themes/next/layout/_third-party/comments/gitment.swig","hash":"07c3ba23833f81484eb97c45917fe5e157e12034","modified":1542708885642},{"_id":"themes/next/layout/_third-party/comments/hypercomments.swig","hash":"3e8dc5c6c912628a37e3b5f886bec7b2e5ed14ea","modified":1526271330502},{"_id":"themes/next/layout/_third-party/comments/index.swig","hash":"aa0629277d751c55c6d973e7691bf84af9b17a60","modified":1526271330505},{"_id":"themes/next/layout/_third-party/comments/livere.swig","hash":"8a2e393d2e49f7bf560766d8a07cd461bf3fce4f","modified":1526271330507},{"_id":"themes/next/layout/_third-party/comments/valine.swig","hash":"fcabbb241f894c9a6309c44e126cf3e8fea81fd4","modified":1526271330511},{"_id":"themes/next/layout/_third-party/comments/youyan.swig","hash":"8b6650f77fe0a824c8075b2659e0403e0c78a705","modified":1526271330514},{"_id":"themes/next/layout/_third-party/search/index.swig","hash":"c747fb5c6b1f500e8f0c583e44195878b66e4e29","modified":1526271330541},{"_id":"themes/next/layout/_third-party/search/localsearch.swig","hash":"385c066af96bee30be2459dbec8aae1f15d382f5","modified":1526271330546},{"_id":"themes/next/layout/_third-party/search/tinysou.swig","hash":"cb3a5d36dbe1630bab84e03a52733a46df7c219b","modified":1526271330549},{"_id":"themes/next/layout/_third-party/seo/baidu-push.swig","hash":"c057b17f79e8261680fbae8dc4e81317a127c799","modified":1526271330552},{"_id":"themes/next/source/css/_custom/animation.styl","hash":"b7e4bf68918e5e7bd03c4ff094749f9d48c8fbef","modified":1528286731796},{"_id":"themes/next/source/css/_custom/codescroll.styl","hash":"d0f31645145ab3ae6bd2f46f7f22d75973e9de99","modified":1528286733178},{"_id":"themes/next/source/css/_custom/custom.styl","hash":"8836b6549b93589fc1b5ad6f1c4757df5d8d868f","modified":1541487071112},{"_id":"themes/next/source/css/_custom/flipclock.styl","hash":"4a3f87367734cc405219c8c35296ee24ce5afced","modified":1528286735230},{"_id":"themes/next/source/css/_custom/h.styl","hash":"0d0c5a5eccb95e71ce134dbc99fb60a3649ae597","modified":1528286735859},{"_id":"themes/next/source/css/_custom/highlight.styl","hash":"cb618c70964d9fd43bb668c504544ca1391a295f","modified":1541399232318},{"_id":"themes/next/source/css/_custom/label.styl","hash":"afef2e4fee7a58a97eeec650a5b70471f0d0be9a","modified":1528286737474},{"_id":"themes/next/source/css/_custom/oneline.styl","hash":"5f01ef05f717f350a442f01d9e795a7e0624b8bf","modified":1528286738064},{"_id":"themes/next/source/css/_custom/sidebar-author.styl","hash":"ddc784e87612a977917ad2a7369c667ca720c6fe","modified":1541404127244},{"_id":"themes/next/source/css/_custom/quotelist.styl","hash":"7fe2d3b3e02d1e9e24b50a505ce40508b8443bd0","modified":1528286738918},{"_id":"themes/next/source/css/_custom/button.styl","hash":"ce2968cabbbc03f5d17b7c16a1388658a3328ab3","modified":1528440996543},{"_id":"themes/next/source/css/_custom/sidebar.styl","hash":"d2ff5449a451303c5641a7f738210dc6438d6ebc","modified":1530174573449},{"_id":"themes/next/source/css/_mixins/Gemini.styl","hash":"2aa5b7166a85a8aa34b17792ae4f58a5a96df6cc","modified":1526271330907},{"_id":"themes/next/source/css/_mixins/Pisces.styl","hash":"9ab65361ba0a12a986edd103e56492644c2db0b8","modified":1526271330916},{"_id":"themes/next/source/css/_mixins/base.styl","hash":"82f9055955920ed88a2ab6a20ab02169abb2c634","modified":1526271330920},{"_id":"themes/next/source/css/_variables/Gemini.styl","hash":"99fbb4686ea9a3e03a4726ed7cf4d8f529034452","modified":1526271330996},{"_id":"themes/next/source/css/_variables/Mist.styl","hash":"be087dcc060e8179f7e7f60ab4feb65817bd3d9f","modified":1526271330998},{"_id":"themes/next/source/css/_variables/Pisces.styl","hash":"f29165e36489a87ba32d17dddfd2720d84e3f3ec","modified":1526271331003},{"_id":"themes/next/source/css/_variables/base.styl","hash":"29c261fa6b4046322559074d75239c6b272fb8a3","modified":1526271331006},{"_id":"themes/next/source/js/src/algolia-search.js","hash":"b172f697ed339a24b1e80261075232978d164c35","modified":1526271331065},{"_id":"themes/next/source/js/src/affix.js","hash":"978e0422b5bf1b560236d8d10ebc1adcf66392e3","modified":1526271331063},{"_id":"themes/next/source/js/src/bootstrap.js","hash":"034bc8113e0966fe2096ba5b56061bbf10ef0512","modified":1526271331068},{"_id":"themes/next/source/js/src/codescrollbar.js","hash":"bbc506717a30aa6b9247fefeee652528781bb7c8","modified":1528288318494},{"_id":"themes/next/source/js/src/custom.js","hash":"267f0b0e408ca969d8adf37a8bf14e946b86950d","modified":1528379918172},{"_id":"themes/next/source/js/src/customeFlipClock.js","hash":"b9c256e26f052a7933674e86692979294772caf8","modified":1528288319529},{"_id":"themes/next/source/js/src/exturl.js","hash":"e42e2aaab7bf4c19a0c8e779140e079c6aa5c0b1","modified":1526271331070},{"_id":"themes/next/source/js/src/function.js","hash":"69a457f8bacd9d669e24c13e363dc9ffbe2d9ef7","modified":1528288320478},{"_id":"themes/next/source/js/src/hook-duoshuo.js","hash":"a6119070c0119f33e08b29da7d2cce2635eb40a0","modified":1526271331073},{"_id":"themes/next/source/js/src/js.cookie.js","hash":"9b37973a90fd50e71ea91682265715e45ae82c75","modified":1526271331075},{"_id":"themes/next/source/js/src/love.js","hash":"9e8e79d69ad8338761272f86fe5cad0ad5e503cc","modified":1526290194170},{"_id":"themes/next/source/js/src/motion.js","hash":"8dbcbcba222aae9af69ae3a149284f35f7bb1105","modified":1530245961191},{"_id":"themes/next/source/js/src/post-details.js","hash":"a13f45f7aa8291cf7244ec5ba93907d119c5dbdd","modified":1526271331081},{"_id":"themes/next/source/css/_custom/scrollbar.styl","hash":"965b9cb91458f3083c62b3e76b2ccdd76695b25e","modified":1528286739672},{"_id":"themes/next/source/js/src/scroll-cookie.js","hash":"09dc828cbf5f31158ff6250d2bf7c3cde6365c67","modified":1526271331086},{"_id":"themes/next/source/js/src/scrollspy.js","hash":"fe4da1b9fe73518226446f5f27d2831e4426fc35","modified":1526271331088},{"_id":"themes/next/source/js/src/utils.js","hash":"9b1325801d27213083d1487a12b1a62b539ab6f8","modified":1530245342983},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.css","hash":"90ef19edc982645b118b095615838d9c5eaba0de","modified":1526271331124},{"_id":"themes/next/source/lib/canvas-nest/canvas-nest.min.js","hash":"0387e75e23b1db108a755073fe52a0d03eb391a7","modified":1526271331132},{"_id":"themes/next/source/lib/canvas-ribbon/canvas-ribbon.js","hash":"ff5915eb2596e890a2fc6697c864f861a1995ec0","modified":1526271331138},{"_id":"themes/next/source/lib/fastclick/.bower.json","hash":"93ebd5b35e632f714dcf1753e1f6db77ec74449b","modified":1526271331187},{"_id":"themes/next/source/lib/fastclick/LICENSE","hash":"dcd5b6b43095d9e90353a28b09cb269de8d4838e","modified":1526271331190},{"_id":"themes/next/source/lib/fastclick/README.md","hash":"1decd8e1adad2cd6db0ab50cf56de6035156f4ea","modified":1526271331192},{"_id":"themes/next/source/lib/fastclick/bower.json","hash":"13379463c7463b4b96d13556b46faa4cc38d81e6","modified":1526271331194},{"_id":"themes/next/source/lib/fancybox/.bower.json","hash":"9be892a4e14e0da18ff9cb962c9ef71f163b1b22","modified":1526271331141},{"_id":"themes/next/source/lib/fancybox/.gitattributes","hash":"672d3b5767e0eacd83bb41b188c913f2cf754793","modified":1526271331143},{"_id":"themes/next/source/lib/font-awesome/.bower.json","hash":"a2aaaf12378db56bd10596ba3daae30950eac051","modified":1526271331203},{"_id":"themes/next/source/lib/font-awesome/.gitignore","hash":"69d152fa46b517141ec3b1114dd6134724494d83","modified":1526271331205},{"_id":"themes/next/source/lib/font-awesome/.npmignore","hash":"dcf470ab3a358103bb896a539cc03caeda10fa8b","modified":1526271331208},{"_id":"themes/next/source/lib/font-awesome/HELP-US-OUT.txt","hash":"4f7bf961f1bed448f6ba99aeb9219fabf930ba96","modified":1526271331211},{"_id":"themes/next/source/lib/font-awesome/bower.json","hash":"279a8a718ab6c930a67c41237f0aac166c1b9440","modified":1526271331213},{"_id":"themes/next/source/lib/jquery_lazyload/.bower.json","hash":"b7638afc93e9cd350d0783565ee9a7da6805ad8e","modified":1526271331252},{"_id":"themes/next/source/lib/jquery_lazyload/CONTRIBUTING.md","hash":"4891864c24c28efecd81a6a8d3f261145190f901","modified":1526271331254},{"_id":"themes/next/source/lib/jquery_lazyload/README.md","hash":"895d50fa29759af7835256522e9dd7dac597765c","modified":1526271331255},{"_id":"themes/next/source/lib/jquery_lazyload/bower.json","hash":"65bc85d12197e71c40a55c0cd7f6823995a05222","modified":1526271331259},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.lazyload.js","hash":"481fd478650e12b67c201a0ea41e92743f8b45a3","modified":1526271331262},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.scrollstop.js","hash":"0e9a81785a011c98be5ea821a8ed7d411818cfd1","modified":1526271331263},{"_id":"themes/next/source/lib/jquery/.bower.json","hash":"91745c2cc6c946c7275f952b2b0760b880cea69e","modified":1526271331246},{"_id":"themes/next/source/lib/needsharebutton/font-embedded.css","hash":"c39d37278c1e178838732af21bd26cd0baeddfe0","modified":1526271331267},{"_id":"themes/next/source/lib/needsharebutton/needsharebutton.css","hash":"3ef0020a1815ca6151ea4886cd0d37421ae3695c","modified":1526271331269},{"_id":"themes/next/source/lib/needsharebutton/needsharebutton.js","hash":"9885fd9bea5e7ebafc5b1de9d17be5e106248d96","modified":1526271331271},{"_id":"themes/next/source/lib/pace/pace-theme-barber-shop.min.css","hash":"ee0d51446cb4ffe1bb96bd7bc8c8e046dddfcf46","modified":1526271331274},{"_id":"themes/next/source/lib/pace/pace-theme-big-counter.min.css","hash":"5b561dc328af4c4d512e20a76fe964d113a32ba8","modified":1526271331276},{"_id":"themes/next/source/lib/pace/pace-theme-bounce.min.css","hash":"f6bdb9a785b7979dd8ec5c60e278af955ef1e585","modified":1526271331278},{"_id":"themes/next/source/lib/pace/pace-theme-center-atom.min.css","hash":"dcf79c24fe5350fb73d8038573a104e73639e9d3","modified":1526271331280},{"_id":"themes/next/source/lib/pace/pace-theme-center-radar.min.css","hash":"ab7cba998bf4c03b13df342bf43647fa4f419783","modified":1526271331285},{"_id":"themes/next/source/lib/pace/pace-theme-center-circle.min.css","hash":"a4066769c78affbfbc5e30a600e2c7862cd532e0","modified":1526271331282},{"_id":"themes/next/source/lib/pace/pace-theme-center-simple.min.css","hash":"67f44c947548bd4d77e7590d3f59e236cbf9e98a","modified":1526271331286},{"_id":"themes/next/source/lib/pace/pace-theme-corner-indicator.min.css","hash":"b3c64c973f31884e3d8145989476707333406b9a","modified":1526271331288},{"_id":"themes/next/source/lib/pace/pace-theme-fill-left.min.css","hash":"0bec1e235a4a2cccda3f993b205424e1441a44ae","modified":1526271331290},{"_id":"themes/next/source/lib/pace/pace-theme-flash.min.css","hash":"13ace22c40312d7bbd8d9c1e50eff897a7a497d8","modified":1526271331292},{"_id":"themes/next/source/lib/pace/pace-theme-loading-bar.min.css","hash":"7ee28875dfc1230d76c537f6605766e8d4011e9f","modified":1526271331295},{"_id":"themes/next/source/lib/pace/pace-theme-minimal.min.css","hash":"9cd783cceb8a191f3c8b5d81f7a430ecc3e489d3","modified":1526271331300},{"_id":"themes/next/source/lib/pace/pace-theme-mac-osx.min.css","hash":"9f2e7b51b084da407863826b25265b31150b3821","modified":1526271331297},{"_id":"themes/next/source/lib/pace/pace.min.js","hash":"9944dfb7814b911090e96446cea4d36e2b487234","modified":1526271331306},{"_id":"themes/next/source/lib/three/canvas_lines.min.js","hash":"dce4a3b65f8bf958f973690caa7ec4952f353b0c","modified":1526271331312},{"_id":"themes/next/source/lib/three/three-waves.min.js","hash":"d968cba6b3a50b3626a02d67b544f349d83b147c","modified":1526271331316},{"_id":"themes/next/source/lib/three/canvas_sphere.min.js","hash":"d8ea241a53c135a650f7335d2b6982b899fd58a9","modified":1526271331314},{"_id":"themes/next/source/lib/velocity/.bower.json","hash":"05f960846f1c7a93dab1d3f9a1121e86812e8c88","modified":1526271331335},{"_id":"themes/next/source/lib/velocity/bower.json","hash":"2ec99573e84c7117368beccb9e94b6bf35d2db03","modified":1526271331337},{"_id":"themes/next/source/lib/velocity/velocity.min.js","hash":"2f1afadc12e4cf59ef3b405308d21baa97e739c6","modified":1526271331346},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","hash":"ed5e534cd680a25d8d14429af824f38a2c7d9908","modified":1526271331352},{"_id":"themes/next/source/lib/velocity/velocity.ui.js","hash":"6a1d101eab3de87527bb54fcc8c7b36b79d8f0df","modified":1526271331350},{"_id":"themes/next/source/lib/zclip/clipboard.js","hash":"08d12c711f3c435d6b93f09d7da974509509c979","modified":1528269649042},{"_id":"themes/next/source/lib/zclip/clipboard.min.js","hash":"eb41c0e88206dda6f0fd8dfbbeefdc0829a9d13d","modified":1528269580686},{"_id":"themes/next/source/lib/jquery/index.js","hash":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1526271331249},{"_id":"themes/next/layout/_third-party/search/algolia-search/dom.swig","hash":"ba698f49dd3a868c95b240d802f5b1b24ff287e4","modified":1526271330540},{"_id":"themes/next/layout/_third-party/search/algolia-search/assets.swig","hash":"28ff4ed6714c59124569ffcbd10f1173d53ca923","modified":1526271330538},{"_id":"themes/next/source/css/_common/scaffolding/base.styl","hash":"f7c44b0ee46cf2cf82a4c9455ba8d8b55299976f","modified":1541402194551},{"_id":"themes/next/source/css/_common/scaffolding/helpers.styl","hash":"9c25c75311e1bd4d68df031d3f2ae6d141a90766","modified":1526271330888},{"_id":"themes/next/source/css/_common/scaffolding/mobile.styl","hash":"47a46583a1f3731157a3f53f80ed1ed5e2753e8e","modified":1526271330892},{"_id":"themes/next/source/css/_common/scaffolding/normalize.styl","hash":"ece571f38180febaf02ace8187ead8318a300ea7","modified":1526271330894},{"_id":"themes/next/source/css/_common/scaffolding/scaffolding.styl","hash":"a280a583b7615e939aaddbf778f5c108ef8a2a6c","modified":1526271330896},{"_id":"themes/next/source/css/_common/scaffolding/tables.styl","hash":"64f5d56c08d74a338813df1265580ca0cbf0190b","modified":1526271330899},{"_id":"themes/next/source/css/_common/components/back-to-top-sidebar.styl","hash":"4719ce717962663c5c33ef97b1119a0b3a4ecdc3","modified":1526271330614},{"_id":"themes/next/source/css/_common/components/back-to-top.styl","hash":"31050fc7a25784805b4843550151c93bfa55c9c8","modified":1526271330616},{"_id":"themes/next/source/css/_common/components/comments.styl","hash":"471f1627891aca5c0e1973e09fbcb01e1510d193","modified":1526271330621},{"_id":"themes/next/source/css/_common/components/buttons.styl","hash":"7e509c7c28c59f905b847304dd3d14d94b6f3b8e","modified":1526271330619},{"_id":"themes/next/source/css/_common/components/components.styl","hash":"a6bb5256be6195e76addbda12f4ed7c662d65e7a","modified":1526271330623},{"_id":"themes/next/source/css/_common/components/pagination.styl","hash":"c5d48863f332ff8ce7c88dec2c893f709d7331d3","modified":1526271330689},{"_id":"themes/next/source/css/_common/components/tag-cloud.styl","hash":"dd8a3b22fc2f222ac6e6c05bd8a773fb039169c0","modified":1526271330820},{"_id":"themes/next/source/css/_common/outline/outline.styl","hash":"2186be20e317505cd31886f1291429cc21f76703","modified":1526271330880},{"_id":"themes/next/source/css/_schemes/Gemini/index.styl","hash":"18c3336ee3d09bd2da6a876e1336539f03d5a973","modified":1526271330929},{"_id":"themes/next/source/css/_schemes/Mist/_base.styl","hash":"c2d079788d6fc2e9a191ccdae94e50d55bf849dc","modified":1541401809930},{"_id":"themes/next/source/css/_schemes/Mist/_header.styl","hash":"5ae7906dc7c1d9468c7f4b4a6feddddc555797a1","modified":1526271330935},{"_id":"themes/next/source/css/_schemes/Mist/_logo.styl","hash":"38e5df90c8689a71c978fd83ba74af3d4e4e5386","modified":1526271330937},{"_id":"themes/next/source/css/_schemes/Mist/_menu.styl","hash":"b0dcca862cd0cc6e732e33d975b476d744911742","modified":1526271330943},{"_id":"themes/next/source/css/_schemes/Mist/_posts-expanded.styl","hash":"3b25edfa187d1bbbd0d38b50dd013cef54758abf","modified":1526271330946},{"_id":"themes/next/source/css/_schemes/Mist/_search.styl","hash":"1452cbe674cc1d008e1e9640eb4283841058fc64","modified":1526271330948},{"_id":"themes/next/source/css/_schemes/Mist/index.styl","hash":"9a5581a770af8964064fef7afd3e16963e45547f","modified":1526271330951},{"_id":"themes/next/source/css/_schemes/Muse/_layout.styl","hash":"0efa036a15c18f5abb058b7c0fad1dd9ac5eed4c","modified":1526271330961},{"_id":"themes/next/source/css/_schemes/Muse/_logo.styl","hash":"8829bc556ca38bfec4add4f15a2f028092ac6d46","modified":1526271330964},{"_id":"themes/next/source/css/_schemes/Muse/_menu.styl","hash":"4aac01962520d60b03b23022ab601ad4bd19c08c","modified":1526271330966},{"_id":"themes/next/source/css/_schemes/Muse/_search.styl","hash":"1452cbe674cc1d008e1e9640eb4283841058fc64","modified":1526271330969},{"_id":"themes/next/source/css/_schemes/Muse/index.styl","hash":"a0e2030a606c934fb2c5c7373aaae04a1caac4c5","modified":1526271330971},{"_id":"themes/next/source/css/_schemes/Pisces/_brand.styl","hash":"c4ed249798296f60bda02351fe6404fb3ef2126f","modified":1526271330978},{"_id":"themes/next/source/css/_schemes/Pisces/_layout.styl","hash":"5b93958239d3d2bf9aeaede44eced2434d784462","modified":1526271330980},{"_id":"themes/next/source/css/_schemes/Pisces/_menu.styl","hash":"215de948be49bcf14f06d500cef9f7035e406a43","modified":1526271330983},{"_id":"themes/next/source/css/_schemes/Pisces/_posts.styl","hash":"2f878213cb24c5ddc18877f6d15ec5c5f57745ac","modified":1526271330986},{"_id":"themes/next/source/css/_schemes/Pisces/_sidebar.styl","hash":"9d16fa3c14ed76b71229f022b63a02fd0f580958","modified":1526271330990},{"_id":"themes/next/source/css/_schemes/Pisces/index.styl","hash":"69ecd6c97e7cdfd822ac8102b45ad0ede85050db","modified":1526271330992},{"_id":"themes/next/source/js/src/schemes/pisces.js","hash":"8050a5b2683d1d77238c5762b6bd89c543daed6e","modified":1526271331084},{"_id":"themes/next/source/lib/Han/dist/han.css","hash":"bd40da3fba8735df5850956814e312bd7b3193d7","modified":1526271331113},{"_id":"themes/next/source/lib/Han/dist/han.min.css","hash":"a0c9e32549a8b8cf327ab9227b037f323cdb60ee","modified":1526271331119},{"_id":"themes/next/source/lib/Han/dist/han.min.js","hash":"f559c68a25065a14f47da954a7617d87263e409d","modified":1526271331121},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.min.js","hash":"2cae0f5a6c5d6f3cb993015e6863f9483fc4de18","modified":1526271331199},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.js","hash":"06cef196733a710e77ad7e386ced6963f092dc55","modified":1526271331198},{"_id":"themes/next/source/lib/fancybox/source/blank.gif","hash":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a","modified":1526271331147},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading.gif","hash":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1526271331150},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading@2x.gif","hash":"273b123496a42ba45c3416adb027cd99745058b0","modified":1526271331152},{"_id":"themes/next/source/lib/fancybox/source/fancybox_overlay.png","hash":"b3a4ee645ba494f52840ef8412015ba0f465dbe0","modified":1526271331155},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite.png","hash":"17df19f97628e77be09c352bf27425faea248251","modified":1526271331158},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite@2x.png","hash":"30c58913f327e28f466a00f4c1ac8001b560aed8","modified":1526271331161},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.css","hash":"82f33ad0842aa9c154d029e0dada2497d4eb1d57","modified":1526271331178},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.js","hash":"d71602cbca33b9ecdb7ab291b7f86a49530f3601","modified":1526271331181},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.pack.js","hash":"ae6318aeb62ad4ce7a7e9a4cdacd93ffb004f0fb","modified":1526271331184},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css","hash":"0140952c64e3f2b74ef64e050f2fe86eab6624c8","modified":1526271331216},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","hash":"512c7d79033e3028a9be61b540cf1a6870c896f8","modified":1526271331221},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css.map","hash":"0189d278706509412bac4745f96c83984e1d59f4","modified":1526271331218},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.pack.js","hash":"214dad442a92d36af77ed0ca1d9092b16687f02f","modified":1526271331333},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.min.js","hash":"38628e75e4412cc6f11074e03e1c6d257aae495b","modified":1526271331331},{"_id":"themes/next/source/lib/Han/dist/han.js","hash":"e345397e0585c9fed1449e614ec13e0224acf2ab","modified":1526271331116},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","hash":"28b782240b3e76db824e12c02754a9731a167527","modified":1526271331240},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","hash":"d6f48cba7d076fb6f2fd6ba993a75b9dc1ecbf0c","modified":1526271331243},{"_id":"themes/next/source/lib/velocity/velocity.js","hash":"9f08181baea0cc0e906703b7e5df9111b9ef3373","modified":1526271331340},{"_id":"themes/next/source/css/_common/components/footer/footer.styl","hash":"7905a7f625702b45645d8be1268cb8af3f698c70","modified":1526271330627},{"_id":"themes/next/source/css/_common/components/highlight/diff.styl","hash":"96f32ea6c3265a3889e6abe57587f6e2a2a40dfb","modified":1526271330669},{"_id":"themes/next/source/css/_common/components/highlight/theme.styl","hash":"82a01db8685f61c1517f6c3ce9a433638b72f6f6","modified":1528285602324},{"_id":"themes/next/source/css/_common/components/highlight/highlight.styl","hash":"25dc25f61a232f03ca72472b7852f882448ec185","modified":1526271330672},{"_id":"themes/next/source/css/_common/components/header/header.styl","hash":"ae1ca14e51de67b07dba8f61ec79ee0e2e344574","modified":1526271330631},{"_id":"themes/next/source/css/_common/components/header/headerband.styl","hash":"d27448f199fc2f9980b601bc22b87f08b5d64dd1","modified":1526271330633},{"_id":"themes/next/source/css/_common/components/header/menu.styl","hash":"8a2421cb9005352905fae9d41a847ae56957247e","modified":1526271330636},{"_id":"themes/next/source/css/_common/components/header/site-meta.styl","hash":"6c00f6e0978f4d8f9a846a15579963728aaa6a17","modified":1526271330663},{"_id":"themes/next/source/css/_common/components/header/site-nav.styl","hash":"49c2b2c14a1e7fcc810c6be4b632975d0204c281","modified":1526271330666},{"_id":"themes/next/source/css/_common/components/pages/archive.styl","hash":"f5aa2ba3bfffc15475e7e72a55b5c9d18609fdf5","modified":1526271330678},{"_id":"themes/next/source/css/_common/components/pages/categories.styl","hash":"4eff5b252d7b614e500fc7d52c97ce325e57d3ab","modified":1526271330680},{"_id":"themes/next/source/css/_common/components/pages/pages.styl","hash":"2039590632bba3943c39319d80ef630af7928185","modified":1526271330683},{"_id":"themes/next/source/css/_common/components/pages/post-detail.styl","hash":"9bf4362a4d0ae151ada84b219d39fbe5bb8c790e","modified":1526271330686},{"_id":"themes/next/source/css/_common/components/pages/schedule.styl","hash":"a82afbb72d83ee394aedc7b37ac0008a9823b4f4","modified":1526271330687},{"_id":"themes/next/source/css/_common/components/post/my-post-copyright.styl","hash":"e954bf95842945b196bbb0de7b8098950a780129","modified":1526358490707},{"_id":"themes/next/source/css/_common/components/post/post-button.styl","hash":"e72a89e0f421444453e149ba32c77a64bd8e44e8","modified":1526271330693},{"_id":"themes/next/source/css/_common/components/post/post-collapse.styl","hash":"0f7f522cc6bfb3401d5afd62b0fcdf48bb2d604b","modified":1526271330696},{"_id":"themes/next/source/css/_common/components/post/post-copyright.styl","hash":"f54367c0feda6986c030cc4d15a0ca6ceea14bcb","modified":1526271330699},{"_id":"themes/next/source/css/_common/components/post/post-eof.styl","hash":"2cdc094ecf907a02fce25ad4a607cd5c40da0f2b","modified":1526271330702},{"_id":"themes/next/source/css/_common/components/post/post-expand.styl","hash":"535b3b4f8cb1eec2558e094320e7dfb01f94c0e7","modified":1526271330704},{"_id":"themes/next/source/css/_common/components/post/post-gallery.styl","hash":"387ce23bba52b22a586b2dfb4ec618fe1ffd3926","modified":1526271330706},{"_id":"themes/next/source/css/_common/components/post/post-meta.styl","hash":"aea21141015ca8c409d8b33e3e34ec505f464e93","modified":1526271330709},{"_id":"themes/next/source/css/_common/components/post/post-nav.styl","hash":"a5d8617a24d7cb6c5ad91ea621183ca2c0917331","modified":1526271330711},{"_id":"themes/next/source/css/_common/components/post/post-reward.styl","hash":"36332c8a91f089f545f3c3e8ea90d08aa4d6e60c","modified":1526271330718},{"_id":"themes/next/source/css/_common/components/post/post-tags.styl","hash":"a352ae5b1f8857393bf770d2e638bf15f0c9585d","modified":1526271330723},{"_id":"themes/next/source/css/_common/components/post/post-rtl.styl","hash":"017074ef58166e2d69c53bb7590a0e7a8947a1ed","modified":1526271330721},{"_id":"themes/next/source/css/_common/components/post/post-title.styl","hash":"d5a4e4fc17f1f7e7c3a61b52d8e2e9677e139de7","modified":1526271330725},{"_id":"themes/next/source/css/_common/components/post/post-type.styl","hash":"10251257aceecb117233c9554dcf8ecfef8e2104","modified":1526271330728},{"_id":"themes/next/source/css/_common/components/post/post-widgets.styl","hash":"e4055a0d2cd2b0ad9dc55928e2f3e7bd4e499da3","modified":1526271330730},{"_id":"themes/next/source/css/_common/components/post/post.styl","hash":"5b81d7dbcd394346d619af68456aee4170c31372","modified":1541400742120},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-author-links.styl","hash":"0a6c0efffdf18bddbc1d1238feaed282b09cd0fe","modified":1526271330736},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-author.styl","hash":"7a31b2060be3f6b4682a248ba2b2c37e0908e338","modified":1528252256589},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-blogroll.styl","hash":"89dd4f8b1f1cce3ad46cf2256038472712387d02","modified":1526271330799},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-dimmer.styl","hash":"efa5e5022e205b52786ce495d4879f5e7b8f84b2","modified":1526271330801},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-feed-link.styl","hash":"9486ddd2cb255227db102d09a7df4cae0fabad72","modified":1526271330804},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-nav.styl","hash":"45fa7193435a8eae9960267438750b4c9fa9587f","modified":1526271330807},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-toc.styl","hash":"12937cae17c96c74d5c58db6cb29de3b2dfa14a2","modified":1526271330810},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar.styl","hash":"50305b6ad7d09d2ffa4854e39f41ec1f4fe984fd","modified":1530245537142},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-toggle.styl","hash":"f7784aba0c1cd20d824c918c120012d57a5eaa2a","modified":1526271330812},{"_id":"themes/next/source/css/_common/components/tags/blockquote-center.styl","hash":"c2abe4d87148e23e15d49ee225bc650de60baf46","modified":1526271330825},{"_id":"themes/next/source/css/_common/components/sidebar/site-state.styl","hash":"3623e7fa4324ec1307370f33d8f287a9e20a5578","modified":1526271330818},{"_id":"themes/next/source/css/_common/components/tags/exturl.styl","hash":"1b3cc9f4e5a7f6e05b4100e9990b37b20d4a2005","modified":1526271330828},{"_id":"themes/next/source/css/_common/components/tags/full-image.styl","hash":"37e951e734a252fe8a81f452b963df2ba90bfe90","modified":1526271330830},{"_id":"themes/next/source/css/_common/components/tags/group-pictures.styl","hash":"4851b981020c5cbc354a1af9b831a2dcb3cf9d39","modified":1526271330836},{"_id":"themes/next/source/css/_common/components/tags/label.styl","hash":"4a457d265d62f287c63d48764ce45d9bcfc9ec5a","modified":1526271330839},{"_id":"themes/next/source/css/_common/components/tags/note-modern.styl","hash":"ee7528900578ef4753effe05b346381c40de5499","modified":1526271330841},{"_id":"themes/next/source/css/_common/components/tags/note.styl","hash":"32c9156bea5bac9e9ad0b4c08ffbca8b3d9aac4b","modified":1526271330845},{"_id":"themes/next/source/css/_common/components/tags/tabs.styl","hash":"4ab5deed8c3b0c338212380f678f8382672e1bcb","modified":1526271330847},{"_id":"themes/next/source/css/_common/components/tags/tags.styl","hash":"ead0d0f2321dc71505788c7f689f92257cf14947","modified":1526271330849},{"_id":"themes/next/source/css/_common/components/third-party/algolia-search.styl","hash":"fd42777b9125fd8969dc39d4f15473e2b91b4142","modified":1526271330854},{"_id":"themes/next/source/css/_common/components/third-party/baidushare.styl","hash":"93b08815c4d17e2b96fef8530ec1f1064dede6ef","modified":1526271330856},{"_id":"themes/next/source/css/_common/components/third-party/busuanzi-counter.styl","hash":"d4e6d8d7b34dc69994593c208f875ae8f7e8a3ae","modified":1526271330859},{"_id":"themes/next/source/css/_common/components/third-party/han.styl","hash":"cce6772e2cdb4db85d35486ae4c6c59367fbdd40","modified":1526271330867},{"_id":"themes/next/source/css/_common/components/third-party/duoshuo.styl","hash":"2340dd9b3202c61d73cc708b790fac5adddbfc7f","modified":1526271330862},{"_id":"themes/next/source/css/_common/components/third-party/gitment.styl","hash":"34935b40237c074be5f5e8818c14ccfd802b7439","modified":1526271330865},{"_id":"themes/next/source/css/_common/components/third-party/jiathis.styl","hash":"327b5f63d55ec26f7663185c1a778440588d9803","modified":1526271330869},{"_id":"themes/next/source/css/_common/components/third-party/localsearch.styl","hash":"d89c4b562b528e4746696b2ad8935764d133bdae","modified":1526271330872},{"_id":"themes/next/source/css/_common/components/third-party/needsharebutton.styl","hash":"a5e3e6b4b4b814a9fe40b34d784fed67d6d977fa","modified":1526271330874},{"_id":"themes/next/source/css/_common/components/third-party/third-party.styl","hash":"1ccfbd4d0f5754b2dc2719a91245c95f547a7652","modified":1526271330877},{"_id":"themes/next/source/css/_schemes/Mist/outline/outline.styl","hash":"5dc4859c66305f871e56cba78f64bfe3bf1b5f01","modified":1526271330954},{"_id":"themes/next/source/css/_schemes/Mist/sidebar/sidebar-blogroll.styl","hash":"817587e46df49e819858c8ecbafa08b53d5ff040","modified":1526271330957},{"_id":"themes/next/source/css/_schemes/Muse/sidebar/sidebar-blogroll.styl","hash":"817587e46df49e819858c8ecbafa08b53d5ff040","modified":1526271330975},{"_id":"themes/next/source/lib/Han/dist/font/han.otf","hash":"f1f6bb8f461f5672e000380195d3d2358a28494c","modified":1526271331106},{"_id":"themes/next/source/lib/Han/dist/font/han-space.otf","hash":"07436f011b44051f61b8329c99de4bec64e86f4b","modified":1526271331100},{"_id":"themes/next/source/lib/Han/dist/font/han.woff","hash":"f38ff9b2eecaa17b50b66aa2dae87e9e7436d195","modified":1526271331109},{"_id":"themes/next/source/lib/Han/dist/font/han-space.woff","hash":"7a635062b10bf5662ae1d218ba0980171005d060","modified":1526271331103},{"_id":"themes/next/source/lib/Han/dist/font/han.woff2","hash":"623af3ed5423371ac136a4fe0e8cc7bb7396037a","modified":1526271331111},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.js","hash":"ee948b4489aedeb548a77c9e45d8c7c5732fd62d","modified":1526271331169},{"_id":"themes/next/source/lib/fancybox/source/helpers/fancybox_buttons.png","hash":"e385b139516c6813dcd64b8fc431c364ceafe5f3","modified":1526271331165},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.css","hash":"6394c48092085788a8c0ef72670b0652006231a1","modified":1526271331166},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-media.js","hash":"51139a4c79573d372a347ef01a493222a1eaf10a","modified":1526271331172},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","hash":"d22b1629cb23a6181bebb70d0cf653ffe4b835c8","modified":1526271331176},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","hash":"b88b589f5f1aa1b3d87cc7eef34c281ff749b1ae","modified":1526271331174},{"_id":"themes/next/source/lib/font-awesome/fonts/FontAwesome.otf","hash":"048707bc52ac4b6563aaa383bfe8660a0ddc908c","modified":1526271331225},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","hash":"d980c2ce873dc43af460d4d572d441304499f400","modified":1526271331228},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.ttf","hash":"13b1eab65a983c7a73bc7997c479d66943f7c6cb","modified":1526271331238},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.js","hash":"9ccc6f8144f54e86df9a3fd33a18368d81cf3a4f","modified":1526271331129},{"_id":"themes/next/source/lib/three/three.min.js","hash":"73f4cdc17e51a72b9bf5b9291f65386d615c483b","modified":1526271331321},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.svg","hash":"98a8aa5cf7d62c2eff5f07ede8d844b874ef06ed","modified":1526271331234},{"_id":"public/about/index.html","hash":"d13e78d6619e466770e365ae45974cf611b39e43","modified":1542881834759},{"_id":"public/categories/index.html","hash":"d4a3bc0149e8bfc36fe9691938b79658a56e295c","modified":1542881834787},{"_id":"public/tags/index.html","hash":"e6bb3f17270130c9efbb25b19f8a3eb5bc838cfd","modified":1542881834786},{"_id":"public/archives/page/2/index.html","hash":"b73d7ab1763a6c4e1d61ff0815b69b7b13bbc3b3","modified":1542881834787},{"_id":"public/archives/2018/page/2/index.html","hash":"1e4aba7f8a6077b5436bf7fcdd490aad5647d7c5","modified":1542881834787},{"_id":"public/archives/2018/05/index.html","hash":"34dfe0df95acf110c3eda939498ebfd241bfaf99","modified":1542881834787},{"_id":"public/archives/2018/06/index.html","hash":"df45760e1e23897044846a54442f02bbd10af8a8","modified":1542881834788},{"_id":"public/archives/2018/07/index.html","hash":"f0796f932a745fc863adb7f4a22f693152a05f1c","modified":1542881834788},{"_id":"public/archives/2018/09/index.html","hash":"c991a68c493e651f581c4e7b8e3612ae80c25254","modified":1542881834788},{"_id":"public/archives/2018/11/index.html","hash":"5902de918dca3fc3a43af5197ad9c9096df004c4","modified":1542881834788},{"_id":"public/categories/服务器/index.html","hash":"81f08f304cec397d36b2c376667da401c0caf8be","modified":1542709021485},{"_id":"public/categories/JavaScript/index.html","hash":"aebcc7046d6832d9e10d4467181b9c725bb15ab8","modified":1542881834789},{"_id":"public/categories/Linux/index.html","hash":"aa91815f1bec219c6ee88d5ef7b059ef1394c055","modified":1542881834789},{"_id":"public/categories/记录/index.html","hash":"17e9b4a8cb0873c69f65f044e8da2c4ceece0df7","modified":1542881834788},{"_id":"public/categories/MySQL/index.html","hash":"216b7d5c1e7708d004bc2fcb9f3dc931ae8733d2","modified":1542881834789},{"_id":"public/categories/PHP/index.html","hash":"ead1b09994cde0a871b8dd04f746fd9d68b4ff11","modified":1542881834790},{"_id":"public/categories/代码/index.html","hash":"94e4e672715e41203a0906cc164a92e597ab3116","modified":1542881834789},{"_id":"public/tags/记录/index.html","hash":"b3ac4a06d05c192fb929a01960fb4ce7d90a90be","modified":1542881834792},{"_id":"public/tags/服务器/index.html","hash":"3adc82ff84bc37ba504d4a1e7a5f85f182ddc900","modified":1542881834789},{"_id":"public/tags/linux/index.html","hash":"f19a97a83dddf61721c509f89261f1876b6e3013","modified":1542881834789},{"_id":"public/tags/CenterOS/index.html","hash":"e60e716d86584953e9d4ed849d4cc8ce53dc5f34","modified":1542881834789},{"_id":"public/tags/前端/index.html","hash":"8498d01e3cf2b4b1929a789aff1ea9c0c696eea9","modified":1542881834789},{"_id":"public/tags/Linux/index.html","hash":"8902c6d71e595fad4c31aba768b8e4293ee3f3ab","modified":1542881834790},{"_id":"public/tags/Docker/index.html","hash":"5ad12be42f2def331221ad82634455d65b7ae8f4","modified":1542881834789},{"_id":"public/tags/命令/index.html","hash":"7f11442716b614655cbba312d0d297e310043192","modified":1542881834790},{"_id":"public/tags/MySQL/index.html","hash":"3e66f0d12e2eb3010dc4e3cc33a4210cb5ae3dc0","modified":1542881834790},{"_id":"public/tags/Ubuntu/index.html","hash":"8e11f4d3fcfb992aac22b74827dcf9f0bc8af9c4","modified":1542881834790},{"_id":"public/tags/博客/index.html","hash":"7d45d533f9982ec2ebdf827629f255d60ccbbc4c","modified":1542881834790},{"_id":"public/tags/Nginx/index.html","hash":"341a02236a4c20d04ee693e52a1a41c9e60b353a","modified":1542881834790},{"_id":"public/tags/FastCGI/index.html","hash":"cd9e9e6f3b3a74d98b77b2eae6a3d3fe53c46c0c","modified":1542881834790},{"_id":"public/tags/PHP-FPM/index.html","hash":"7dc3dd3964587d62c242db0813d04534b902044f","modified":1542881834790},{"_id":"public/tags/爬虫/index.html","hash":"fb37eb8e95b3a8d37acf96f68e4531412c5e6bd9","modified":1542881834790},{"_id":"public/tags/PHP/index.html","hash":"72af1876a5087f9a73f1779c38f2d26d38d8895e","modified":1542881834790},{"_id":"public/2018/11/06/秒杀架构和优化思路/index.html","hash":"b4818b5bc65c9fc1e40302a963e4ef2ee93546b1","modified":1542881834790},{"_id":"public/2018/11/01/MySQL要点/index.html","hash":"2ab158dd73ef02164a6dc02f6d71fda0379c403b","modified":1542881834790},{"_id":"public/2018/09/22/深入理解 Nginx 和 PHP-FPM/index.html","hash":"c37c28e808c3239db8a41f71fa4105d4e8193e7d","modified":1542881834791},{"_id":"public/2018/09/02/Form表单校验插件/index.html","hash":"97690e7341e844dfb099f8a700111bb575a698c9","modified":1542881834790},{"_id":"public/2018/07/10/shell代码自动部署脚本/index.html","hash":"7bbd96dadaa9d1d35bbadadacaa1ceee328732e5","modified":1542881834791},{"_id":"public/2018/06/30/Docker学习笔记/index.html","hash":"89720a422c1184d014f1fe2c9886e9583a7ff428","modified":1542881834791},{"_id":"public/2018/06/29/CentOS7配置LNMP/index.html","hash":"e7b37cdfd377cfda8282d8678d5e0e412ee41e7a","modified":1542881834791},{"_id":"public/2018/06/27/Linux命令学习/index.html","hash":"8258c35bb11cb3cbc4ce0a45dcd25ebe3c5db9e5","modified":1542881834791},{"_id":"public/2018/06/22/即书服务器搭建记录/index.html","hash":"14df529d3869284232d3e935448660c93dc5522d","modified":1542881834791},{"_id":"public/2018/06/07/阿里图标库爬虫/index.html","hash":"66bd9af9635d36e41095dede92cd36324725c929","modified":1542881834791},{"_id":"public/2018/06/05/Hexo博客Next主题配置/index.html","hash":"4f310eb3a02509aa4086bff05b4fa73f9069d54e","modified":1542881834791},{"_id":"public/2018/05/20/搭建博客记录/index.html","hash":"3670c1e75d761e601ef812c047a2bb012f03d06e","modified":1542881834792},{"_id":"public/2018/05/14/hello-world/index.html","hash":"30b032eb58794c9a8017b1603849525e30dd263b","modified":1542881834792},{"_id":"public/archives/index.html","hash":"65f42617a7627327b10bfd7a28954a5f85ca49c5","modified":1542881834791},{"_id":"public/archives/2018/index.html","hash":"7fac39cf4f091d1995d6fdb476909d8dbacb747d","modified":1542881834792},{"_id":"public/index.html","hash":"e4e977168cff36168201960a9a8be50419afeb66","modified":1542881834792},{"_id":"public/page/2/index.html","hash":"288425bfa62d1809e3a30923cd508806bdb28238","modified":1542881834792},{"_id":"public/CNAME","hash":"a43bf4f5a67b2c5076edd8c750af620c25596333","modified":1542705078377},{"_id":"public/README.MD","hash":"67f84d79c1f305bd0153deecafbbc101095f49bf","modified":1542705078377},{"_id":"public/images/picture.jpg","hash":"6033a52ce94365318736221555ca85b7c65f10c6","modified":1542705078377},{"_id":"public/images/algolia_logo.svg","hash":"ec119560b382b2624e00144ae01c137186e91621","modified":1542705078377},{"_id":"public/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1542705078378},{"_id":"public/images/avatar.gif","hash":"264082bb3a1af70d5499c7d22b0902cb454b6d12","modified":1542705078378},{"_id":"public/images/cc-by-nc-nd.svg","hash":"c6524ece3f8039a5f612feaf865d21ec8a794564","modified":1542705078378},{"_id":"public/images/cc-by-nc-sa.svg","hash":"3031be41e8753c70508aa88e84ed8f4f653f157e","modified":1542705078378},{"_id":"public/images/cc-by-nc.svg","hash":"8d39b39d88f8501c0d27f8df9aae47136ebc59b7","modified":1542705078378},{"_id":"public/images/cc-by-nd.svg","hash":"c563508ce9ced1e66948024ba1153400ac0e0621","modified":1542705078378},{"_id":"public/images/cc-by-sa.svg","hash":"aa4742d733c8af8d38d4c183b8adbdcab045872e","modified":1542705078378},{"_id":"public/images/cc-by.svg","hash":"28a0a4fe355a974a5e42f68031652b76798d4f7e","modified":1542705078378},{"_id":"public/images/cc-zero.svg","hash":"87669bf8ac268a91d027a0a4802c92a1473e9030","modified":1542705078378},{"_id":"public/images/favicon-16x16-next.png","hash":"2e0f16370245fe437d6d51945810b050322a0748","modified":1542705078378},{"_id":"public/images/loading.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1542705078378},{"_id":"public/images/favicon-32x32-next.png","hash":"8f4e0fba42b12f37813a3b87bfc28832d1c38bdb","modified":1542705078378},{"_id":"public/images/logo.svg","hash":"d29cacbae1bdc4bbccb542107ee0524fe55ad6de","modified":1542705078378},{"_id":"public/images/placeholder.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1542705078379},{"_id":"public/images/quote-r.svg","hash":"e60ae504f9d99b712c793c3740c6b100d057d4ec","modified":1542705078379},{"_id":"public/images/searchicon.png","hash":"67727a6a969be0b2659b908518fa6706eed307b8","modified":1542705078379},{"_id":"public/images/quote-l.svg","hash":"94e870b4c8c48da61d09522196d4dd40e277a98f","modified":1542705078380},{"_id":"public/lib/fastclick/LICENSE","hash":"dcd5b6b43095d9e90353a28b09cb269de8d4838e","modified":1542705078380},{"_id":"public/lib/font-awesome/HELP-US-OUT.txt","hash":"4f7bf961f1bed448f6ba99aeb9219fabf930ba96","modified":1542705078380},{"_id":"public/lib/fancybox/source/blank.gif","hash":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a","modified":1542705078380},{"_id":"public/lib/fancybox/source/fancybox_loading.gif","hash":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1542705078380},{"_id":"public/lib/fancybox/source/fancybox_loading@2x.gif","hash":"273b123496a42ba45c3416adb027cd99745058b0","modified":1542705078380},{"_id":"public/lib/fancybox/source/fancybox_overlay.png","hash":"b3a4ee645ba494f52840ef8412015ba0f465dbe0","modified":1542705078381},{"_id":"public/lib/fancybox/source/fancybox_sprite.png","hash":"17df19f97628e77be09c352bf27425faea248251","modified":1542705078381},{"_id":"public/lib/fancybox/source/fancybox_sprite@2x.png","hash":"30c58913f327e28f466a00f4c1ac8001b560aed8","modified":1542705078381},{"_id":"public/lib/font-awesome/css/font-awesome.css.map","hash":"0189d278706509412bac4745f96c83984e1d59f4","modified":1542705078381},{"_id":"public/lib/Han/dist/font/han.otf","hash":"f1f6bb8f461f5672e000380195d3d2358a28494c","modified":1542705078381},{"_id":"public/lib/Han/dist/font/han-space.otf","hash":"07436f011b44051f61b8329c99de4bec64e86f4b","modified":1542705078381},{"_id":"public/lib/Han/dist/font/han.woff","hash":"f38ff9b2eecaa17b50b66aa2dae87e9e7436d195","modified":1542705078381},{"_id":"public/lib/Han/dist/font/han.woff2","hash":"623af3ed5423371ac136a4fe0e8cc7bb7396037a","modified":1542705078382},{"_id":"public/lib/Han/dist/font/han-space.woff","hash":"7a635062b10bf5662ae1d218ba0980171005d060","modified":1542705078382},{"_id":"public/lib/fancybox/source/helpers/fancybox_buttons.png","hash":"e385b139516c6813dcd64b8fc431c364ceafe5f3","modified":1542705078382},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.woff","hash":"28b782240b3e76db824e12c02754a9731a167527","modified":1542705080086},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.woff2","hash":"d6f48cba7d076fb6f2fd6ba993a75b9dc1ecbf0c","modified":1542705080100},{"_id":"public/404.html","hash":"d6cd47ba4ab178269d9e7be773e521a3f74a738b","modified":1542705080143},{"_id":"public/js/src/algolia-search.js","hash":"b172f697ed339a24b1e80261075232978d164c35","modified":1542705080144},{"_id":"public/js/src/affix.js","hash":"978e0422b5bf1b560236d8d10ebc1adcf66392e3","modified":1542705080144},{"_id":"public/js/src/bootstrap.js","hash":"034bc8113e0966fe2096ba5b56061bbf10ef0512","modified":1542705080144},{"_id":"public/js/src/codescrollbar.js","hash":"bbc506717a30aa6b9247fefeee652528781bb7c8","modified":1542705080144},{"_id":"public/js/src/custom.js","hash":"77abd940eb40590a2a8dc6f5cf4c2dd19483da40","modified":1542705080144},{"_id":"public/js/src/customeFlipClock.js","hash":"b9c256e26f052a7933674e86692979294772caf8","modified":1542705080144},{"_id":"public/js/src/exturl.js","hash":"e42e2aaab7bf4c19a0c8e779140e079c6aa5c0b1","modified":1542705080146},{"_id":"public/js/src/function.js","hash":"69a457f8bacd9d669e24c13e363dc9ffbe2d9ef7","modified":1542705080147},{"_id":"public/js/src/hook-duoshuo.js","hash":"a6119070c0119f33e08b29da7d2cce2635eb40a0","modified":1542705080148},{"_id":"public/js/src/js.cookie.js","hash":"9b37973a90fd50e71ea91682265715e45ae82c75","modified":1542705080148},{"_id":"public/js/src/love.js","hash":"9e8e79d69ad8338761272f86fe5cad0ad5e503cc","modified":1542705080148},{"_id":"public/js/src/motion.js","hash":"8dbcbcba222aae9af69ae3a149284f35f7bb1105","modified":1542705080149},{"_id":"public/js/src/post-details.js","hash":"a13f45f7aa8291cf7244ec5ba93907d119c5dbdd","modified":1542705080149},{"_id":"public/js/src/scroll-cookie.js","hash":"09dc828cbf5f31158ff6250d2bf7c3cde6365c67","modified":1542705080149},{"_id":"public/js/src/scrollspy.js","hash":"fe4da1b9fe73518226446f5f27d2831e4426fc35","modified":1542705080149},{"_id":"public/js/src/utils.js","hash":"9b1325801d27213083d1487a12b1a62b539ab6f8","modified":1542705080149},{"_id":"public/lib/algolia-instant-search/instantsearch.min.css","hash":"90ef19edc982645b118b095615838d9c5eaba0de","modified":1542705080149},{"_id":"public/lib/canvas-nest/canvas-nest.min.js","hash":"0387e75e23b1db108a755073fe52a0d03eb391a7","modified":1542705080149},{"_id":"public/lib/canvas-ribbon/canvas-ribbon.js","hash":"ff5915eb2596e890a2fc6697c864f861a1995ec0","modified":1542705080149},{"_id":"public/lib/fastclick/README.html","hash":"da3c74d484c73cc7df565e8abbfa4d6a5a18d4da","modified":1542705080149},{"_id":"public/lib/fastclick/bower.json","hash":"4dcecf83afddba148464d5339c93f6d0aa9f42e9","modified":1542705080150},{"_id":"public/lib/font-awesome/bower.json","hash":"64394a2a9aa00f8e321d8daa5e51a420f0e96dad","modified":1542705080150},{"_id":"public/lib/jquery_lazyload/CONTRIBUTING.html","hash":"a6358170d346af13b1452ac157b60505bec7015c","modified":1542705080150},{"_id":"public/lib/jquery_lazyload/README.html","hash":"bde24335f6bc09d8801c0dcd7274f71b466552bd","modified":1542705080150},{"_id":"public/lib/jquery_lazyload/jquery.scrollstop.js","hash":"0e9a81785a011c98be5ea821a8ed7d411818cfd1","modified":1542705080150},{"_id":"public/lib/jquery_lazyload/bower.json","hash":"ae3c3b61e6e7f9e1d7e3585ad854380ecc04cf53","modified":1542705080150},{"_id":"public/lib/jquery_lazyload/jquery.lazyload.js","hash":"481fd478650e12b67c201a0ea41e92743f8b45a3","modified":1542705080150},{"_id":"public/lib/needsharebutton/needsharebutton.css","hash":"3ef0020a1815ca6151ea4886cd0d37421ae3695c","modified":1542705080151},{"_id":"public/lib/pace/pace-theme-barber-shop.min.css","hash":"ee0d51446cb4ffe1bb96bd7bc8c8e046dddfcf46","modified":1542705080151},{"_id":"public/lib/pace/pace-theme-big-counter.min.css","hash":"5b561dc328af4c4d512e20a76fe964d113a32ba8","modified":1542705080151},{"_id":"public/lib/pace/pace-theme-bounce.min.css","hash":"f6bdb9a785b7979dd8ec5c60e278af955ef1e585","modified":1542705080151},{"_id":"public/lib/pace/pace-theme-center-atom.min.css","hash":"dcf79c24fe5350fb73d8038573a104e73639e9d3","modified":1542705080151},{"_id":"public/lib/pace/pace-theme-center-radar.min.css","hash":"ab7cba998bf4c03b13df342bf43647fa4f419783","modified":1542705080151},{"_id":"public/lib/pace/pace-theme-center-circle.min.css","hash":"a4066769c78affbfbc5e30a600e2c7862cd532e0","modified":1542705080151},{"_id":"public/lib/pace/pace-theme-center-simple.min.css","hash":"67f44c947548bd4d77e7590d3f59e236cbf9e98a","modified":1542705080151},{"_id":"public/lib/pace/pace-theme-corner-indicator.min.css","hash":"b3c64c973f31884e3d8145989476707333406b9a","modified":1542705080152},{"_id":"public/lib/pace/pace-theme-fill-left.min.css","hash":"0bec1e235a4a2cccda3f993b205424e1441a44ae","modified":1542705080152},{"_id":"public/lib/pace/pace-theme-flash.min.css","hash":"13ace22c40312d7bbd8d9c1e50eff897a7a497d8","modified":1542705080152},{"_id":"public/lib/pace/pace-theme-loading-bar.min.css","hash":"7ee28875dfc1230d76c537f6605766e8d4011e9f","modified":1542705080152},{"_id":"public/lib/pace/pace-theme-minimal.min.css","hash":"9cd783cceb8a191f3c8b5d81f7a430ecc3e489d3","modified":1542705080152},{"_id":"public/lib/pace/pace-theme-mac-osx.min.css","hash":"9f2e7b51b084da407863826b25265b31150b3821","modified":1542705080152},{"_id":"public/lib/pace/pace.min.js","hash":"9944dfb7814b911090e96446cea4d36e2b487234","modified":1542705080152},{"_id":"public/lib/velocity/bower.json","hash":"0ef14e7ccdfba5db6eb3f8fc6aa3b47282c36409","modified":1542705080152},{"_id":"public/lib/velocity/velocity.ui.min.js","hash":"ed5e534cd680a25d8d14429af824f38a2c7d9908","modified":1542705080152},{"_id":"public/lib/zclip/clipboard.min.js","hash":"eb41c0e88206dda6f0fd8dfbbeefdc0829a9d13d","modified":1542705080152},{"_id":"public/js/src/schemes/pisces.js","hash":"8050a5b2683d1d77238c5762b6bd89c543daed6e","modified":1542705080152},{"_id":"public/lib/fastclick/lib/fastclick.min.js","hash":"2cae0f5a6c5d6f3cb993015e6863f9483fc4de18","modified":1542705080153},{"_id":"public/lib/fancybox/source/jquery.fancybox.css","hash":"5f163444617b6cf267342f06ac166a237bb62df9","modified":1542705080153},{"_id":"public/lib/ua-parser-js/dist/ua-parser.pack.js","hash":"214dad442a92d36af77ed0ca1d9092b16687f02f","modified":1542705080153},{"_id":"public/lib/ua-parser-js/dist/ua-parser.min.js","hash":"38628e75e4412cc6f11074e03e1c6d257aae495b","modified":1542705080153},{"_id":"public/lib/fancybox/source/helpers/jquery.fancybox-buttons.js","hash":"91e41741c2e93f732c82aaacec4cfc6e3f3ec876","modified":1542705080153},{"_id":"public/lib/fancybox/source/helpers/jquery.fancybox-buttons.css","hash":"1a9d8e5c22b371fcc69d4dbbb823d9c39f04c0c8","modified":1542705080153},{"_id":"public/lib/fancybox/source/helpers/jquery.fancybox-media.js","hash":"3bdf69ed2469e4fb57f5a95f17300eef891ff90d","modified":1542705080153},{"_id":"public/lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","hash":"53e194f4a72e649c04fb586dd57762b8c022800b","modified":1542705080153},{"_id":"public/lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","hash":"4ac329c16a5277592fc12a37cca3d72ca4ec292f","modified":1542705080153},{"_id":"public/css/main.css","hash":"069175460991d73583d97682bf20315def1c6115","modified":1542705080153},{"_id":"public/lib/needsharebutton/needsharebutton.js","hash":"9885fd9bea5e7ebafc5b1de9d17be5e106248d96","modified":1542705080153},{"_id":"public/lib/needsharebutton/font-embedded.css","hash":"c39d37278c1e178838732af21bd26cd0baeddfe0","modified":1542705080154},{"_id":"public/lib/three/canvas_lines.min.js","hash":"dce4a3b65f8bf958f973690caa7ec4952f353b0c","modified":1542705080154},{"_id":"public/lib/three/three-waves.min.js","hash":"d968cba6b3a50b3626a02d67b544f349d83b147c","modified":1542705080154},{"_id":"public/lib/three/canvas_sphere.min.js","hash":"d8ea241a53c135a650f7335d2b6982b899fd58a9","modified":1542705080154},{"_id":"public/lib/velocity/velocity.min.js","hash":"2f1afadc12e4cf59ef3b405308d21baa97e739c6","modified":1542705080155},{"_id":"public/lib/velocity/velocity.ui.js","hash":"6a1d101eab3de87527bb54fcc8c7b36b79d8f0df","modified":1542705080155},{"_id":"public/lib/zclip/clipboard.js","hash":"08d12c711f3c435d6b93f09d7da974509509c979","modified":1542705080155},{"_id":"public/lib/Han/dist/han.min.css","hash":"a0c9e32549a8b8cf327ab9227b037f323cdb60ee","modified":1542705080155},{"_id":"public/lib/Han/dist/han.css","hash":"bd40da3fba8735df5850956814e312bd7b3193d7","modified":1542705080156},{"_id":"public/lib/jquery/index.js","hash":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1542705080156},{"_id":"public/lib/fastclick/lib/fastclick.js","hash":"06cef196733a710e77ad7e386ced6963f092dc55","modified":1542705080156},{"_id":"public/lib/Han/dist/han.min.js","hash":"f559c68a25065a14f47da954a7617d87263e409d","modified":1542705080156},{"_id":"public/lib/fancybox/source/jquery.fancybox.js","hash":"1cf3d47b5ccb7cb6e9019c64f2a88d03a64853e4","modified":1542705080156},{"_id":"public/lib/fancybox/source/jquery.fancybox.pack.js","hash":"53360764b429c212f424399384417ccc233bb3be","modified":1542705080157},{"_id":"public/lib/font-awesome/css/font-awesome.css","hash":"0140952c64e3f2b74ef64e050f2fe86eab6624c8","modified":1542705080157},{"_id":"public/lib/font-awesome/css/font-awesome.min.css","hash":"512c7d79033e3028a9be61b540cf1a6870c896f8","modified":1542705080157},{"_id":"public/lib/Han/dist/han.js","hash":"e345397e0585c9fed1449e614ec13e0224acf2ab","modified":1542705080158},{"_id":"public/lib/velocity/velocity.js","hash":"9f08181baea0cc0e906703b7e5df9111b9ef3373","modified":1542705080158},{"_id":"public/lib/algolia-instant-search/instantsearch.min.js","hash":"9ccc6f8144f54e86df9a3fd33a18368d81cf3a4f","modified":1542705080158},{"_id":"public/lib/three/three.min.js","hash":"73f4cdc17e51a72b9bf5b9291f65386d615c483b","modified":1542705080158},{"_id":"public/lib/font-awesome/fonts/FontAwesome.otf","hash":"048707bc52ac4b6563aaa383bfe8660a0ddc908c","modified":1542705080159},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.eot","hash":"d980c2ce873dc43af460d4d572d441304499f400","modified":1542705080160},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.ttf","hash":"13b1eab65a983c7a73bc7997c479d66943f7c6cb","modified":1542705080160},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.svg","hash":"98a8aa5cf7d62c2eff5f07ede8d844b874ef06ed","modified":1542705080302}],"Category":[{"name":"服务器","_id":"cjopirm6200042cwmhc8q0p7e"},{"name":"JavaScript","_id":"cjopirm6f000a2cwmcvhv7r06"},{"name":"Linux","_id":"cjopirm6t000g2cwmjqjr27n1"},{"name":"记录","_id":"cjopirm79000l2cwmxhmxkafz"},{"name":"MySQL","_id":"cjopirm7o000y2cwmlhg14t1x"},{"name":"PHP","_id":"cjopirm7s00152cwmolese6xu"},{"name":"代码","_id":"cjopirm7w001a2cwmf0ajbqgl"}],"Data":[],"Page":[{"title":"About","date":"2018-05-14T04:56:52.000Z","_content":"\n<blockquote class=\"blockquote-center\">    我天性不宜交际。在多数场合，我不是觉得对方乏味，就是害怕对方觉得我乏味。可是我既不愿忍受对方的乏味，也不愿费劲使自己显得有趣，那都太累了。我独处时最轻松，因为我不觉得自己乏味，即使乏味，也自己承受，不累及他人，无需感到不安。                        ——周国平《人与永恆》</blockquote>\n\n- 运动爱好者\n- 热爱开源\n- 代码洁癖\n- 发呆一万年\n\n","source":"about/index.md","raw":"---\ntitle: About\ndate: 2018-05-14 12:56:52\n---\n\n<blockquote class=\"blockquote-center\">    我天性不宜交际。在多数场合，我不是觉得对方乏味，就是害怕对方觉得我乏味。可是我既不愿忍受对方的乏味，也不愿费劲使自己显得有趣，那都太累了。我独处时最轻松，因为我不觉得自己乏味，即使乏味，也自己承受，不累及他人，无需感到不安。                        ——周国平《人与永恆》</blockquote>\n\n- 运动爱好者\n- 热爱开源\n- 代码洁癖\n- 发呆一万年\n\n","updated":"2018-11-08T04:19:01.075Z","path":"about/index.html","comments":1,"layout":"page","_id":"cjopirm5u00012cwm2ic58j75","content":"<blockquote class=\"blockquote-center\">    我天性不宜交际。在多数场合，我不是觉得对方乏味，就是害怕对方觉得我乏味。可是我既不愿忍受对方的乏味，也不愿费劲使自己显得有趣，那都太累了。我独处时最轻松，因为我不觉得自己乏味，即使乏味，也自己承受，不累及他人，无需感到不安。                        ——周国平《人与永恆》</blockquote>\n\n<ul>\n<li>运动爱好者</li>\n<li>热爱开源</li>\n<li>代码洁癖</li>\n<li>发呆一万年</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<blockquote class=\"blockquote-center\">    我天性不宜交际。在多数场合，我不是觉得对方乏味，就是害怕对方觉得我乏味。可是我既不愿忍受对方的乏味，也不愿费劲使自己显得有趣，那都太累了。我独处时最轻松，因为我不觉得自己乏味，即使乏味，也自己承受，不累及他人，无需感到不安。                        ——周国平《人与永恆》</blockquote>\n\n<ul>\n<li>运动爱好者</li>\n<li>热爱开源</li>\n<li>代码洁癖</li>\n<li>发呆一万年</li>\n</ul>\n"},{"title":"categories","date":"2018-05-14T09:21:52.000Z","type":"categories","_content":"","source":"categories/index.md","raw":"---\ntitle: categories\ndate: 2018-05-14 17:21:52\ntype: \"categories\"\n---\n","updated":"2018-11-08T04:19:01.079Z","path":"categories/index.html","comments":1,"layout":"page","_id":"cjopirm6000032cwms7d9c1nd","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"Tagcloud","date":"2018-05-14T09:18:29.000Z","type":"tags","_content":"","source":"tags/index.md","raw":"---\ntitle: Tagcloud\ndate: 2018-05-14 17:18:29\ntype: \"tags\"\n---\n","updated":"2018-11-08T04:19:01.083Z","path":"tags/index.html","comments":1,"layout":"page","_id":"cjopirm6a00072cwmh1etfpfz","content":"","site":{"data":{}},"excerpt":"","more":""}],"Post":[{"title":"CentOS7配置LNMP","date":"2018-06-29T05:11:28.000Z","_content":"\n服务器环境 *CentOS 7*\n<!--more-->\n\n# Nginx 安装\n> 安装 yum repo, 在 `http://nginx.org/packages/centos/` 找到对应的版本\n\n```bash line_number:false\n    rpm -Uvh http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm\n```\n安装**Nginx**: `yum install nginx`\n设置**Nginx**开机启动: `systemctl enable nginx`\n查看**Nginx**当前状态: `systemctl status nginx`\n\n# MySQL V5.7 安装\n> 安装 yum repo\n\n```bash line_number:false\n    rpm -Uvh http://dev.mysql.com/get/mysql57-community-release-el7-7.noarch.rpm\n```\n安装**MySQL** V5.7: `yum install mysql-community-server mysql-community-devel`\n> 安装完成后 MySQL 会默认加到自动启动服务中, 并且会分配一个随机的 Root 密码 \n可以使用 `grep 'temporary password' /var/log/mysqld.log` 这个命令来查看密码\n\n启动**MySQL**: `systemctl start mysqld`\n修改**MySQL**密码: `ALTER USER 'root'@'localhost' IDENTIFIED BY '022.Admin';` *不写到这我还真记不住*\n\n# PHP V7 安装\n下载**PHP 7.1.5** 的源码包: `wget -c http://cn2.php.net/distributions/php-7.1.5.tar.gz`\n解压并进入文件夹 \n>    \n- `tar zxvf php-7.1.5.tar.gz`\n- `cd php-7.1.5`\n\n\n```bash line_number:false\n    # 安装扩展依赖包\n    yum -y install gcc libjpeg libjpeg-devel libpng libpng-devel freetype freetype-devel libxml2 libxml2-devel zlib zlib-devel curl curl-devel openssl openssl-devel\n    \n    # 配置 PHP\n    ./configure --prefix=/usr/local/php-7.1.5 --enable-fpm --with-fpm-user=nginx --with-fpm-group=nginx --with-mysqli --with-pdo-mysql --with-zlib --with-curl --with-gd --with-jpeg-dir --with-png-dir --with-freetype-dir --with-openssl --enable-mbstring --enable-ftp --enable-zip\n    \n    # 安装\n    make && make install\n    \n    # copy php.ini\n    cp php.ini-development /usr/local/php-7.1.5/lib/php.ini\n    \n    # 修改 php.ini 文件\n    mysqli.default_socket = /var/lib/mysql/mysql.sock\n    date.timezone = PRC\n    \n    # 将 /usr/local/php-7.1.5 软链到 /usr/local/php\n    ln -s /usr/local/php-7.1.5 /usr/local/php\n    # 将一些常用的可执行文件（例如 php, pecl, pear 和 phpize）软链到 PATH 环境变量中。\n    ln -s /usr/local/php/bin/php /usr/sbin/php\n    ln -s /usr/local/php/bin/pecl /usr/sbin/pecl\n    ln -s /usr/local/php/bin/pear /usr/sbin/pear\n    ln -s /usr/local/php/bin/phpize /usr/sbin/phpize\n    \n    # 配置 php-fpm\n    cp /usr/local/php-7.1.5/etc/php-fpm.conf.default /usr/local/php-7.1.5/etc/php-fpm.conf\n    cp /usr/local/php-7.1.5/etc/php-fpm.d/www.conf.default /usr/local/php-7.1.5/etc/php-fpm.d/www.conf\n    \n    # 查找 /usr/local/php-7.1.5/etc/php-fpm.d/www.conf user 和 group 看看是不是安装时指定的 nginx \n    user = nginx\n    group = nginx\n    \n    # 配置 php-fpm 启动服务脚本\n    cp /usr/local/src/php-7.1.5/sapi/fpm/php-fpm.service /usr/lib/systemd/system/php71-fpm.service\n    # php-fpm 随机启动\n    systemctl enable php71-fpm\n    \n    # 重新载入 systemd\n    systemctl daemon-reload\n    \n    # 启动 php71-fpm\n    systemctl start php71-fpm\n    # 查看php71-fpm当前状态\n    systemctl status php71-fpm\n```\n# end\n添加 nginx 配置文件\n ```nginx\nserver {\n    listen       80;\n    server_name  localhost;\n    root         /www/web;\n    location / {\n        index  index.php index.html index.htm;\n    }\n    location ~ \\.php$ {\n        fastcgi_pass   127.0.0.1:9000;\n        fastcgi_index  index.php;\n        fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;\n        include        fastcgi_params;\n    }\n}\n```\n 重新加载**Nginx**配置 `systemctl reload nginx`\n 测试验证~\n ![phpinfo](http://oyvpp7gqd.bkt.clouddn.com/18-6-29/84311977.jpg)\n```\n\n# CentOS7 安装 Nodejs\n`curl --silent --location https://rpm.nodesource.com/setup_10.x | bash -` 10.x 可切换为对应版本号安装其他版本 执行完后再执行 `sudo yum install -y nodejs` 安装","source":"_posts/CentOS7配置LNMP.md","raw":"---\ntitle: CentOS7配置LNMP\ndate: 2018-06-29 13:11:28\ntags: [记录, 服务器, linux, CenterOS]\ncategories: Linux\n---\n\n服务器环境 *CentOS 7*\n<!--more-->\n\n# Nginx 安装\n> 安装 yum repo, 在 `http://nginx.org/packages/centos/` 找到对应的版本\n\n```bash line_number:false\n    rpm -Uvh http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm\n```\n安装**Nginx**: `yum install nginx`\n设置**Nginx**开机启动: `systemctl enable nginx`\n查看**Nginx**当前状态: `systemctl status nginx`\n\n# MySQL V5.7 安装\n> 安装 yum repo\n\n```bash line_number:false\n    rpm -Uvh http://dev.mysql.com/get/mysql57-community-release-el7-7.noarch.rpm\n```\n安装**MySQL** V5.7: `yum install mysql-community-server mysql-community-devel`\n> 安装完成后 MySQL 会默认加到自动启动服务中, 并且会分配一个随机的 Root 密码 \n可以使用 `grep 'temporary password' /var/log/mysqld.log` 这个命令来查看密码\n\n启动**MySQL**: `systemctl start mysqld`\n修改**MySQL**密码: `ALTER USER 'root'@'localhost' IDENTIFIED BY '022.Admin';` *不写到这我还真记不住*\n\n# PHP V7 安装\n下载**PHP 7.1.5** 的源码包: `wget -c http://cn2.php.net/distributions/php-7.1.5.tar.gz`\n解压并进入文件夹 \n>    \n- `tar zxvf php-7.1.5.tar.gz`\n- `cd php-7.1.5`\n\n\n```bash line_number:false\n    # 安装扩展依赖包\n    yum -y install gcc libjpeg libjpeg-devel libpng libpng-devel freetype freetype-devel libxml2 libxml2-devel zlib zlib-devel curl curl-devel openssl openssl-devel\n    \n    # 配置 PHP\n    ./configure --prefix=/usr/local/php-7.1.5 --enable-fpm --with-fpm-user=nginx --with-fpm-group=nginx --with-mysqli --with-pdo-mysql --with-zlib --with-curl --with-gd --with-jpeg-dir --with-png-dir --with-freetype-dir --with-openssl --enable-mbstring --enable-ftp --enable-zip\n    \n    # 安装\n    make && make install\n    \n    # copy php.ini\n    cp php.ini-development /usr/local/php-7.1.5/lib/php.ini\n    \n    # 修改 php.ini 文件\n    mysqli.default_socket = /var/lib/mysql/mysql.sock\n    date.timezone = PRC\n    \n    # 将 /usr/local/php-7.1.5 软链到 /usr/local/php\n    ln -s /usr/local/php-7.1.5 /usr/local/php\n    # 将一些常用的可执行文件（例如 php, pecl, pear 和 phpize）软链到 PATH 环境变量中。\n    ln -s /usr/local/php/bin/php /usr/sbin/php\n    ln -s /usr/local/php/bin/pecl /usr/sbin/pecl\n    ln -s /usr/local/php/bin/pear /usr/sbin/pear\n    ln -s /usr/local/php/bin/phpize /usr/sbin/phpize\n    \n    # 配置 php-fpm\n    cp /usr/local/php-7.1.5/etc/php-fpm.conf.default /usr/local/php-7.1.5/etc/php-fpm.conf\n    cp /usr/local/php-7.1.5/etc/php-fpm.d/www.conf.default /usr/local/php-7.1.5/etc/php-fpm.d/www.conf\n    \n    # 查找 /usr/local/php-7.1.5/etc/php-fpm.d/www.conf user 和 group 看看是不是安装时指定的 nginx \n    user = nginx\n    group = nginx\n    \n    # 配置 php-fpm 启动服务脚本\n    cp /usr/local/src/php-7.1.5/sapi/fpm/php-fpm.service /usr/lib/systemd/system/php71-fpm.service\n    # php-fpm 随机启动\n    systemctl enable php71-fpm\n    \n    # 重新载入 systemd\n    systemctl daemon-reload\n    \n    # 启动 php71-fpm\n    systemctl start php71-fpm\n    # 查看php71-fpm当前状态\n    systemctl status php71-fpm\n```\n# end\n添加 nginx 配置文件\n ```nginx\nserver {\n    listen       80;\n    server_name  localhost;\n    root         /www/web;\n    location / {\n        index  index.php index.html index.htm;\n    }\n    location ~ \\.php$ {\n        fastcgi_pass   127.0.0.1:9000;\n        fastcgi_index  index.php;\n        fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;\n        include        fastcgi_params;\n    }\n}\n```\n 重新加载**Nginx**配置 `systemctl reload nginx`\n 测试验证~\n ![phpinfo](http://oyvpp7gqd.bkt.clouddn.com/18-6-29/84311977.jpg)\n```\n\n# CentOS7 安装 Nodejs\n`curl --silent --location https://rpm.nodesource.com/setup_10.x | bash -` 10.x 可切换为对应版本号安装其他版本 执行完后再执行 `sudo yum install -y nodejs` 安装","slug":"CentOS7配置LNMP","published":1,"updated":"2018-11-21T07:12:26.297Z","_id":"cjopirm5i00002cwmxk5ktn3c","comments":1,"layout":"post","photos":[],"link":"","content":"<p>服务器环境 <em>CentOS 7</em><br><a id=\"more\"></a></p>\n<h1 id=\"Nginx-安装\"><a href=\"#Nginx-安装\" class=\"headerlink\" title=\"Nginx 安装\"></a>Nginx 安装</h1><blockquote>\n<p>安装 yum repo, 在 <code>http://nginx.org/packages/centos/</code> 找到对应的版本</p>\n</blockquote>\n<figure class=\"highlight bash\"><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\">rpm -Uvh http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm</div></pre></div></div></figure>\n<p>安装<strong>Nginx</strong>: <code>yum install nginx</code><br>设置<strong>Nginx</strong>开机启动: <code>systemctl enable nginx</code><br>查看<strong>Nginx</strong>当前状态: <code>systemctl status nginx</code></p>\n<h1 id=\"MySQL-V5-7-安装\"><a href=\"#MySQL-V5-7-安装\" class=\"headerlink\" title=\"MySQL V5.7 安装\"></a>MySQL V5.7 安装</h1><blockquote>\n<p>安装 yum repo</p>\n</blockquote>\n<figure class=\"highlight bash\"><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\">rpm -Uvh http://dev.mysql.com/get/mysql57-community-release-el7-7.noarch.rpm</div></pre></div></div></figure>\n<p>安装<strong>MySQL</strong> V5.7: <code>yum install mysql-community-server mysql-community-devel</code></p>\n<blockquote>\n<p>安装完成后 MySQL 会默认加到自动启动服务中, 并且会分配一个随机的 Root 密码<br>可以使用 <code>grep &#39;temporary password&#39; /var/log/mysqld.log</code> 这个命令来查看密码</p>\n</blockquote>\n<p>启动<strong>MySQL</strong>: <code>systemctl start mysqld</code><br>修改<strong>MySQL</strong>密码: <code>ALTER USER &#39;root&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;022.Admin&#39;;</code> <em>不写到这我还真记不住</em></p>\n<h1 id=\"PHP-V7-安装\"><a href=\"#PHP-V7-安装\" class=\"headerlink\" title=\"PHP V7 安装\"></a>PHP V7 安装</h1><p>下载<strong>PHP 7.1.5</strong> 的源码包: <code>wget -c http://cn2.php.net/distributions/php-7.1.5.tar.gz</code><br>解压并进入文件夹 </p>\n<blockquote>\n<ul>\n<li><code>tar zxvf php-7.1.5.tar.gz</code></li>\n<li><code>cd php-7.1.5</code></li>\n</ul>\n</blockquote>\n<figure class=\"highlight bash\"><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># 安装扩展依赖包</span></div><div class=\"line\">yum -y install gcc libjpeg libjpeg-devel libpng libpng-devel freetype freetype-devel libxml2 libxml2-devel zlib zlib-devel curl curl-devel openssl openssl-devel</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 配置 PHP</span></div><div class=\"line\">./configure --prefix=/usr/<span class=\"built_in\">local</span>/php-7.1.5 --<span class=\"built_in\">enable</span>-fpm --with-fpm-user=nginx --with-fpm-group=nginx --with-mysqli --with-pdo-mysql --with-zlib --with-curl --with-gd --with-jpeg-dir --with-png-dir --with-freetype-dir --with-openssl --<span class=\"built_in\">enable</span>-mbstring --<span class=\"built_in\">enable</span>-ftp --<span class=\"built_in\">enable</span>-zip</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 安装</span></div><div class=\"line\">make &amp;&amp; make install</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># copy php.ini</span></div><div class=\"line\">cp php.ini-development /usr/<span class=\"built_in\">local</span>/php-7.1.5/lib/php.ini</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 修改 php.ini 文件</span></div><div class=\"line\">mysqli.default_socket = /var/lib/mysql/mysql.sock</div><div class=\"line\">date.timezone = PRC</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 将 /usr/local/php-7.1.5 软链到 /usr/local/php</span></div><div class=\"line\">ln -s /usr/<span class=\"built_in\">local</span>/php-7.1.5 /usr/<span class=\"built_in\">local</span>/php</div><div class=\"line\"><span class=\"comment\"># 将一些常用的可执行文件（例如 php, pecl, pear 和 phpize）软链到 PATH 环境变量中。</span></div><div class=\"line\">ln -s /usr/<span class=\"built_in\">local</span>/php/bin/php /usr/sbin/php</div><div class=\"line\">ln -s /usr/<span class=\"built_in\">local</span>/php/bin/pecl /usr/sbin/pecl</div><div class=\"line\">ln -s /usr/<span class=\"built_in\">local</span>/php/bin/pear /usr/sbin/pear</div><div class=\"line\">ln -s /usr/<span class=\"built_in\">local</span>/php/bin/phpize /usr/sbin/phpize</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 配置 php-fpm</span></div><div class=\"line\">cp /usr/<span class=\"built_in\">local</span>/php-7.1.5/etc/php-fpm.conf.default /usr/<span class=\"built_in\">local</span>/php-7.1.5/etc/php-fpm.conf</div><div class=\"line\">cp /usr/<span class=\"built_in\">local</span>/php-7.1.5/etc/php-fpm.d/www.conf.default /usr/<span class=\"built_in\">local</span>/php-7.1.5/etc/php-fpm.d/www.conf</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 查找 /usr/local/php-7.1.5/etc/php-fpm.d/www.conf user 和 group 看看是不是安装时指定的 nginx </span></div><div class=\"line\">user = nginx</div><div class=\"line\">group = nginx</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 配置 php-fpm 启动服务脚本</span></div><div class=\"line\">cp /usr/<span class=\"built_in\">local</span>/src/php-7.1.5/sapi/fpm/php-fpm.service /usr/lib/systemd/system/php71-fpm.service</div><div class=\"line\"><span class=\"comment\"># php-fpm 随机启动</span></div><div class=\"line\">systemctl <span class=\"built_in\">enable</span> php71-fpm</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 重新载入 systemd</span></div><div class=\"line\">systemctl daemon-reload</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 启动 php71-fpm</span></div><div class=\"line\">systemctl start php71-fpm</div><div class=\"line\"><span class=\"comment\"># 查看php71-fpm当前状态</span></div><div class=\"line\">systemctl status php71-fpm</div></pre></div></div></figure>\n<h1 id=\"end\"><a href=\"#end\" class=\"headerlink\" title=\"end\"></a>end</h1><p>添加 nginx 配置文件<br> <figure class=\"highlight nginx\"><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></div><div class=\"code\"><pre><div class=\"line\"><span class=\"section\">server</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">listen</span>       <span class=\"number\">80</span>;</div><div class=\"line\">    <span class=\"attribute\">server_name</span>  localhost;</div><div class=\"line\">    <span class=\"attribute\">root</span>         /www/web;</div><div class=\"line\">    <span class=\"attribute\">location</span> / &#123;</div><div class=\"line\">        <span class=\"attribute\">index</span>  index.php index.html index.htm;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"attribute\">location</span> <span class=\"regexp\">~ \\.php$</span> &#123;</div><div class=\"line\">        <span class=\"attribute\">fastcgi_pass</span>   <span class=\"number\">127.0.0.1:9000</span>;</div><div class=\"line\">        <span class=\"attribute\">fastcgi_index</span>  index.php;</div><div class=\"line\">        <span class=\"attribute\">fastcgi_param</span>  SCRIPT_FILENAME  <span class=\"variable\">$document_root</span><span class=\"variable\">$fastcgi_script_name</span>;</div><div class=\"line\">        <span class=\"attribute\">include</span>        fastcgi_params;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></div></div></figure></p>\n<p> 重新加载<strong>Nginx</strong>配置 <code>systemctl reload nginx</code><br> 测试验证~<br> <img src=\"http://oyvpp7gqd.bkt.clouddn.com/18-6-29/84311977.jpg\" alt=\"phpinfo\"><br><code>`</code></p>\n<h1 id=\"CentOS7-安装-Nodejs\"><a href=\"#CentOS7-安装-Nodejs\" class=\"headerlink\" title=\"CentOS7 安装 Nodejs\"></a>CentOS7 安装 Nodejs</h1><p><code>curl --silent --location https://rpm.nodesource.com/setup_10.x | bash -</code> 10.x 可切换为对应版本号安装其他版本 执行完后再执行 <code>sudo yum install -y nodejs</code> 安装</p>\n","site":{"data":{}},"excerpt":"<p>服务器环境 <em>CentOS 7</em><br>","more":"</p>\n<h1 id=\"Nginx-安装\"><a href=\"#Nginx-安装\" class=\"headerlink\" title=\"Nginx 安装\"></a>Nginx 安装</h1><blockquote>\n<p>安装 yum repo, 在 <code>http://nginx.org/packages/centos/</code> 找到对应的版本</p>\n</blockquote>\n<figure class=\"highlight bash\"><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\">rpm -Uvh http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm</div></pre></div></div></figure>\n<p>安装<strong>Nginx</strong>: <code>yum install nginx</code><br>设置<strong>Nginx</strong>开机启动: <code>systemctl enable nginx</code><br>查看<strong>Nginx</strong>当前状态: <code>systemctl status nginx</code></p>\n<h1 id=\"MySQL-V5-7-安装\"><a href=\"#MySQL-V5-7-安装\" class=\"headerlink\" title=\"MySQL V5.7 安装\"></a>MySQL V5.7 安装</h1><blockquote>\n<p>安装 yum repo</p>\n</blockquote>\n<figure class=\"highlight bash\"><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\">rpm -Uvh http://dev.mysql.com/get/mysql57-community-release-el7-7.noarch.rpm</div></pre></div></div></figure>\n<p>安装<strong>MySQL</strong> V5.7: <code>yum install mysql-community-server mysql-community-devel</code></p>\n<blockquote>\n<p>安装完成后 MySQL 会默认加到自动启动服务中, 并且会分配一个随机的 Root 密码<br>可以使用 <code>grep &#39;temporary password&#39; /var/log/mysqld.log</code> 这个命令来查看密码</p>\n</blockquote>\n<p>启动<strong>MySQL</strong>: <code>systemctl start mysqld</code><br>修改<strong>MySQL</strong>密码: <code>ALTER USER &#39;root&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;022.Admin&#39;;</code> <em>不写到这我还真记不住</em></p>\n<h1 id=\"PHP-V7-安装\"><a href=\"#PHP-V7-安装\" class=\"headerlink\" title=\"PHP V7 安装\"></a>PHP V7 安装</h1><p>下载<strong>PHP 7.1.5</strong> 的源码包: <code>wget -c http://cn2.php.net/distributions/php-7.1.5.tar.gz</code><br>解压并进入文件夹 </p>\n<blockquote>\n<ul>\n<li><code>tar zxvf php-7.1.5.tar.gz</code></li>\n<li><code>cd php-7.1.5</code></li>\n</ul>\n</blockquote>\n<figure class=\"highlight bash\"><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># 安装扩展依赖包</span></div><div class=\"line\">yum -y install gcc libjpeg libjpeg-devel libpng libpng-devel freetype freetype-devel libxml2 libxml2-devel zlib zlib-devel curl curl-devel openssl openssl-devel</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 配置 PHP</span></div><div class=\"line\">./configure --prefix=/usr/<span class=\"built_in\">local</span>/php-7.1.5 --<span class=\"built_in\">enable</span>-fpm --with-fpm-user=nginx --with-fpm-group=nginx --with-mysqli --with-pdo-mysql --with-zlib --with-curl --with-gd --with-jpeg-dir --with-png-dir --with-freetype-dir --with-openssl --<span class=\"built_in\">enable</span>-mbstring --<span class=\"built_in\">enable</span>-ftp --<span class=\"built_in\">enable</span>-zip</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 安装</span></div><div class=\"line\">make &amp;&amp; make install</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># copy php.ini</span></div><div class=\"line\">cp php.ini-development /usr/<span class=\"built_in\">local</span>/php-7.1.5/lib/php.ini</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 修改 php.ini 文件</span></div><div class=\"line\">mysqli.default_socket = /var/lib/mysql/mysql.sock</div><div class=\"line\">date.timezone = PRC</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 将 /usr/local/php-7.1.5 软链到 /usr/local/php</span></div><div class=\"line\">ln -s /usr/<span class=\"built_in\">local</span>/php-7.1.5 /usr/<span class=\"built_in\">local</span>/php</div><div class=\"line\"><span class=\"comment\"># 将一些常用的可执行文件（例如 php, pecl, pear 和 phpize）软链到 PATH 环境变量中。</span></div><div class=\"line\">ln -s /usr/<span class=\"built_in\">local</span>/php/bin/php /usr/sbin/php</div><div class=\"line\">ln -s /usr/<span class=\"built_in\">local</span>/php/bin/pecl /usr/sbin/pecl</div><div class=\"line\">ln -s /usr/<span class=\"built_in\">local</span>/php/bin/pear /usr/sbin/pear</div><div class=\"line\">ln -s /usr/<span class=\"built_in\">local</span>/php/bin/phpize /usr/sbin/phpize</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 配置 php-fpm</span></div><div class=\"line\">cp /usr/<span class=\"built_in\">local</span>/php-7.1.5/etc/php-fpm.conf.default /usr/<span class=\"built_in\">local</span>/php-7.1.5/etc/php-fpm.conf</div><div class=\"line\">cp /usr/<span class=\"built_in\">local</span>/php-7.1.5/etc/php-fpm.d/www.conf.default /usr/<span class=\"built_in\">local</span>/php-7.1.5/etc/php-fpm.d/www.conf</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 查找 /usr/local/php-7.1.5/etc/php-fpm.d/www.conf user 和 group 看看是不是安装时指定的 nginx </span></div><div class=\"line\">user = nginx</div><div class=\"line\">group = nginx</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 配置 php-fpm 启动服务脚本</span></div><div class=\"line\">cp /usr/<span class=\"built_in\">local</span>/src/php-7.1.5/sapi/fpm/php-fpm.service /usr/lib/systemd/system/php71-fpm.service</div><div class=\"line\"><span class=\"comment\"># php-fpm 随机启动</span></div><div class=\"line\">systemctl <span class=\"built_in\">enable</span> php71-fpm</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 重新载入 systemd</span></div><div class=\"line\">systemctl daemon-reload</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 启动 php71-fpm</span></div><div class=\"line\">systemctl start php71-fpm</div><div class=\"line\"><span class=\"comment\"># 查看php71-fpm当前状态</span></div><div class=\"line\">systemctl status php71-fpm</div></pre></div></div></figure>\n<h1 id=\"end\"><a href=\"#end\" class=\"headerlink\" title=\"end\"></a>end</h1><p>添加 nginx 配置文件<br> <figure class=\"highlight nginx\"><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></div><div class=\"code\"><pre><div class=\"line\"><span class=\"section\">server</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">listen</span>       <span class=\"number\">80</span>;</div><div class=\"line\">    <span class=\"attribute\">server_name</span>  localhost;</div><div class=\"line\">    <span class=\"attribute\">root</span>         /www/web;</div><div class=\"line\">    <span class=\"attribute\">location</span> / &#123;</div><div class=\"line\">        <span class=\"attribute\">index</span>  index.php index.html index.htm;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"attribute\">location</span> <span class=\"regexp\">~ \\.php$</span> &#123;</div><div class=\"line\">        <span class=\"attribute\">fastcgi_pass</span>   <span class=\"number\">127.0.0.1:9000</span>;</div><div class=\"line\">        <span class=\"attribute\">fastcgi_index</span>  index.php;</div><div class=\"line\">        <span class=\"attribute\">fastcgi_param</span>  SCRIPT_FILENAME  <span class=\"variable\">$document_root</span><span class=\"variable\">$fastcgi_script_name</span>;</div><div class=\"line\">        <span class=\"attribute\">include</span>        fastcgi_params;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></div></div></figure></p>\n<p> 重新加载<strong>Nginx</strong>配置 <code>systemctl reload nginx</code><br> 测试验证~<br> <img src=\"http://oyvpp7gqd.bkt.clouddn.com/18-6-29/84311977.jpg\" alt=\"phpinfo\"><br><code>`</code></p>\n<h1 id=\"CentOS7-安装-Nodejs\"><a href=\"#CentOS7-安装-Nodejs\" class=\"headerlink\" title=\"CentOS7 安装 Nodejs\"></a>CentOS7 安装 Nodejs</h1><p><code>curl --silent --location https://rpm.nodesource.com/setup_10.x | bash -</code> 10.x 可切换为对应版本号安装其他版本 执行完后再执行 <code>sudo yum install -y nodejs</code> 安装</p>"},{"title":"Form表单校验插件","date":"2018-09-01T16:14:47.000Z","_content":"\n> FormCheck 为了解决开发中经常用到的前端表单验证，避免重复开发，\n> 一方面又为了加强前端知识理解，所以写一个小插件\n \n项目地址： [GitHub](https://github.com/kjh123/FormCheck) \n\n<!--more-->\n\n# 示例\n功能示例：\n[代码示例](http://oyvpp7gqd.bkt.clouddn.com/18-9-2/10786793.jpg)\n[校验结果（失败：不能为空）](http://oyvpp7gqd.bkt.clouddn.com/18-9-3/57556757.jpg)\n[校验结果（失败：长度不符）](http://oyvpp7gqd.bkt.clouddn.com/18-9-3/4882940.jpg)\n[校验结果（成功）](http://oyvpp7gqd.bkt.clouddn.com/18-9-3/29547995.jpg)\n示例说明：\n```html\n<!-- 为更好的说明 已省略非必要部分 -->\n\n <!-- 在表单的 Form 元素上添加 `id=\"FormCheck\"`  用于指定监听需要校验的表单 -->\n<form id=\"FormCheck\">\n    ···\n     <!-- 在需要校验的表单元素上添加 `data-rules` 属性 \n     该属性为一个含有 attribute 属性 和 rules 属性的对象，\n     该 attribute 为提示信息的字段名称 rules 为校验规则 -->\n    <input type=\"text\" \n    data-rules='{\"attribute\":\"姓名\",\"rules\":[\"required\", \"length:2,8\"]}' \n    name=\"name\" value=\"\" placeholder=\"请输入姓名\" />\n\n    ----------------------------\n\n    该示例如果校验不通过则会提示：\n        - 若为空（required）：姓名不能为空\n        - 若长度不符（length:2,8）：姓名长度应该在2-8个字符之间\n            \n    ···\n</form>\n```\n# 使用\n\n1. 引入 `JQuery` （必须）\n2. 引入 `layer` （非必须，主要用来美化错误提示，可更换）\n3. 引入 `formCheck.js`\n4. 在页面需要校验的表单上添加 `id=\"FormCheck\"`\n5. 在需要校验的表单元素上添加 `data-rules` 属性 （具体规则可看规则列表）\n> `data-rules`  是一个包含 `attribute` 和 `rules` 属性的对象 \n> `attribute` 为提示信息的字段名称 \n> `rules` 规则必须使用数组形式来定义\n> 例如： \n> ```\n> data-rules='{\"attribute\":\"示例\",\"rules\"：[\"sometimes\",\"in:1,3,5\"]}'\n> ```\n\n# 规则列表\n`rules` 已实现的校验规则如下\n\n- `required` 可选规则，默认，表示该字段不能为空\n\n- `length:n,[m]` 长度校验 ： m 参数可选 \n    + 只有 **n** 参数表示 字段长度不小于 **n** 位  | 例如：\"length:4\" 验证长度必须不小于4位\n    + 加上 **m** 参数表示 字段长度在 **n** 到 **m** 个字符之间 | 例如：\"length:2,6\" 验证字段长度必须是2到6位\n    + 若想规定字段长度只能为具体值时，则 **n** 参数 应该为 eq | 例如：\"length:eq,2\" 规定长度只能是两位\n- `int:n,[m]` 数值校验 ： m 参数可选  同 length 规则\n    + 只有 **n** 参数表示 字段大小不小于 **n**  | 例如：\"int:4\" 验证值必须不小于4\n    + 加上 **m** 参数表示 字段大小在 **n** 到 **m** 个之间 | 例如：\"int:2,6\" 验证字段必须大于2并且小于6\n    + 若想规定字段大小只能为具体值时，则 **n** 参数 应该为 eq | 例如：\"int:eq,2\" 规定值只能是2\n- `in:n,m,···` 范围校验 ： 参数数量不限\n    + 当使用 **in** 范围校验时必须至少指定一个参数 例如：\"in:k,j,h\" 规定值的范围只能是在 k,j,h 中的某一个\n- `eq:n` 值校验 ： 校验值必须与参数 **n** 相等 例如：\"eq:hello\" 规定值必须为 hello\n\n- `max:n` 同 `lt:n`  值校验 ： 校验值必须大于参数 **n**\n\n- `min:n` 同 `gt:n`  值校验 ： 校验值必须小于参数 **n**\n\n- `phone` 同 `mobile` 手机号校验 \n\n- `idcard`  身份证号校验\n\n- `url` url地址校验\n\n- `email` 邮箱校验 \n\n# 其他规则\n\n- `sometime` 同 `sometimes` 表示可选校验，如果值为空，则不校验，反之，则校验\n\n# 最后\n个人能力有限，希望可以有志同道合的伙伴一起优化","source":"_posts/Form表单校验插件.md","raw":"---\ntitle: Form表单校验插件\ndate: 2018-09-02 00:14:47\ntags: [记录, 前端]\ncategories: JavaScript\n---\n\n> FormCheck 为了解决开发中经常用到的前端表单验证，避免重复开发，\n> 一方面又为了加强前端知识理解，所以写一个小插件\n \n项目地址： [GitHub](https://github.com/kjh123/FormCheck) \n\n<!--more-->\n\n# 示例\n功能示例：\n[代码示例](http://oyvpp7gqd.bkt.clouddn.com/18-9-2/10786793.jpg)\n[校验结果（失败：不能为空）](http://oyvpp7gqd.bkt.clouddn.com/18-9-3/57556757.jpg)\n[校验结果（失败：长度不符）](http://oyvpp7gqd.bkt.clouddn.com/18-9-3/4882940.jpg)\n[校验结果（成功）](http://oyvpp7gqd.bkt.clouddn.com/18-9-3/29547995.jpg)\n示例说明：\n```html\n<!-- 为更好的说明 已省略非必要部分 -->\n\n <!-- 在表单的 Form 元素上添加 `id=\"FormCheck\"`  用于指定监听需要校验的表单 -->\n<form id=\"FormCheck\">\n    ···\n     <!-- 在需要校验的表单元素上添加 `data-rules` 属性 \n     该属性为一个含有 attribute 属性 和 rules 属性的对象，\n     该 attribute 为提示信息的字段名称 rules 为校验规则 -->\n    <input type=\"text\" \n    data-rules='{\"attribute\":\"姓名\",\"rules\":[\"required\", \"length:2,8\"]}' \n    name=\"name\" value=\"\" placeholder=\"请输入姓名\" />\n\n    ----------------------------\n\n    该示例如果校验不通过则会提示：\n        - 若为空（required）：姓名不能为空\n        - 若长度不符（length:2,8）：姓名长度应该在2-8个字符之间\n            \n    ···\n</form>\n```\n# 使用\n\n1. 引入 `JQuery` （必须）\n2. 引入 `layer` （非必须，主要用来美化错误提示，可更换）\n3. 引入 `formCheck.js`\n4. 在页面需要校验的表单上添加 `id=\"FormCheck\"`\n5. 在需要校验的表单元素上添加 `data-rules` 属性 （具体规则可看规则列表）\n> `data-rules`  是一个包含 `attribute` 和 `rules` 属性的对象 \n> `attribute` 为提示信息的字段名称 \n> `rules` 规则必须使用数组形式来定义\n> 例如： \n> ```\n> data-rules='{\"attribute\":\"示例\",\"rules\"：[\"sometimes\",\"in:1,3,5\"]}'\n> ```\n\n# 规则列表\n`rules` 已实现的校验规则如下\n\n- `required` 可选规则，默认，表示该字段不能为空\n\n- `length:n,[m]` 长度校验 ： m 参数可选 \n    + 只有 **n** 参数表示 字段长度不小于 **n** 位  | 例如：\"length:4\" 验证长度必须不小于4位\n    + 加上 **m** 参数表示 字段长度在 **n** 到 **m** 个字符之间 | 例如：\"length:2,6\" 验证字段长度必须是2到6位\n    + 若想规定字段长度只能为具体值时，则 **n** 参数 应该为 eq | 例如：\"length:eq,2\" 规定长度只能是两位\n- `int:n,[m]` 数值校验 ： m 参数可选  同 length 规则\n    + 只有 **n** 参数表示 字段大小不小于 **n**  | 例如：\"int:4\" 验证值必须不小于4\n    + 加上 **m** 参数表示 字段大小在 **n** 到 **m** 个之间 | 例如：\"int:2,6\" 验证字段必须大于2并且小于6\n    + 若想规定字段大小只能为具体值时，则 **n** 参数 应该为 eq | 例如：\"int:eq,2\" 规定值只能是2\n- `in:n,m,···` 范围校验 ： 参数数量不限\n    + 当使用 **in** 范围校验时必须至少指定一个参数 例如：\"in:k,j,h\" 规定值的范围只能是在 k,j,h 中的某一个\n- `eq:n` 值校验 ： 校验值必须与参数 **n** 相等 例如：\"eq:hello\" 规定值必须为 hello\n\n- `max:n` 同 `lt:n`  值校验 ： 校验值必须大于参数 **n**\n\n- `min:n` 同 `gt:n`  值校验 ： 校验值必须小于参数 **n**\n\n- `phone` 同 `mobile` 手机号校验 \n\n- `idcard`  身份证号校验\n\n- `url` url地址校验\n\n- `email` 邮箱校验 \n\n# 其他规则\n\n- `sometime` 同 `sometimes` 表示可选校验，如果值为空，则不校验，反之，则校验\n\n# 最后\n个人能力有限，希望可以有志同道合的伙伴一起优化","slug":"Form表单校验插件","published":1,"updated":"2018-11-08T04:19:01.028Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjopirm5w00022cwmsoclm12b","content":"<blockquote>\n<p>FormCheck 为了解决开发中经常用到的前端表单验证，避免重复开发，<br>一方面又为了加强前端知识理解，所以写一个小插件</p>\n</blockquote>\n<p>项目地址： <a href=\"https://github.com/kjh123/FormCheck\" target=\"_blank\" rel=\"noopener\">GitHub</a> </p>\n<a id=\"more\"></a>\n<h1 id=\"示例\"><a href=\"#示例\" class=\"headerlink\" title=\"示例\"></a>示例</h1><p>功能示例：<br><a href=\"http://oyvpp7gqd.bkt.clouddn.com/18-9-2/10786793.jpg\" target=\"_blank\" rel=\"noopener\">代码示例</a><br><a href=\"http://oyvpp7gqd.bkt.clouddn.com/18-9-3/57556757.jpg\" target=\"_blank\" rel=\"noopener\">校验结果（失败：不能为空）</a><br><a href=\"http://oyvpp7gqd.bkt.clouddn.com/18-9-3/4882940.jpg\" target=\"_blank\" rel=\"noopener\">校验结果（失败：长度不符）</a><br><a href=\"http://oyvpp7gqd.bkt.clouddn.com/18-9-3/29547995.jpg\" target=\"_blank\" rel=\"noopener\">校验结果（成功）</a><br>示例说明：<br><figure class=\"highlight html\"><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div></pre></div><div class=\"code\"><pre><div class=\"line\"><span class=\"comment\">&lt;!-- 为更好的说明 已省略非必要部分 --&gt;</span></div><div class=\"line\"></div><div class=\"line\"> <span class=\"comment\">&lt;!-- 在表单的 Form 元素上添加 `id=\"FormCheck\"`  用于指定监听需要校验的表单 --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span> <span class=\"attr\">id</span>=<span class=\"string\">\"FormCheck\"</span>&gt;</span></div><div class=\"line\">    ···</div><div class=\"line\">     <span class=\"comment\">&lt;!-- 在需要校验的表单元素上添加 `data-rules` 属性 </span></div><div class=\"line\"><span class=\"comment\">     该属性为一个含有 attribute 属性 和 rules 属性的对象，</span></div><div class=\"line\"><span class=\"comment\">     该 attribute 为提示信息的字段名称 rules 为校验规则 --&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span> </span></div><div class=\"line\"><span class=\"tag\">    <span class=\"attr\">data-rules</span>=<span class=\"string\">'&#123;\"attribute\":\"姓名\",\"rules\":[\"required\", \"length:2,8\"]&#125;'</span> </span></div><div class=\"line\"><span class=\"tag\">    <span class=\"attr\">name</span>=<span class=\"string\">\"name\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"\"</span> <span class=\"attr\">placeholder</span>=<span class=\"string\">\"请输入姓名\"</span> /&gt;</span></div><div class=\"line\"></div><div class=\"line\">    ----------------------------</div><div class=\"line\"></div><div class=\"line\">    该示例如果校验不通过则会提示：</div><div class=\"line\">        - 若为空（required）：姓名不能为空</div><div class=\"line\">        - 若长度不符（length:2,8）：姓名长度应该在2-8个字符之间</div><div class=\"line\">            </div><div class=\"line\">    ···</div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></div></pre></div></div></figure></p>\n<h1 id=\"使用\"><a href=\"#使用\" class=\"headerlink\" title=\"使用\"></a>使用</h1><ol>\n<li>引入 <code>JQuery</code> （必须）</li>\n<li>引入 <code>layer</code> （非必须，主要用来美化错误提示，可更换）</li>\n<li>引入 <code>formCheck.js</code></li>\n<li>在页面需要校验的表单上添加 <code>id=&quot;FormCheck&quot;</code></li>\n<li>在需要校验的表单元素上添加 <code>data-rules</code> 属性 （具体规则可看规则列表）<blockquote>\n<p><code>data-rules</code>  是一个包含 <code>attribute</code> 和 <code>rules</code> 属性的对象<br><code>attribute</code> 为提示信息的字段名称<br><code>rules</code> 规则必须使用数组形式来定义<br>例如： </p>\n<figure class=\"highlight plain\"><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></div><div class=\"code\"><pre><div class=\"line\">&gt; data-rules=&apos;&#123;&quot;attribute&quot;:&quot;示例&quot;,&quot;rules&quot;：[&quot;sometimes&quot;,&quot;in:1,3,5&quot;]&#125;&apos;</div><div class=\"line\">&gt;</div></pre></div></div></figure>\n</blockquote>\n</li>\n</ol>\n<h1 id=\"规则列表\"><a href=\"#规则列表\" class=\"headerlink\" title=\"规则列表\"></a>规则列表</h1><p><code>rules</code> 已实现的校验规则如下</p>\n<ul>\n<li><p><code>required</code> 可选规则，默认，表示该字段不能为空</p>\n</li>\n<li><p><code>length:n,[m]</code> 长度校验 ： m 参数可选 </p>\n<ul>\n<li>只有 <strong>n</strong> 参数表示 字段长度不小于 <strong>n</strong> 位  | 例如：”length:4” 验证长度必须不小于4位</li>\n<li>加上 <strong>m</strong> 参数表示 字段长度在 <strong>n</strong> 到 <strong>m</strong> 个字符之间 | 例如：”length:2,6” 验证字段长度必须是2到6位</li>\n<li>若想规定字段长度只能为具体值时，则 <strong>n</strong> 参数 应该为 eq | 例如：”length:eq,2” 规定长度只能是两位</li>\n</ul>\n</li>\n<li><code>int:n,[m]</code> 数值校验 ： m 参数可选  同 length 规则<ul>\n<li>只有 <strong>n</strong> 参数表示 字段大小不小于 <strong>n</strong>  | 例如：”int:4” 验证值必须不小于4</li>\n<li>加上 <strong>m</strong> 参数表示 字段大小在 <strong>n</strong> 到 <strong>m</strong> 个之间 | 例如：”int:2,6” 验证字段必须大于2并且小于6</li>\n<li>若想规定字段大小只能为具体值时，则 <strong>n</strong> 参数 应该为 eq | 例如：”int:eq,2” 规定值只能是2</li>\n</ul>\n</li>\n<li><code>in:n,m,···</code> 范围校验 ： 参数数量不限<ul>\n<li>当使用 <strong>in</strong> 范围校验时必须至少指定一个参数 例如：”in:k,j,h” 规定值的范围只能是在 k,j,h 中的某一个</li>\n</ul>\n</li>\n<li><p><code>eq:n</code> 值校验 ： 校验值必须与参数 <strong>n</strong> 相等 例如：”eq:hello” 规定值必须为 hello</p>\n</li>\n<li><p><code>max:n</code> 同 <code>lt:n</code>  值校验 ： 校验值必须大于参数 <strong>n</strong></p>\n</li>\n<li><p><code>min:n</code> 同 <code>gt:n</code>  值校验 ： 校验值必须小于参数 <strong>n</strong></p>\n</li>\n<li><p><code>phone</code> 同 <code>mobile</code> 手机号校验 </p>\n</li>\n<li><p><code>idcard</code>  身份证号校验</p>\n</li>\n<li><p><code>url</code> url地址校验</p>\n</li>\n<li><p><code>email</code> 邮箱校验 </p>\n</li>\n</ul>\n<h1 id=\"其他规则\"><a href=\"#其他规则\" class=\"headerlink\" title=\"其他规则\"></a>其他规则</h1><ul>\n<li><code>sometime</code> 同 <code>sometimes</code> 表示可选校验，如果值为空，则不校验，反之，则校验</li>\n</ul>\n<h1 id=\"最后\"><a href=\"#最后\" class=\"headerlink\" title=\"最后\"></a>最后</h1><p>个人能力有限，希望可以有志同道合的伙伴一起优化</p>\n","site":{"data":{}},"excerpt":"<blockquote>\n<p>FormCheck 为了解决开发中经常用到的前端表单验证，避免重复开发，<br>一方面又为了加强前端知识理解，所以写一个小插件</p>\n</blockquote>\n<p>项目地址： <a href=\"https://github.com/kjh123/FormCheck\" target=\"_blank\" rel=\"noopener\">GitHub</a> </p>","more":"<h1 id=\"示例\"><a href=\"#示例\" class=\"headerlink\" title=\"示例\"></a>示例</h1><p>功能示例：<br><a href=\"http://oyvpp7gqd.bkt.clouddn.com/18-9-2/10786793.jpg\" target=\"_blank\" rel=\"noopener\">代码示例</a><br><a href=\"http://oyvpp7gqd.bkt.clouddn.com/18-9-3/57556757.jpg\" target=\"_blank\" rel=\"noopener\">校验结果（失败：不能为空）</a><br><a href=\"http://oyvpp7gqd.bkt.clouddn.com/18-9-3/4882940.jpg\" target=\"_blank\" rel=\"noopener\">校验结果（失败：长度不符）</a><br><a href=\"http://oyvpp7gqd.bkt.clouddn.com/18-9-3/29547995.jpg\" target=\"_blank\" rel=\"noopener\">校验结果（成功）</a><br>示例说明：<br><figure class=\"highlight html\"><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div></pre></div><div class=\"code\"><pre><div class=\"line\"><span class=\"comment\">&lt;!-- 为更好的说明 已省略非必要部分 --&gt;</span></div><div class=\"line\"></div><div class=\"line\"> <span class=\"comment\">&lt;!-- 在表单的 Form 元素上添加 `id=\"FormCheck\"`  用于指定监听需要校验的表单 --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span> <span class=\"attr\">id</span>=<span class=\"string\">\"FormCheck\"</span>&gt;</span></div><div class=\"line\">    ···</div><div class=\"line\">     <span class=\"comment\">&lt;!-- 在需要校验的表单元素上添加 `data-rules` 属性 </span></div><div class=\"line\"><span class=\"comment\">     该属性为一个含有 attribute 属性 和 rules 属性的对象，</span></div><div class=\"line\"><span class=\"comment\">     该 attribute 为提示信息的字段名称 rules 为校验规则 --&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span> </span></div><div class=\"line\"><span class=\"tag\">    <span class=\"attr\">data-rules</span>=<span class=\"string\">'&#123;\"attribute\":\"姓名\",\"rules\":[\"required\", \"length:2,8\"]&#125;'</span> </span></div><div class=\"line\"><span class=\"tag\">    <span class=\"attr\">name</span>=<span class=\"string\">\"name\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"\"</span> <span class=\"attr\">placeholder</span>=<span class=\"string\">\"请输入姓名\"</span> /&gt;</span></div><div class=\"line\"></div><div class=\"line\">    ----------------------------</div><div class=\"line\"></div><div class=\"line\">    该示例如果校验不通过则会提示：</div><div class=\"line\">        - 若为空（required）：姓名不能为空</div><div class=\"line\">        - 若长度不符（length:2,8）：姓名长度应该在2-8个字符之间</div><div class=\"line\">            </div><div class=\"line\">    ···</div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></div></pre></div></div></figure></p>\n<h1 id=\"使用\"><a href=\"#使用\" class=\"headerlink\" title=\"使用\"></a>使用</h1><ol>\n<li>引入 <code>JQuery</code> （必须）</li>\n<li>引入 <code>layer</code> （非必须，主要用来美化错误提示，可更换）</li>\n<li>引入 <code>formCheck.js</code></li>\n<li>在页面需要校验的表单上添加 <code>id=&quot;FormCheck&quot;</code></li>\n<li>在需要校验的表单元素上添加 <code>data-rules</code> 属性 （具体规则可看规则列表）<blockquote>\n<p><code>data-rules</code>  是一个包含 <code>attribute</code> 和 <code>rules</code> 属性的对象<br><code>attribute</code> 为提示信息的字段名称<br><code>rules</code> 规则必须使用数组形式来定义<br>例如： </p>\n<figure class=\"highlight plain\"><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></div><div class=\"code\"><pre><div class=\"line\">&gt; data-rules=&apos;&#123;&quot;attribute&quot;:&quot;示例&quot;,&quot;rules&quot;：[&quot;sometimes&quot;,&quot;in:1,3,5&quot;]&#125;&apos;</div><div class=\"line\">&gt;</div></pre></div></div></figure>\n</blockquote>\n</li>\n</ol>\n<h1 id=\"规则列表\"><a href=\"#规则列表\" class=\"headerlink\" title=\"规则列表\"></a>规则列表</h1><p><code>rules</code> 已实现的校验规则如下</p>\n<ul>\n<li><p><code>required</code> 可选规则，默认，表示该字段不能为空</p>\n</li>\n<li><p><code>length:n,[m]</code> 长度校验 ： m 参数可选 </p>\n<ul>\n<li>只有 <strong>n</strong> 参数表示 字段长度不小于 <strong>n</strong> 位  | 例如：”length:4” 验证长度必须不小于4位</li>\n<li>加上 <strong>m</strong> 参数表示 字段长度在 <strong>n</strong> 到 <strong>m</strong> 个字符之间 | 例如：”length:2,6” 验证字段长度必须是2到6位</li>\n<li>若想规定字段长度只能为具体值时，则 <strong>n</strong> 参数 应该为 eq | 例如：”length:eq,2” 规定长度只能是两位</li>\n</ul>\n</li>\n<li><code>int:n,[m]</code> 数值校验 ： m 参数可选  同 length 规则<ul>\n<li>只有 <strong>n</strong> 参数表示 字段大小不小于 <strong>n</strong>  | 例如：”int:4” 验证值必须不小于4</li>\n<li>加上 <strong>m</strong> 参数表示 字段大小在 <strong>n</strong> 到 <strong>m</strong> 个之间 | 例如：”int:2,6” 验证字段必须大于2并且小于6</li>\n<li>若想规定字段大小只能为具体值时，则 <strong>n</strong> 参数 应该为 eq | 例如：”int:eq,2” 规定值只能是2</li>\n</ul>\n</li>\n<li><code>in:n,m,···</code> 范围校验 ： 参数数量不限<ul>\n<li>当使用 <strong>in</strong> 范围校验时必须至少指定一个参数 例如：”in:k,j,h” 规定值的范围只能是在 k,j,h 中的某一个</li>\n</ul>\n</li>\n<li><p><code>eq:n</code> 值校验 ： 校验值必须与参数 <strong>n</strong> 相等 例如：”eq:hello” 规定值必须为 hello</p>\n</li>\n<li><p><code>max:n</code> 同 <code>lt:n</code>  值校验 ： 校验值必须大于参数 <strong>n</strong></p>\n</li>\n<li><p><code>min:n</code> 同 <code>gt:n</code>  值校验 ： 校验值必须小于参数 <strong>n</strong></p>\n</li>\n<li><p><code>phone</code> 同 <code>mobile</code> 手机号校验 </p>\n</li>\n<li><p><code>idcard</code>  身份证号校验</p>\n</li>\n<li><p><code>url</code> url地址校验</p>\n</li>\n<li><p><code>email</code> 邮箱校验 </p>\n</li>\n</ul>\n<h1 id=\"其他规则\"><a href=\"#其他规则\" class=\"headerlink\" title=\"其他规则\"></a>其他规则</h1><ul>\n<li><code>sometime</code> 同 <code>sometimes</code> 表示可选校验，如果值为空，则不校验，反之，则校验</li>\n</ul>\n<h1 id=\"最后\"><a href=\"#最后\" class=\"headerlink\" title=\"最后\"></a>最后</h1><p>个人能力有限，希望可以有志同道合的伙伴一起优化</p>"},{"title":"Docker学习笔记","date":"2018-06-30T07:30:34.000Z","_content":">前段时间有学过一些 `Docker` 的相关知识，但最近忙于工作，对这方面还是有些疏忽了，就再次学习下，然后做个笔记\n\n<!--more-->\n\n-----\n\n*系统环境 `CenterOS 7`*\n\n# 安装 Docker \n> 版本：社区版（Docker Community Edition）\n> 介绍：[Docker在PHP项目开发中的应用](https://avnpc.com/pages/build-php-develop-env-by-docker)\n> 相关资料：[Docker-从入门到实践](https://yeasy.gitbooks.io/docker_practice/content/)\n> 如果之前有安装过的旧版本 先卸载 `yum remove docker  docker-common docker-selinux docker-engine`\n**因为我服务器中已安装了一套运行环境为避免冲突，相关应用会修改相应的端口**\n\n- 添加软件源:\n```bash line_number:false\nyum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo\n\n# 如果没有 yum-config-manager 命令则执行下面\nyum install -y yum-utils device-mapper-persistent-data lvm2\n```\n- 查看软件仓库中所有的 `Docker` 版本\n```bash line_number:false\nyum list docker-ce --showduplicates | sort -r\n```\n- 安装最新版本 [ 指定版本 ]\n```bash line_number:false\n# [docker-ce] 替换指定版本\nsudo yum install [docker-ce]\n```\n- 加入 `Docker` 到开机启动\n```bash line_number:false\nsystemctl enable docker\n```\n- 启动 `Docker` \n```bash line_number:false\nsystemctl start docker\n```\n- 查看 `Docker` 状态\n```bash line_number:false\nsystemctl status docker\n```\n- 安装 `docker-compose` [docker-compose介绍](http://dockone.io/article/34)\n```bash line_number:false\npip install docker-compose\n```\n- 加速 `Docker` \n```bash line_number:false\ncurl -sSL https://get.daocloud.io/daotools/set_mirror.sh | sh -s http://9d4cd35f.m.daocloud.io\n\n# 修改完成后会提示重启\nsystemctl restart docker\n```\n\n# 在 `Docker` 上构建 `LNMP` 环境\n## 分别拉取需要的镜像文件\n### MySQL\n```bash line_number:false\n# 获取 mysql5.6 版本的docker镜像\ndocker pull mysql:5.6\n# 创建mysql容器\ndocker run -d -p 3307:3306 -e MYSQL_ROOT_PASSWORD=admin --name mysql5.6 mysql:5.6\n# -d：让容器在后台运行\n# -p：添加主机到容器的端口映射\n# -e：设置环境变量，这里是设置MySQL的root账户的初始密码 （必选）\n# -name：容器的名字，必须唯一\n```\n### PHP-FPM\n```bash line_number:false\n# 拉取php-fpm \ndocker pull php:7.1-fpm\n# 创建 php-fpm 容器\ndocker run -d -v /www:/var/www/html -p 9001:9000 --link mysql5.6:mysql --name phpfpm7.1 php:7.1-fpm \n# -v 目录映射，把主机的 /www 目录映射到容器中的 /var/www/html 目录\n# –link 与另外一个容器建立起联系，这样我们就可以在当前容器中去使用另一个容器里的服务。\n#      或者使用 ip 去访问其它容器的服务\n```\n> **在PHP-FPM容器中**  安装PHP扩展使用命令 `docker-php-ext-install pdo_mysql`\n\n### Nginx\n```bash\n# 拉取 Nginx 镜像\ndocker pull nginx:1.14.0\n# 创建 Nginx 容器\ndocker run -d -p 81:80 -v /www:/var/www/html --link phpfpm7.1:phpfpm --name nginx nginx:1.14.0\n```\n> **在Nginx容器中** 修改nginx配置文件\n```bash :/etc/nginx/conf.d/default.conf line_number:false \nlocation ~ \\.php$ {\n    root           /var/www/html;\n    fastcgi_index  index.php;\n    fastcgi_pass   phpfpm:9001;\n    fastcgi_param  SCRIPT_FILENAME $document_root$fastcdi_script_name;\n    include        fastcgi_params;\n}\n```\n### 测试\n![info](http://oyvpp7gqd.bkt.clouddn.com/18-7-2/11032690.jpg)\n\n## 使用 `DockerFile` 构建环境\n> 推荐阅读：[如何编写最佳的Dockerfile](http://www.phpchina.com/portal.php?mod=view&aid=41111)\n\n### 介绍\n`DockerFile` 是 `Docker` 用来构建镜像的一个文件，包含自定义的指令，类似于shell脚本，把一系列的指令集和放在一个 .sh 文件中去执行\n**DockerFile**分为四部分组成：**基础镜像信**、**维护者信息**、**镜像操作指令** 和 **容器启动时执行指令**。例如：\n```bash :dockerfile line_number:false url:https://blog.csdn.net/mozf881/article/details/55798811 相关链接\n# 第一行必须指令基于的基础镜像\nFrom ubutu\n\n# 维护者信息\nMAINTAINER docker_user  docker_user@mail.com\n\n# 镜像的操作指令\napt/sourcelist.list\n\nRUN apt-get update && apt-get install -y ngnix \nRUN echo \"\\ndaemon off;\">>/etc/ngnix/nignix.conf\n\n# 容器启动时执行指令\nCMD /usr/sbin/ngnix\n```\n![dockerfile](http://oyvpp7gqd.bkt.clouddn.com/18-7-2/8082419.jpg)\n\n# Docker 相关命令\n1. `docker images`  查看本地**docker**镜像文件\n2. `docker ps -a`   查看所有容器的进程情况\n3. `docker exec -ti docker_names /bin/bash` 进入docker容器中\n> -t 在容器里生产一个伪终端\n> -i 对容器内的标准输入 (STDIN) 进行交互\n4.  `docker stop name`  停止一个运行中的容器\n    `docker rm name`    删除本地一个容器 （需要该容器处于未运行状态）\n    `docker rmi image`  删除本地一个镜像文件\n","source":"_posts/Docker学习笔记.md","raw":"---\ntitle: Docker学习笔记\ndate: 2018-06-30 15:30:34\ntags: [Linux, Docker, CenterOS]\ncategories: Linux\n---\n>前段时间有学过一些 `Docker` 的相关知识，但最近忙于工作，对这方面还是有些疏忽了，就再次学习下，然后做个笔记\n\n<!--more-->\n\n-----\n\n*系统环境 `CenterOS 7`*\n\n# 安装 Docker \n> 版本：社区版（Docker Community Edition）\n> 介绍：[Docker在PHP项目开发中的应用](https://avnpc.com/pages/build-php-develop-env-by-docker)\n> 相关资料：[Docker-从入门到实践](https://yeasy.gitbooks.io/docker_practice/content/)\n> 如果之前有安装过的旧版本 先卸载 `yum remove docker  docker-common docker-selinux docker-engine`\n**因为我服务器中已安装了一套运行环境为避免冲突，相关应用会修改相应的端口**\n\n- 添加软件源:\n```bash line_number:false\nyum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo\n\n# 如果没有 yum-config-manager 命令则执行下面\nyum install -y yum-utils device-mapper-persistent-data lvm2\n```\n- 查看软件仓库中所有的 `Docker` 版本\n```bash line_number:false\nyum list docker-ce --showduplicates | sort -r\n```\n- 安装最新版本 [ 指定版本 ]\n```bash line_number:false\n# [docker-ce] 替换指定版本\nsudo yum install [docker-ce]\n```\n- 加入 `Docker` 到开机启动\n```bash line_number:false\nsystemctl enable docker\n```\n- 启动 `Docker` \n```bash line_number:false\nsystemctl start docker\n```\n- 查看 `Docker` 状态\n```bash line_number:false\nsystemctl status docker\n```\n- 安装 `docker-compose` [docker-compose介绍](http://dockone.io/article/34)\n```bash line_number:false\npip install docker-compose\n```\n- 加速 `Docker` \n```bash line_number:false\ncurl -sSL https://get.daocloud.io/daotools/set_mirror.sh | sh -s http://9d4cd35f.m.daocloud.io\n\n# 修改完成后会提示重启\nsystemctl restart docker\n```\n\n# 在 `Docker` 上构建 `LNMP` 环境\n## 分别拉取需要的镜像文件\n### MySQL\n```bash line_number:false\n# 获取 mysql5.6 版本的docker镜像\ndocker pull mysql:5.6\n# 创建mysql容器\ndocker run -d -p 3307:3306 -e MYSQL_ROOT_PASSWORD=admin --name mysql5.6 mysql:5.6\n# -d：让容器在后台运行\n# -p：添加主机到容器的端口映射\n# -e：设置环境变量，这里是设置MySQL的root账户的初始密码 （必选）\n# -name：容器的名字，必须唯一\n```\n### PHP-FPM\n```bash line_number:false\n# 拉取php-fpm \ndocker pull php:7.1-fpm\n# 创建 php-fpm 容器\ndocker run -d -v /www:/var/www/html -p 9001:9000 --link mysql5.6:mysql --name phpfpm7.1 php:7.1-fpm \n# -v 目录映射，把主机的 /www 目录映射到容器中的 /var/www/html 目录\n# –link 与另外一个容器建立起联系，这样我们就可以在当前容器中去使用另一个容器里的服务。\n#      或者使用 ip 去访问其它容器的服务\n```\n> **在PHP-FPM容器中**  安装PHP扩展使用命令 `docker-php-ext-install pdo_mysql`\n\n### Nginx\n```bash\n# 拉取 Nginx 镜像\ndocker pull nginx:1.14.0\n# 创建 Nginx 容器\ndocker run -d -p 81:80 -v /www:/var/www/html --link phpfpm7.1:phpfpm --name nginx nginx:1.14.0\n```\n> **在Nginx容器中** 修改nginx配置文件\n```bash :/etc/nginx/conf.d/default.conf line_number:false \nlocation ~ \\.php$ {\n    root           /var/www/html;\n    fastcgi_index  index.php;\n    fastcgi_pass   phpfpm:9001;\n    fastcgi_param  SCRIPT_FILENAME $document_root$fastcdi_script_name;\n    include        fastcgi_params;\n}\n```\n### 测试\n![info](http://oyvpp7gqd.bkt.clouddn.com/18-7-2/11032690.jpg)\n\n## 使用 `DockerFile` 构建环境\n> 推荐阅读：[如何编写最佳的Dockerfile](http://www.phpchina.com/portal.php?mod=view&aid=41111)\n\n### 介绍\n`DockerFile` 是 `Docker` 用来构建镜像的一个文件，包含自定义的指令，类似于shell脚本，把一系列的指令集和放在一个 .sh 文件中去执行\n**DockerFile**分为四部分组成：**基础镜像信**、**维护者信息**、**镜像操作指令** 和 **容器启动时执行指令**。例如：\n```bash :dockerfile line_number:false url:https://blog.csdn.net/mozf881/article/details/55798811 相关链接\n# 第一行必须指令基于的基础镜像\nFrom ubutu\n\n# 维护者信息\nMAINTAINER docker_user  docker_user@mail.com\n\n# 镜像的操作指令\napt/sourcelist.list\n\nRUN apt-get update && apt-get install -y ngnix \nRUN echo \"\\ndaemon off;\">>/etc/ngnix/nignix.conf\n\n# 容器启动时执行指令\nCMD /usr/sbin/ngnix\n```\n![dockerfile](http://oyvpp7gqd.bkt.clouddn.com/18-7-2/8082419.jpg)\n\n# Docker 相关命令\n1. `docker images`  查看本地**docker**镜像文件\n2. `docker ps -a`   查看所有容器的进程情况\n3. `docker exec -ti docker_names /bin/bash` 进入docker容器中\n> -t 在容器里生产一个伪终端\n> -i 对容器内的标准输入 (STDIN) 进行交互\n4.  `docker stop name`  停止一个运行中的容器\n    `docker rm name`    删除本地一个容器 （需要该容器处于未运行状态）\n    `docker rmi image`  删除本地一个镜像文件\n","slug":"Docker学习笔记","published":1,"updated":"2018-11-08T04:19:01.025Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjopirm6800062cwmv9p8pm5f","content":"<blockquote>\n<p>前段时间有学过一些 <code>Docker</code> 的相关知识，但最近忙于工作，对这方面还是有些疏忽了，就再次学习下，然后做个笔记</p>\n</blockquote>\n<a id=\"more\"></a>\n<hr>\n<p><em>系统环境 <code>CenterOS 7</code></em></p>\n<h1 id=\"安装-Docker\"><a href=\"#安装-Docker\" class=\"headerlink\" title=\"安装 Docker\"></a>安装 Docker</h1><blockquote>\n<p>版本：社区版（Docker Community Edition）<br>介绍：<a href=\"https://avnpc.com/pages/build-php-develop-env-by-docker\" target=\"_blank\" rel=\"noopener\">Docker在PHP项目开发中的应用</a><br>相关资料：<a href=\"https://yeasy.gitbooks.io/docker_practice/content/\" target=\"_blank\" rel=\"noopener\">Docker-从入门到实践</a><br>如果之前有安装过的旧版本 先卸载 <code>yum remove docker  docker-common docker-selinux docker-engine</code><br><strong>因为我服务器中已安装了一套运行环境为避免冲突，相关应用会修改相应的端口</strong></p>\n</blockquote>\n<ul>\n<li><p>添加软件源:</p>\n<figure class=\"highlight bash\"><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\">yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 如果没有 yum-config-manager 命令则执行下面</span></div><div class=\"line\">yum install -y yum-utils device-mapper-persistent-data lvm2</div></pre></div></div></figure>\n</li>\n<li><p>查看软件仓库中所有的 <code>Docker</code> 版本</p>\n<figure class=\"highlight bash\"><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\">yum list docker-ce --showduplicates | sort -r</div></pre></div></div></figure>\n</li>\n<li><p>安装最新版本 [ 指定版本 ]</p>\n<figure class=\"highlight bash\"><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># [docker-ce] 替换指定版本</span></div><div class=\"line\">sudo yum install [docker-ce]</div></pre></div></div></figure>\n</li>\n<li><p>加入 <code>Docker</code> 到开机启动</p>\n<figure class=\"highlight bash\"><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\">systemctl <span class=\"built_in\">enable</span> docker</div></pre></div></div></figure>\n</li>\n<li><p>启动 <code>Docker</code> </p>\n<figure class=\"highlight bash\"><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\">systemctl start docker</div></pre></div></div></figure>\n</li>\n<li><p>查看 <code>Docker</code> 状态</p>\n<figure class=\"highlight bash\"><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\">systemctl status docker</div></pre></div></div></figure>\n</li>\n<li><p>安装 <code>docker-compose</code> <a href=\"http://dockone.io/article/34\" target=\"_blank\" rel=\"noopener\">docker-compose介绍</a></p>\n<figure class=\"highlight bash\"><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\">pip install docker-compose</div></pre></div></div></figure>\n</li>\n<li><p>加速 <code>Docker</code> </p>\n<figure class=\"highlight bash\"><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\">curl -sSL https://get.daocloud.io/daotools/set_mirror.sh | sh -s http://9d4cd35f.m.daocloud.io</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 修改完成后会提示重启</span></div><div class=\"line\">systemctl restart docker</div></pre></div></div></figure>\n</li>\n</ul>\n<h1 id=\"在-Docker-上构建-LNMP-环境\"><a href=\"#在-Docker-上构建-LNMP-环境\" class=\"headerlink\" title=\"在 Docker 上构建 LNMP 环境\"></a>在 <code>Docker</code> 上构建 <code>LNMP</code> 环境</h1><h2 id=\"分别拉取需要的镜像文件\"><a href=\"#分别拉取需要的镜像文件\" class=\"headerlink\" title=\"分别拉取需要的镜像文件\"></a>分别拉取需要的镜像文件</h2><h3 id=\"MySQL\"><a href=\"#MySQL\" class=\"headerlink\" title=\"MySQL\"></a>MySQL</h3><figure class=\"highlight bash\"><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># 获取 mysql5.6 版本的docker镜像</span></div><div class=\"line\">docker pull mysql:5.6</div><div class=\"line\"><span class=\"comment\"># 创建mysql容器</span></div><div class=\"line\">docker run -d -p 3307:3306 -e MYSQL_ROOT_PASSWORD=admin --name mysql5.6 mysql:5.6</div><div class=\"line\"><span class=\"comment\"># -d：让容器在后台运行</span></div><div class=\"line\"><span class=\"comment\"># -p：添加主机到容器的端口映射</span></div><div class=\"line\"><span class=\"comment\"># -e：设置环境变量，这里是设置MySQL的root账户的初始密码 （必选）</span></div><div class=\"line\"><span class=\"comment\"># -name：容器的名字，必须唯一</span></div></pre></div></div></figure>\n<h3 id=\"PHP-FPM\"><a href=\"#PHP-FPM\" class=\"headerlink\" title=\"PHP-FPM\"></a>PHP-FPM</h3><figure class=\"highlight bash\"><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># 拉取php-fpm </span></div><div class=\"line\">docker pull php:7.1-fpm</div><div class=\"line\"><span class=\"comment\"># 创建 php-fpm 容器</span></div><div class=\"line\">docker run -d -v /www:/var/www/html -p 9001:9000 --link mysql5.6:mysql --name phpfpm7.1 php:7.1-fpm </div><div class=\"line\"><span class=\"comment\"># -v 目录映射，把主机的 /www 目录映射到容器中的 /var/www/html 目录</span></div><div class=\"line\"><span class=\"comment\"># –link 与另外一个容器建立起联系，这样我们就可以在当前容器中去使用另一个容器里的服务。</span></div><div class=\"line\"><span class=\"comment\">#      或者使用 ip 去访问其它容器的服务</span></div></pre></div></div></figure>\n<blockquote>\n<p><strong>在PHP-FPM容器中</strong>  安装PHP扩展使用命令 <code>docker-php-ext-install pdo_mysql</code></p>\n</blockquote>\n<h3 id=\"Nginx\"><a href=\"#Nginx\" class=\"headerlink\" title=\"Nginx\"></a>Nginx</h3><figure class=\"highlight bash\"><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></div><div class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># 拉取 Nginx 镜像</span></div><div class=\"line\">docker pull nginx:1.14.0</div><div class=\"line\"><span class=\"comment\"># 创建 Nginx 容器</span></div><div class=\"line\">docker run -d -p 81:80 -v /www:/var/www/html --link phpfpm7.1:phpfpm --name nginx nginx:1.14.0</div></pre></div></div></figure>\n<blockquote>\n<p><strong>在Nginx容器中</strong> 修改nginx配置文件<br><figure class=\"highlight bash\"><figcaption><span class=\"fileDir\">/etc/nginx/conf.d/</span><span class=\"caption\">default</span><span class=\"suffix\">.conf</span></figcaption><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\">location ~ \\.php$ &#123;</div><div class=\"line\">    root           /var/www/html;</div><div class=\"line\">    fastcgi_index  index.php;</div><div class=\"line\">    fastcgi_pass   phpfpm:9001;</div><div class=\"line\">    fastcgi_param  SCRIPT_FILENAME <span class=\"variable\">$document_root</span><span class=\"variable\">$fastcdi_script_name</span>;</div><div class=\"line\">    include        fastcgi_params;</div><div class=\"line\">&#125;</div></pre></div></div></figure></p>\n</blockquote>\n<h3 id=\"测试\"><a href=\"#测试\" class=\"headerlink\" title=\"测试\"></a>测试</h3><p><img src=\"http://oyvpp7gqd.bkt.clouddn.com/18-7-2/11032690.jpg\" alt=\"info\"></p>\n<h2 id=\"使用-DockerFile-构建环境\"><a href=\"#使用-DockerFile-构建环境\" class=\"headerlink\" title=\"使用 DockerFile 构建环境\"></a>使用 <code>DockerFile</code> 构建环境</h2><blockquote>\n<p>推荐阅读：<a href=\"http://www.phpchina.com/portal.php?mod=view&amp;aid=41111\" target=\"_blank\" rel=\"noopener\">如何编写最佳的Dockerfile</a></p>\n</blockquote>\n<h3 id=\"介绍\"><a href=\"#介绍\" class=\"headerlink\" title=\"介绍\"></a>介绍</h3><p><code>DockerFile</code> 是 <code>Docker</code> 用来构建镜像的一个文件，包含自定义的指令，类似于shell脚本，把一系列的指令集和放在一个 .sh 文件中去执行<br><strong>DockerFile</strong>分为四部分组成：<strong>基础镜像信</strong>、<strong>维护者信息</strong>、<strong>镜像操作指令</strong> 和 <strong>容器启动时执行指令</strong>。例如：<br><figure class=\"highlight bash\"><figcaption><span class=\"caption\">dockerfile</span><a href=\"https://blog.csdn.net/mozf881/article/details/55798811\" target=\"_blank\">相关链接</a></figcaption><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># 第一行必须指令基于的基础镜像</span></div><div class=\"line\">From ubutu</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 维护者信息</span></div><div class=\"line\">MAINTAINER docker_user  docker_user@mail.com</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 镜像的操作指令</span></div><div class=\"line\">apt/sourcelist.list</div><div class=\"line\"></div><div class=\"line\">RUN apt-get update &amp;&amp; apt-get install -y ngnix </div><div class=\"line\">RUN <span class=\"built_in\">echo</span> <span class=\"string\">\"\\ndaemon off;\"</span>&gt;&gt;/etc/ngnix/nignix.conf</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 容器启动时执行指令</span></div><div class=\"line\">CMD /usr/sbin/ngnix</div></pre></div></div></figure></p>\n<p><img src=\"http://oyvpp7gqd.bkt.clouddn.com/18-7-2/8082419.jpg\" alt=\"dockerfile\"></p>\n<h1 id=\"Docker-相关命令\"><a href=\"#Docker-相关命令\" class=\"headerlink\" title=\"Docker 相关命令\"></a>Docker 相关命令</h1><ol>\n<li><code>docker images</code>  查看本地<strong>docker</strong>镜像文件</li>\n<li><code>docker ps -a</code>   查看所有容器的进程情况</li>\n<li><code>docker exec -ti docker_names /bin/bash</code> 进入docker容器中<blockquote>\n<p>-t 在容器里生产一个伪终端<br>-i 对容器内的标准输入 (STDIN) 进行交互</p>\n</blockquote>\n</li>\n<li><code>docker stop name</code>  停止一个运行中的容器<br><code>docker rm name</code>    删除本地一个容器 （需要该容器处于未运行状态）<br><code>docker rmi image</code>  删除本地一个镜像文件</li>\n</ol>\n","site":{"data":{}},"excerpt":"<blockquote>\n<p>前段时间有学过一些 <code>Docker</code> 的相关知识，但最近忙于工作，对这方面还是有些疏忽了，就再次学习下，然后做个笔记</p>\n</blockquote>","more":"<hr>\n<p><em>系统环境 <code>CenterOS 7</code></em></p>\n<h1 id=\"安装-Docker\"><a href=\"#安装-Docker\" class=\"headerlink\" title=\"安装 Docker\"></a>安装 Docker</h1><blockquote>\n<p>版本：社区版（Docker Community Edition）<br>介绍：<a href=\"https://avnpc.com/pages/build-php-develop-env-by-docker\" target=\"_blank\" rel=\"noopener\">Docker在PHP项目开发中的应用</a><br>相关资料：<a href=\"https://yeasy.gitbooks.io/docker_practice/content/\" target=\"_blank\" rel=\"noopener\">Docker-从入门到实践</a><br>如果之前有安装过的旧版本 先卸载 <code>yum remove docker  docker-common docker-selinux docker-engine</code><br><strong>因为我服务器中已安装了一套运行环境为避免冲突，相关应用会修改相应的端口</strong></p>\n</blockquote>\n<ul>\n<li><p>添加软件源:</p>\n<figure class=\"highlight bash\"><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\">yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 如果没有 yum-config-manager 命令则执行下面</span></div><div class=\"line\">yum install -y yum-utils device-mapper-persistent-data lvm2</div></pre></div></div></figure>\n</li>\n<li><p>查看软件仓库中所有的 <code>Docker</code> 版本</p>\n<figure class=\"highlight bash\"><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\">yum list docker-ce --showduplicates | sort -r</div></pre></div></div></figure>\n</li>\n<li><p>安装最新版本 [ 指定版本 ]</p>\n<figure class=\"highlight bash\"><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># [docker-ce] 替换指定版本</span></div><div class=\"line\">sudo yum install [docker-ce]</div></pre></div></div></figure>\n</li>\n<li><p>加入 <code>Docker</code> 到开机启动</p>\n<figure class=\"highlight bash\"><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\">systemctl <span class=\"built_in\">enable</span> docker</div></pre></div></div></figure>\n</li>\n<li><p>启动 <code>Docker</code> </p>\n<figure class=\"highlight bash\"><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\">systemctl start docker</div></pre></div></div></figure>\n</li>\n<li><p>查看 <code>Docker</code> 状态</p>\n<figure class=\"highlight bash\"><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\">systemctl status docker</div></pre></div></div></figure>\n</li>\n<li><p>安装 <code>docker-compose</code> <a href=\"http://dockone.io/article/34\" target=\"_blank\" rel=\"noopener\">docker-compose介绍</a></p>\n<figure class=\"highlight bash\"><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\">pip install docker-compose</div></pre></div></div></figure>\n</li>\n<li><p>加速 <code>Docker</code> </p>\n<figure class=\"highlight bash\"><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\">curl -sSL https://get.daocloud.io/daotools/set_mirror.sh | sh -s http://9d4cd35f.m.daocloud.io</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 修改完成后会提示重启</span></div><div class=\"line\">systemctl restart docker</div></pre></div></div></figure>\n</li>\n</ul>\n<h1 id=\"在-Docker-上构建-LNMP-环境\"><a href=\"#在-Docker-上构建-LNMP-环境\" class=\"headerlink\" title=\"在 Docker 上构建 LNMP 环境\"></a>在 <code>Docker</code> 上构建 <code>LNMP</code> 环境</h1><h2 id=\"分别拉取需要的镜像文件\"><a href=\"#分别拉取需要的镜像文件\" class=\"headerlink\" title=\"分别拉取需要的镜像文件\"></a>分别拉取需要的镜像文件</h2><h3 id=\"MySQL\"><a href=\"#MySQL\" class=\"headerlink\" title=\"MySQL\"></a>MySQL</h3><figure class=\"highlight bash\"><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># 获取 mysql5.6 版本的docker镜像</span></div><div class=\"line\">docker pull mysql:5.6</div><div class=\"line\"><span class=\"comment\"># 创建mysql容器</span></div><div class=\"line\">docker run -d -p 3307:3306 -e MYSQL_ROOT_PASSWORD=admin --name mysql5.6 mysql:5.6</div><div class=\"line\"><span class=\"comment\"># -d：让容器在后台运行</span></div><div class=\"line\"><span class=\"comment\"># -p：添加主机到容器的端口映射</span></div><div class=\"line\"><span class=\"comment\"># -e：设置环境变量，这里是设置MySQL的root账户的初始密码 （必选）</span></div><div class=\"line\"><span class=\"comment\"># -name：容器的名字，必须唯一</span></div></pre></div></div></figure>\n<h3 id=\"PHP-FPM\"><a href=\"#PHP-FPM\" class=\"headerlink\" title=\"PHP-FPM\"></a>PHP-FPM</h3><figure class=\"highlight bash\"><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># 拉取php-fpm </span></div><div class=\"line\">docker pull php:7.1-fpm</div><div class=\"line\"><span class=\"comment\"># 创建 php-fpm 容器</span></div><div class=\"line\">docker run -d -v /www:/var/www/html -p 9001:9000 --link mysql5.6:mysql --name phpfpm7.1 php:7.1-fpm </div><div class=\"line\"><span class=\"comment\"># -v 目录映射，把主机的 /www 目录映射到容器中的 /var/www/html 目录</span></div><div class=\"line\"><span class=\"comment\"># –link 与另外一个容器建立起联系，这样我们就可以在当前容器中去使用另一个容器里的服务。</span></div><div class=\"line\"><span class=\"comment\">#      或者使用 ip 去访问其它容器的服务</span></div></pre></div></div></figure>\n<blockquote>\n<p><strong>在PHP-FPM容器中</strong>  安装PHP扩展使用命令 <code>docker-php-ext-install pdo_mysql</code></p>\n</blockquote>\n<h3 id=\"Nginx\"><a href=\"#Nginx\" class=\"headerlink\" title=\"Nginx\"></a>Nginx</h3><figure class=\"highlight bash\"><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></div><div class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># 拉取 Nginx 镜像</span></div><div class=\"line\">docker pull nginx:1.14.0</div><div class=\"line\"><span class=\"comment\"># 创建 Nginx 容器</span></div><div class=\"line\">docker run -d -p 81:80 -v /www:/var/www/html --link phpfpm7.1:phpfpm --name nginx nginx:1.14.0</div></pre></div></div></figure>\n<blockquote>\n<p><strong>在Nginx容器中</strong> 修改nginx配置文件<br><figure class=\"highlight bash\"><figcaption><span class=\"fileDir\">/etc/nginx/conf.d/</span><span class=\"caption\">default</span><span class=\"suffix\">.conf</span></figcaption><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\">location ~ \\.php$ &#123;</div><div class=\"line\">    root           /var/www/html;</div><div class=\"line\">    fastcgi_index  index.php;</div><div class=\"line\">    fastcgi_pass   phpfpm:9001;</div><div class=\"line\">    fastcgi_param  SCRIPT_FILENAME <span class=\"variable\">$document_root</span><span class=\"variable\">$fastcdi_script_name</span>;</div><div class=\"line\">    include        fastcgi_params;</div><div class=\"line\">&#125;</div></pre></div></div></figure></p>\n</blockquote>\n<h3 id=\"测试\"><a href=\"#测试\" class=\"headerlink\" title=\"测试\"></a>测试</h3><p><img src=\"http://oyvpp7gqd.bkt.clouddn.com/18-7-2/11032690.jpg\" alt=\"info\"></p>\n<h2 id=\"使用-DockerFile-构建环境\"><a href=\"#使用-DockerFile-构建环境\" class=\"headerlink\" title=\"使用 DockerFile 构建环境\"></a>使用 <code>DockerFile</code> 构建环境</h2><blockquote>\n<p>推荐阅读：<a href=\"http://www.phpchina.com/portal.php?mod=view&amp;aid=41111\" target=\"_blank\" rel=\"noopener\">如何编写最佳的Dockerfile</a></p>\n</blockquote>\n<h3 id=\"介绍\"><a href=\"#介绍\" class=\"headerlink\" title=\"介绍\"></a>介绍</h3><p><code>DockerFile</code> 是 <code>Docker</code> 用来构建镜像的一个文件，包含自定义的指令，类似于shell脚本，把一系列的指令集和放在一个 .sh 文件中去执行<br><strong>DockerFile</strong>分为四部分组成：<strong>基础镜像信</strong>、<strong>维护者信息</strong>、<strong>镜像操作指令</strong> 和 <strong>容器启动时执行指令</strong>。例如：<br><figure class=\"highlight bash\"><figcaption><span class=\"caption\">dockerfile</span><a href=\"https://blog.csdn.net/mozf881/article/details/55798811\" target=\"_blank\">相关链接</a></figcaption><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># 第一行必须指令基于的基础镜像</span></div><div class=\"line\">From ubutu</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 维护者信息</span></div><div class=\"line\">MAINTAINER docker_user  docker_user@mail.com</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 镜像的操作指令</span></div><div class=\"line\">apt/sourcelist.list</div><div class=\"line\"></div><div class=\"line\">RUN apt-get update &amp;&amp; apt-get install -y ngnix </div><div class=\"line\">RUN <span class=\"built_in\">echo</span> <span class=\"string\">\"\\ndaemon off;\"</span>&gt;&gt;/etc/ngnix/nignix.conf</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 容器启动时执行指令</span></div><div class=\"line\">CMD /usr/sbin/ngnix</div></pre></div></div></figure></p>\n<p><img src=\"http://oyvpp7gqd.bkt.clouddn.com/18-7-2/8082419.jpg\" alt=\"dockerfile\"></p>\n<h1 id=\"Docker-相关命令\"><a href=\"#Docker-相关命令\" class=\"headerlink\" title=\"Docker 相关命令\"></a>Docker 相关命令</h1><ol>\n<li><code>docker images</code>  查看本地<strong>docker</strong>镜像文件</li>\n<li><code>docker ps -a</code>   查看所有容器的进程情况</li>\n<li><code>docker exec -ti docker_names /bin/bash</code> 进入docker容器中<blockquote>\n<p>-t 在容器里生产一个伪终端<br>-i 对容器内的标准输入 (STDIN) 进行交互</p>\n</blockquote>\n</li>\n<li><code>docker stop name</code>  停止一个运行中的容器<br><code>docker rm name</code>    删除本地一个容器 （需要该容器处于未运行状态）<br><code>docker rmi image</code>  删除本地一个镜像文件</li>\n</ol>"},{"title":"Hexo博客Next主题配置","date":"2018-06-05T06:16:25.000Z","photos":["http://oyvpp7gqd.bkt.clouddn.com/18-9-25/4256436.jpg"],"_content":"本文为`Hexo`博客的`Next`主题的一些常用配置项\n<!--more-->\n\n# 设置「阅读全文」\nNexT 提供三种方式来控制文章在首页的显示方式。 也就是说，在首页显示文章的摘录并显示 阅读全文 按钮，可以通过以下方法：\n1. 在文章中使用`<!-- more -->`手动进行截断，Hexo 提供的方式\n2. 在文章的 [front-matter](http://hexo.io/docs/front-matter.html) 中添加 description，并提供文章摘录\n3. 自动形成摘要，在主题配置文件中添加：\n```\nauto_excerpt:\n    enable: true\n    length: 200\n```\n------\n\n# 统计访问量\n> 注册并登录百度统计获取你的统计代码。\n\n编辑配置文件 `hexo\\themes\\next\\_config.yml`, 增加配置选项：\n``` :file:  hexo\\themes\\next\\_config.yml\nbaidu_tongji: true\n```\n新建文件 `hexo\\themes\\next\\layout\\_partial\\baidu_tongji.swig`，内容如下：\n```\n<% if (theme.baidu_tongji){ %>\n<script type=\"text/javascript\">\n    #你的百度统计代码\n</script>\n<% } %>\n```\n编辑文件 `hexo\\themes\\next\\layout\\_partial\\head.swig`，在『/head』之前增加：\n```\n<%- partial('baidu_tongji') %>\n```\n-----\n\n# 网站图标\n在文件 `hexo\\themes\\next\\layout\\_partial\\head.swig` 中，![图标](http://oyvpp7gqd.bkt.clouddn.com/18-6-5/24288758.jpg)可以看到，网站图标文件是在 *hexo\\themes\\next\\source\\images* 这个路径下，替换即可\n\n-----\n\n# 为文章添加密码\n定位到文件 `hexo\\themes\\next\\layout\\_partial\\head.swig` 中，添加下面的代码到文件最后面\n```javascript\n    (function(){\n        if('{{ page.password }}'){\n            if (prompt('请输入文章密码') !== '{{ page.password }}'){\n                alert('密码错误！');\n                history.back();\n            }\n        }\n    })();\n```\n然后在编辑文章时添加 password: password即可\n![password](http://oyvpp7gqd.bkt.clouddn.com/18-6-6/45085843.jpg)\n\n-----\n\n","source":"_posts/Hexo博客Next主题配置.md","raw":"---\ntitle: Hexo博客Next主题配置\ndate: 2018-06-05 14:16:25\ntags: [记录]\ncategories: 记录\nphotos: http://oyvpp7gqd.bkt.clouddn.com/18-9-25/4256436.jpg\n---\n本文为`Hexo`博客的`Next`主题的一些常用配置项\n<!--more-->\n\n# 设置「阅读全文」\nNexT 提供三种方式来控制文章在首页的显示方式。 也就是说，在首页显示文章的摘录并显示 阅读全文 按钮，可以通过以下方法：\n1. 在文章中使用`<!-- more -->`手动进行截断，Hexo 提供的方式\n2. 在文章的 [front-matter](http://hexo.io/docs/front-matter.html) 中添加 description，并提供文章摘录\n3. 自动形成摘要，在主题配置文件中添加：\n```\nauto_excerpt:\n    enable: true\n    length: 200\n```\n------\n\n# 统计访问量\n> 注册并登录百度统计获取你的统计代码。\n\n编辑配置文件 `hexo\\themes\\next\\_config.yml`, 增加配置选项：\n``` :file:  hexo\\themes\\next\\_config.yml\nbaidu_tongji: true\n```\n新建文件 `hexo\\themes\\next\\layout\\_partial\\baidu_tongji.swig`，内容如下：\n```\n<% if (theme.baidu_tongji){ %>\n<script type=\"text/javascript\">\n    #你的百度统计代码\n</script>\n<% } %>\n```\n编辑文件 `hexo\\themes\\next\\layout\\_partial\\head.swig`，在『/head』之前增加：\n```\n<%- partial('baidu_tongji') %>\n```\n-----\n\n# 网站图标\n在文件 `hexo\\themes\\next\\layout\\_partial\\head.swig` 中，![图标](http://oyvpp7gqd.bkt.clouddn.com/18-6-5/24288758.jpg)可以看到，网站图标文件是在 *hexo\\themes\\next\\source\\images* 这个路径下，替换即可\n\n-----\n\n# 为文章添加密码\n定位到文件 `hexo\\themes\\next\\layout\\_partial\\head.swig` 中，添加下面的代码到文件最后面\n```javascript\n    (function(){\n        if('{{ page.password }}'){\n            if (prompt('请输入文章密码') !== '{{ page.password }}'){\n                alert('密码错误！');\n                history.back();\n            }\n        }\n    })();\n```\n然后在编辑文章时添加 password: password即可\n![password](http://oyvpp7gqd.bkt.clouddn.com/18-6-6/45085843.jpg)\n\n-----\n\n","slug":"Hexo博客Next主题配置","published":1,"updated":"2018-11-08T04:19:01.030Z","comments":1,"layout":"post","link":"","_id":"cjopirm6a00082cwmxeu6adyd","content":"<p>本文为<code>Hexo</code>博客的<code>Next</code>主题的一些常用配置项<br><a id=\"more\"></a></p>\n<h1 id=\"设置「阅读全文」\"><a href=\"#设置「阅读全文」\" class=\"headerlink\" title=\"设置「阅读全文」\"></a>设置「阅读全文」</h1><p>NexT 提供三种方式来控制文章在首页的显示方式。 也就是说，在首页显示文章的摘录并显示 阅读全文 按钮，可以通过以下方法：</p>\n<ol>\n<li>在文章中使用<code>&lt;!-- more --&gt;</code>手动进行截断，Hexo 提供的方式</li>\n<li>在文章的 <a href=\"http://hexo.io/docs/front-matter.html\" target=\"_blank\" rel=\"noopener\">front-matter</a> 中添加 description，并提供文章摘录</li>\n<li>自动形成摘要，在主题配置文件中添加：<figure class=\"highlight plain\"><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></div><div class=\"code\"><pre><div class=\"line\">auto_excerpt:</div><div class=\"line\">    enable: true</div><div class=\"line\">    length: 200</div></pre></div></div></figure>\n</li>\n</ol>\n<hr>\n<h1 id=\"统计访问量\"><a href=\"#统计访问量\" class=\"headerlink\" title=\"统计访问量\"></a>统计访问量</h1><blockquote>\n<p>注册并登录百度统计获取你的统计代码。</p>\n</blockquote>\n<p>编辑配置文件 <code>hexo\\themes\\next\\_config.yml</code>, 增加配置选项：<br><figure class=\"highlight plain\"><figcaption><span class=\"fileDir\">file:  hexo\\themes\\next\\</span><span class=\"caption\">_config</span><span class=\"suffix\">.yml</span></figcaption><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div></pre></div><div class=\"code\"><pre><div class=\"line\">baidu_tongji: true</div></pre></div></div></figure></p>\n<p>新建文件 <code>hexo\\themes\\next\\layout\\_partial\\baidu_tongji.swig</code>，内容如下：<br><figure class=\"highlight plain\"><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></div><div class=\"code\"><pre><div class=\"line\">&lt;% if (theme.baidu_tongji)&#123; %&gt;</div><div class=\"line\">&lt;script type=&quot;text/javascript&quot;&gt;</div><div class=\"line\">    #你的百度统计代码</div><div class=\"line\">&lt;/script&gt;</div><div class=\"line\">&lt;% &#125; %&gt;</div></pre></div></div></figure></p>\n<p>编辑文件 <code>hexo\\themes\\next\\layout\\_partial\\head.swig</code>，在『/head』之前增加：<br><figure class=\"highlight plain\"><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div></pre></div><div class=\"code\"><pre><div class=\"line\">&lt;%- partial(&apos;baidu_tongji&apos;) %&gt;</div></pre></div></div></figure></p>\n<hr>\n<h1 id=\"网站图标\"><a href=\"#网站图标\" class=\"headerlink\" title=\"网站图标\"></a>网站图标</h1><p>在文件 <code>hexo\\themes\\next\\layout\\_partial\\head.swig</code> 中，<img src=\"http://oyvpp7gqd.bkt.clouddn.com/18-6-5/24288758.jpg\" alt=\"图标\">可以看到，网站图标文件是在 <em>hexo\\themes\\next\\source\\images</em> 这个路径下，替换即可</p>\n<hr>\n<h1 id=\"为文章添加密码\"><a href=\"#为文章添加密码\" class=\"headerlink\" title=\"为文章添加密码\"></a>为文章添加密码</h1><p>定位到文件 <code>hexo\\themes\\next\\layout\\_partial\\head.swig</code> 中，添加下面的代码到文件最后面<br><figure class=\"highlight javascript\"><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></div><div class=\"code\"><pre><div class=\"line\">(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"string\">'&#123;&#123; page.password &#125;&#125;'</span>)&#123;</div><div class=\"line\">        <span class=\"keyword\">if</span> (prompt(<span class=\"string\">'请输入文章密码'</span>) !== <span class=\"string\">'&#123;&#123; page.password &#125;&#125;'</span>)&#123;</div><div class=\"line\">            alert(<span class=\"string\">'密码错误！'</span>);</div><div class=\"line\">            history.back();</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;)();</div></pre></div></div></figure></p>\n<p>然后在编辑文章时添加 password: password即可<br><img src=\"http://oyvpp7gqd.bkt.clouddn.com/18-6-6/45085843.jpg\" alt=\"password\"></p>\n<hr>\n","site":{"data":{}},"excerpt":"<p>本文为<code>Hexo</code>博客的<code>Next</code>主题的一些常用配置项<br>","more":"</p>\n<h1 id=\"设置「阅读全文」\"><a href=\"#设置「阅读全文」\" class=\"headerlink\" title=\"设置「阅读全文」\"></a>设置「阅读全文」</h1><p>NexT 提供三种方式来控制文章在首页的显示方式。 也就是说，在首页显示文章的摘录并显示 阅读全文 按钮，可以通过以下方法：</p>\n<ol>\n<li>在文章中使用<code>&lt;!-- more --&gt;</code>手动进行截断，Hexo 提供的方式</li>\n<li>在文章的 <a href=\"http://hexo.io/docs/front-matter.html\" target=\"_blank\" rel=\"noopener\">front-matter</a> 中添加 description，并提供文章摘录</li>\n<li>自动形成摘要，在主题配置文件中添加：<figure class=\"highlight plain\"><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></div><div class=\"code\"><pre><div class=\"line\">auto_excerpt:</div><div class=\"line\">    enable: true</div><div class=\"line\">    length: 200</div></pre></div></div></figure>\n</li>\n</ol>\n<hr>\n<h1 id=\"统计访问量\"><a href=\"#统计访问量\" class=\"headerlink\" title=\"统计访问量\"></a>统计访问量</h1><blockquote>\n<p>注册并登录百度统计获取你的统计代码。</p>\n</blockquote>\n<p>编辑配置文件 <code>hexo\\themes\\next\\_config.yml</code>, 增加配置选项：<br><figure class=\"highlight plain\"><figcaption><span class=\"fileDir\">file:  hexo\\themes\\next\\</span><span class=\"caption\">_config</span><span class=\"suffix\">.yml</span></figcaption><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div></pre></div><div class=\"code\"><pre><div class=\"line\">baidu_tongji: true</div></pre></div></div></figure></p>\n<p>新建文件 <code>hexo\\themes\\next\\layout\\_partial\\baidu_tongji.swig</code>，内容如下：<br><figure class=\"highlight plain\"><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></div><div class=\"code\"><pre><div class=\"line\">&lt;% if (theme.baidu_tongji)&#123; %&gt;</div><div class=\"line\">&lt;script type=&quot;text/javascript&quot;&gt;</div><div class=\"line\">    #你的百度统计代码</div><div class=\"line\">&lt;/script&gt;</div><div class=\"line\">&lt;% &#125; %&gt;</div></pre></div></div></figure></p>\n<p>编辑文件 <code>hexo\\themes\\next\\layout\\_partial\\head.swig</code>，在『/head』之前增加：<br><figure class=\"highlight plain\"><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div></pre></div><div class=\"code\"><pre><div class=\"line\">&lt;%- partial(&apos;baidu_tongji&apos;) %&gt;</div></pre></div></div></figure></p>\n<hr>\n<h1 id=\"网站图标\"><a href=\"#网站图标\" class=\"headerlink\" title=\"网站图标\"></a>网站图标</h1><p>在文件 <code>hexo\\themes\\next\\layout\\_partial\\head.swig</code> 中，<img src=\"http://oyvpp7gqd.bkt.clouddn.com/18-6-5/24288758.jpg\" alt=\"图标\">可以看到，网站图标文件是在 <em>hexo\\themes\\next\\source\\images</em> 这个路径下，替换即可</p>\n<hr>\n<h1 id=\"为文章添加密码\"><a href=\"#为文章添加密码\" class=\"headerlink\" title=\"为文章添加密码\"></a>为文章添加密码</h1><p>定位到文件 <code>hexo\\themes\\next\\layout\\_partial\\head.swig</code> 中，添加下面的代码到文件最后面<br><figure class=\"highlight javascript\"><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></div><div class=\"code\"><pre><div class=\"line\">(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"string\">'&#123;&#123; page.password &#125;&#125;'</span>)&#123;</div><div class=\"line\">        <span class=\"keyword\">if</span> (prompt(<span class=\"string\">'请输入文章密码'</span>) !== <span class=\"string\">'&#123;&#123; page.password &#125;&#125;'</span>)&#123;</div><div class=\"line\">            alert(<span class=\"string\">'密码错误！'</span>);</div><div class=\"line\">            history.back();</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;)();</div></pre></div></div></figure></p>\n<p>然后在编辑文章时添加 password: password即可<br><img src=\"http://oyvpp7gqd.bkt.clouddn.com/18-6-6/45085843.jpg\" alt=\"password\"></p>\n<hr>"},{"title":"Linux命令学习","date":"2018-06-27T06:54:32.000Z","_content":"\n本文主要记录在学习或者工作中用到的一些 **Linux** 命令\n\n<!--more-->\n\n# 常用命令\n\n## ls 命令详细\n- 按文件大小列出： `ls -s`\n- 按时间和日期排序： `ls -t`\n- 按扩展名排序： `ls -X`\n- 按文件大小排序：`ls -S`\n\n## find 文件查找 \n\n```bash :Find 命令 line_number:false url:https://linux.cn/article-9648-1.html 相关链接\n    # 查找最后修改的时间为7天前的，jpg 或 jpeg 格式的图片 【注意括号后面需要添加一个空格】\n    find ./ \\( -iname '*.jpeg' -o -iname '*.jpg' \\) -type f -mtime + 7 \n```\n\n----\n\n# 文本处理命令 awk & sed\n## awk\n> awk 是一个行文本处理工具，逐行处理文件中的数据\n\n### 使用方式\n`awk 'pattern + {action}'`\n> `{action}` 是一个命令分组，`action` 是处理命令 \n> `pattern` 是一个过滤器，表示经过过滤后的内容经过 `action` 处理，两者必须存在其一，可以同时存在\n> `pattern` 参数可以是正则表达式\n> 示例： `cat 11-08.log | awk '/hello/'`  # 输出 11-08.log 文件中包含 hello 的行\n>       `cat 11-08.log | awk '/hello/ {print NR}'  # 输出 11-08.log 文件中包含 hello 的行号\n\n### awk 内置变量 和 函数\n#### 变量\n- NR 当前行号\n- FS 分隔符，默认是空格\n- NF 当前记录的字段个数\n- $0 当前记录\n- $1~$n 当前记录的第 n 个字段 \n> 例如： `cat 11-08.log | awk 'NR==2,NR==4 {print $NF}' `  # 显示 11-08.log 文件中的第2行到第4行的最后一列\n\n#### 函数\n- gsub(r,s)：在 **$0** 中用 **s** 代替 **r**\n- index(s,t)：返回 **s** 中 **t** 的第一个位置\n- length(s)： **s** 的长度\n- match(s,r)： **s** 是否匹配 **r**\n- split(s,a,fs)：在 **fs** 上将 **s** 切割成序列 **a**\n- substr(s,p)：返回 **s** 从 **p** 开始的子串\n\n### 流程控制语句\n1. `BEGIN {} END {}`\n2. `if(coondotion){}else{}`\n3. `while(condition){}`\n4. `do()while(condition)`\n5. `for(init;condition;step){}`\n6. `break/continue`\n\n\n## sed\n> sed是一种行文本处理工具，它一次处理一行内容\n\n### 使用方式\n\n`sed [options] 'command' file(s) `\n>   示例： 输出某个文本里面全部的内容： \n    `sed -n p 11-07.log` # 输出 11-07.log 文件的日志\n        -n：sed会在处理一行文本前，将待处理的文本打印出来，-n参数关闭了这个功能\n        p：命令表示打印当前行\n    若要输出某几行显示 则可以在 P 前面加上行数 并以 , 分割 格式为 sed -n '第几行,截止到第几行'p file(s)\n    sed -n '1,2'p 11-07.log  # 输出 11-07.log 文件中第一行到第二行的内容\n    如果要输出第几行到最后的内容可以使用 $ \n    sed -n '5,$'p 11-07.log  # 输出 11-07.log 文件中第五行开始一直到最后的所有内容 \n\n### 相关命令\n#### 将匹配行删除\n`sed '/hello/'d 11-07.log` 该命令会输出 11-07.log 文件中的内容，同时把匹配到 hello 的行会删除 （该命令只会影响输出后的显示内容，对源文件不做修改）\n\n#### 将匹配行替换\n命令格式： `s/pattern-to-find/replacement-pattern/g`\n        **pattern-to-find**：被替换的串\n        **replacement-pattern**：替换成这个串\n        **g**：全部替换，如果不加 **g** 默认只替换匹配到的第一个\n`sed 's/php/python/g' 11-07.log` 该命令会输出 11-07.log 文件中的内容，同时把文件中出现的 `php` 全部替换为 `python`\n\n## 实例： 查找某个时间段内服务器的访问IP\n*在此感谢某位大佬* [@大佬](https://gitee.com/alwaysthanksFel)\n\n```bash line_number:false\n    sed -n '/2018:06:25:59/,/2018:09:50/p' access.log | awk '{print $1}' | sort -nrk1 | uniq -c | tee\n```\n> uniq -c       统计去重的行数\n  sort -nrk1    k : 第几列 n：以数字模式排序 r：倒序排序\n  sed '/^$/d'   删除空行\n  \n----\n\n# OpenSSL 生成秘钥文件\n>输入`openssl`进入openssl交互界面 \n\n1. 生成私钥：       \n```bash line_number:false\n    genrsa -out rsa_private_key.pem 1024\n```\n2. 转换成pckcs8格式：\n```bash line_number:false\n    pkcs8 -topk8 -nocrypt -inform PEM -in rsa_private_key.pem -outform PEM outform\n```\n3. 根据私钥生成公钥： \n```bash line_number:false\n    rsa -in rsa_private_key.pem -pubout -out rsa_public_key.pem\n```\n\n----\n  \n# 其他命令\n- `grep -C 5 foo file` 显示file文件里匹配foo字串那行以及上下5行\n- `cut -d ',' -f 1`   d：以逗号切割  f：每行切割的第几份\n- `ps -eo %mem,%cpu,comm --sort=-%mem | head -n 6` 查看使用内存最多的五个进程\n\n## 文件批量重命名\n```bash line_number:false\n    # 使用 for 循环\n    for fn in *.jpg; do convert \"$fn\" `echo $fn | sed 's/jpg$/png/'`; done\n    \n    # 使用 xargs \n    ls *.jpg | xargs -I{} convert \"{}\" `echo {} | sed 's/jpg$/png/'`\n```\n\n\n\n","source":"_posts/Linux命令学习.md","raw":"---\ntitle: Linux命令学习\ndate: 2018-06-27 14:54:32\ntags: [Linux, 记录, 命令]\ncategories: Linux\n---\n\n本文主要记录在学习或者工作中用到的一些 **Linux** 命令\n\n<!--more-->\n\n# 常用命令\n\n## ls 命令详细\n- 按文件大小列出： `ls -s`\n- 按时间和日期排序： `ls -t`\n- 按扩展名排序： `ls -X`\n- 按文件大小排序：`ls -S`\n\n## find 文件查找 \n\n```bash :Find 命令 line_number:false url:https://linux.cn/article-9648-1.html 相关链接\n    # 查找最后修改的时间为7天前的，jpg 或 jpeg 格式的图片 【注意括号后面需要添加一个空格】\n    find ./ \\( -iname '*.jpeg' -o -iname '*.jpg' \\) -type f -mtime + 7 \n```\n\n----\n\n# 文本处理命令 awk & sed\n## awk\n> awk 是一个行文本处理工具，逐行处理文件中的数据\n\n### 使用方式\n`awk 'pattern + {action}'`\n> `{action}` 是一个命令分组，`action` 是处理命令 \n> `pattern` 是一个过滤器，表示经过过滤后的内容经过 `action` 处理，两者必须存在其一，可以同时存在\n> `pattern` 参数可以是正则表达式\n> 示例： `cat 11-08.log | awk '/hello/'`  # 输出 11-08.log 文件中包含 hello 的行\n>       `cat 11-08.log | awk '/hello/ {print NR}'  # 输出 11-08.log 文件中包含 hello 的行号\n\n### awk 内置变量 和 函数\n#### 变量\n- NR 当前行号\n- FS 分隔符，默认是空格\n- NF 当前记录的字段个数\n- $0 当前记录\n- $1~$n 当前记录的第 n 个字段 \n> 例如： `cat 11-08.log | awk 'NR==2,NR==4 {print $NF}' `  # 显示 11-08.log 文件中的第2行到第4行的最后一列\n\n#### 函数\n- gsub(r,s)：在 **$0** 中用 **s** 代替 **r**\n- index(s,t)：返回 **s** 中 **t** 的第一个位置\n- length(s)： **s** 的长度\n- match(s,r)： **s** 是否匹配 **r**\n- split(s,a,fs)：在 **fs** 上将 **s** 切割成序列 **a**\n- substr(s,p)：返回 **s** 从 **p** 开始的子串\n\n### 流程控制语句\n1. `BEGIN {} END {}`\n2. `if(coondotion){}else{}`\n3. `while(condition){}`\n4. `do()while(condition)`\n5. `for(init;condition;step){}`\n6. `break/continue`\n\n\n## sed\n> sed是一种行文本处理工具，它一次处理一行内容\n\n### 使用方式\n\n`sed [options] 'command' file(s) `\n>   示例： 输出某个文本里面全部的内容： \n    `sed -n p 11-07.log` # 输出 11-07.log 文件的日志\n        -n：sed会在处理一行文本前，将待处理的文本打印出来，-n参数关闭了这个功能\n        p：命令表示打印当前行\n    若要输出某几行显示 则可以在 P 前面加上行数 并以 , 分割 格式为 sed -n '第几行,截止到第几行'p file(s)\n    sed -n '1,2'p 11-07.log  # 输出 11-07.log 文件中第一行到第二行的内容\n    如果要输出第几行到最后的内容可以使用 $ \n    sed -n '5,$'p 11-07.log  # 输出 11-07.log 文件中第五行开始一直到最后的所有内容 \n\n### 相关命令\n#### 将匹配行删除\n`sed '/hello/'d 11-07.log` 该命令会输出 11-07.log 文件中的内容，同时把匹配到 hello 的行会删除 （该命令只会影响输出后的显示内容，对源文件不做修改）\n\n#### 将匹配行替换\n命令格式： `s/pattern-to-find/replacement-pattern/g`\n        **pattern-to-find**：被替换的串\n        **replacement-pattern**：替换成这个串\n        **g**：全部替换，如果不加 **g** 默认只替换匹配到的第一个\n`sed 's/php/python/g' 11-07.log` 该命令会输出 11-07.log 文件中的内容，同时把文件中出现的 `php` 全部替换为 `python`\n\n## 实例： 查找某个时间段内服务器的访问IP\n*在此感谢某位大佬* [@大佬](https://gitee.com/alwaysthanksFel)\n\n```bash line_number:false\n    sed -n '/2018:06:25:59/,/2018:09:50/p' access.log | awk '{print $1}' | sort -nrk1 | uniq -c | tee\n```\n> uniq -c       统计去重的行数\n  sort -nrk1    k : 第几列 n：以数字模式排序 r：倒序排序\n  sed '/^$/d'   删除空行\n  \n----\n\n# OpenSSL 生成秘钥文件\n>输入`openssl`进入openssl交互界面 \n\n1. 生成私钥：       \n```bash line_number:false\n    genrsa -out rsa_private_key.pem 1024\n```\n2. 转换成pckcs8格式：\n```bash line_number:false\n    pkcs8 -topk8 -nocrypt -inform PEM -in rsa_private_key.pem -outform PEM outform\n```\n3. 根据私钥生成公钥： \n```bash line_number:false\n    rsa -in rsa_private_key.pem -pubout -out rsa_public_key.pem\n```\n\n----\n  \n# 其他命令\n- `grep -C 5 foo file` 显示file文件里匹配foo字串那行以及上下5行\n- `cut -d ',' -f 1`   d：以逗号切割  f：每行切割的第几份\n- `ps -eo %mem,%cpu,comm --sort=-%mem | head -n 6` 查看使用内存最多的五个进程\n\n## 文件批量重命名\n```bash line_number:false\n    # 使用 for 循环\n    for fn in *.jpg; do convert \"$fn\" `echo $fn | sed 's/jpg$/png/'`; done\n    \n    # 使用 xargs \n    ls *.jpg | xargs -I{} convert \"{}\" `echo {} | sed 's/jpg$/png/'`\n```\n\n\n\n","slug":"Linux命令学习","published":1,"updated":"2018-11-08T05:38:52.536Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjopirm6d00092cwm379d78tr","content":"<p>本文主要记录在学习或者工作中用到的一些 <strong>Linux</strong> 命令</p>\n<a id=\"more\"></a>\n<h1 id=\"常用命令\"><a href=\"#常用命令\" class=\"headerlink\" title=\"常用命令\"></a>常用命令</h1><h2 id=\"ls-命令详细\"><a href=\"#ls-命令详细\" class=\"headerlink\" title=\"ls 命令详细\"></a>ls 命令详细</h2><ul>\n<li>按文件大小列出： <code>ls -s</code></li>\n<li>按时间和日期排序： <code>ls -t</code></li>\n<li>按扩展名排序： <code>ls -X</code></li>\n<li>按文件大小排序：<code>ls -S</code></li>\n</ul>\n<h2 id=\"find-文件查找\"><a href=\"#find-文件查找\" class=\"headerlink\" title=\"find 文件查找\"></a>find 文件查找</h2><figure class=\"highlight bash\"><figcaption><span class=\"caption\">Find 命令</span><a href=\"https://linux.cn/article-9648-1.html\" target=\"_blank\">相关链接</a></figcaption><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># 查找最后修改的时间为7天前的，jpg 或 jpeg 格式的图片 【注意括号后面需要添加一个空格】</span></div><div class=\"line\">find ./ \\( -iname <span class=\"string\">'*.jpeg'</span> -o -iname <span class=\"string\">'*.jpg'</span> \\) -<span class=\"built_in\">type</span> f -mtime + 7</div></pre></div></div></figure>\n<hr>\n<h1 id=\"文本处理命令-awk-amp-sed\"><a href=\"#文本处理命令-awk-amp-sed\" class=\"headerlink\" title=\"文本处理命令 awk &amp; sed\"></a>文本处理命令 awk &amp; sed</h1><h2 id=\"awk\"><a href=\"#awk\" class=\"headerlink\" title=\"awk\"></a>awk</h2><blockquote>\n<p>awk 是一个行文本处理工具，逐行处理文件中的数据</p>\n</blockquote>\n<h3 id=\"使用方式\"><a href=\"#使用方式\" class=\"headerlink\" title=\"使用方式\"></a>使用方式</h3><p><code>awk &#39;pattern + {action}&#39;</code></p>\n<blockquote>\n<p><code>{action}</code> 是一个命令分组，<code>action</code> 是处理命令<br><code>pattern</code> 是一个过滤器，表示经过过滤后的内容经过 <code>action</code> 处理，两者必须存在其一，可以同时存在<br><code>pattern</code> 参数可以是正则表达式<br>示例： <code>cat 11-08.log | awk &#39;/hello/&#39;</code>  # 输出 11-08.log 文件中包含 hello 的行<br>      `cat 11-08.log | awk ‘/hello/ {print NR}’  # 输出 11-08.log 文件中包含 hello 的行号</p>\n</blockquote>\n<h3 id=\"awk-内置变量-和-函数\"><a href=\"#awk-内置变量-和-函数\" class=\"headerlink\" title=\"awk 内置变量 和 函数\"></a>awk 内置变量 和 函数</h3><h4 id=\"变量\"><a href=\"#变量\" class=\"headerlink\" title=\"变量\"></a>变量</h4><ul>\n<li>NR 当前行号</li>\n<li>FS 分隔符，默认是空格</li>\n<li>NF 当前记录的字段个数</li>\n<li>$0 当前记录</li>\n<li>$1~$n 当前记录的第 n 个字段 <blockquote>\n<p>例如： <code>cat 11-08.log | awk &#39;NR==2,NR==4 {print $NF}&#39;</code>  # 显示 11-08.log 文件中的第2行到第4行的最后一列</p>\n</blockquote>\n</li>\n</ul>\n<h4 id=\"函数\"><a href=\"#函数\" class=\"headerlink\" title=\"函数\"></a>函数</h4><ul>\n<li>gsub(r,s)：在 <strong>$0</strong> 中用 <strong>s</strong> 代替 <strong>r</strong></li>\n<li>index(s,t)：返回 <strong>s</strong> 中 <strong>t</strong> 的第一个位置</li>\n<li>length(s)： <strong>s</strong> 的长度</li>\n<li>match(s,r)： <strong>s</strong> 是否匹配 <strong>r</strong></li>\n<li>split(s,a,fs)：在 <strong>fs</strong> 上将 <strong>s</strong> 切割成序列 <strong>a</strong></li>\n<li>substr(s,p)：返回 <strong>s</strong> 从 <strong>p</strong> 开始的子串</li>\n</ul>\n<h3 id=\"流程控制语句\"><a href=\"#流程控制语句\" class=\"headerlink\" title=\"流程控制语句\"></a>流程控制语句</h3><ol>\n<li><code>BEGIN {} END {}</code></li>\n<li><code>if(coondotion){}else{}</code></li>\n<li><code>while(condition){}</code></li>\n<li><code>do()while(condition)</code></li>\n<li><code>for(init;condition;step){}</code></li>\n<li><code>break/continue</code></li>\n</ol>\n<h2 id=\"sed\"><a href=\"#sed\" class=\"headerlink\" title=\"sed\"></a>sed</h2><blockquote>\n<p>sed是一种行文本处理工具，它一次处理一行内容</p>\n</blockquote>\n<h3 id=\"使用方式-1\"><a href=\"#使用方式-1\" class=\"headerlink\" title=\"使用方式\"></a>使用方式</h3><p><code>sed [options] &#39;command&#39; file(s)</code></p>\n<blockquote>\n<p>  示例： 输出某个文本里面全部的内容：<br>    <code>sed -n p 11-07.log</code> # 输出 11-07.log 文件的日志<br>        -n：sed会在处理一行文本前，将待处理的文本打印出来，-n参数关闭了这个功能<br>        p：命令表示打印当前行<br>    若要输出某几行显示 则可以在 P 前面加上行数 并以 , 分割 格式为 sed -n ‘第几行,截止到第几行’p file(s)<br>    sed -n ‘1,2’p 11-07.log  # 输出 11-07.log 文件中第一行到第二行的内容<br>    如果要输出第几行到最后的内容可以使用 $<br>    sed -n ‘5,$’p 11-07.log  # 输出 11-07.log 文件中第五行开始一直到最后的所有内容 </p>\n</blockquote>\n<h3 id=\"相关命令\"><a href=\"#相关命令\" class=\"headerlink\" title=\"相关命令\"></a>相关命令</h3><h4 id=\"将匹配行删除\"><a href=\"#将匹配行删除\" class=\"headerlink\" title=\"将匹配行删除\"></a>将匹配行删除</h4><p><code>sed &#39;/hello/&#39;d 11-07.log</code> 该命令会输出 11-07.log 文件中的内容，同时把匹配到 hello 的行会删除 （该命令只会影响输出后的显示内容，对源文件不做修改）</p>\n<h4 id=\"将匹配行替换\"><a href=\"#将匹配行替换\" class=\"headerlink\" title=\"将匹配行替换\"></a>将匹配行替换</h4><p>命令格式： <code>s/pattern-to-find/replacement-pattern/g</code><br>        <strong>pattern-to-find</strong>：被替换的串<br>        <strong>replacement-pattern</strong>：替换成这个串<br>        <strong>g</strong>：全部替换，如果不加 <strong>g</strong> 默认只替换匹配到的第一个<br><code>sed &#39;s/php/python/g&#39; 11-07.log</code> 该命令会输出 11-07.log 文件中的内容，同时把文件中出现的 <code>php</code> 全部替换为 <code>python</code></p>\n<h2 id=\"实例：-查找某个时间段内服务器的访问IP\"><a href=\"#实例：-查找某个时间段内服务器的访问IP\" class=\"headerlink\" title=\"实例： 查找某个时间段内服务器的访问IP\"></a>实例： 查找某个时间段内服务器的访问IP</h2><p><em>在此感谢某位大佬</em> <a href=\"https://gitee.com/alwaysthanksFel\" target=\"_blank\" rel=\"noopener\">@大佬</a></p>\n<figure class=\"highlight bash\"><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\">sed -n <span class=\"string\">'/2018:06:25:59/,/2018:09:50/p'</span> access.log | awk <span class=\"string\">'&#123;print $1&#125;'</span> | sort -nrk1 | uniq -c | tee</div></pre></div></div></figure>\n<blockquote>\n<p>uniq -c       统计去重的行数<br>  sort -nrk1    k : 第几列 n：以数字模式排序 r：倒序排序<br>  sed ‘/^$/d’   删除空行</p>\n</blockquote>\n<hr>\n<h1 id=\"OpenSSL-生成秘钥文件\"><a href=\"#OpenSSL-生成秘钥文件\" class=\"headerlink\" title=\"OpenSSL 生成秘钥文件\"></a>OpenSSL 生成秘钥文件</h1><blockquote>\n<p>输入<code>openssl</code>进入openssl交互界面 </p>\n</blockquote>\n<ol>\n<li><p>生成私钥：       </p>\n<figure class=\"highlight bash\"><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\">genrsa -out rsa_private_key.pem 1024</div></pre></div></div></figure>\n</li>\n<li><p>转换成pckcs8格式：</p>\n<figure class=\"highlight bash\"><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\">pkcs8 -topk8 -nocrypt -inform PEM -<span class=\"keyword\">in</span> rsa_private_key.pem -outform PEM outform</div></pre></div></div></figure>\n</li>\n<li><p>根据私钥生成公钥： </p>\n<figure class=\"highlight bash\"><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\">rsa -<span class=\"keyword\">in</span> rsa_private_key.pem -pubout -out rsa_public_key.pem</div></pre></div></div></figure>\n</li>\n</ol>\n<hr>\n<h1 id=\"其他命令\"><a href=\"#其他命令\" class=\"headerlink\" title=\"其他命令\"></a>其他命令</h1><ul>\n<li><code>grep -C 5 foo file</code> 显示file文件里匹配foo字串那行以及上下5行</li>\n<li><code>cut -d &#39;,&#39; -f 1</code>   d：以逗号切割  f：每行切割的第几份</li>\n<li><code>ps -eo %mem,%cpu,comm --sort=-%mem | head -n 6</code> 查看使用内存最多的五个进程</li>\n</ul>\n<h2 id=\"文件批量重命名\"><a href=\"#文件批量重命名\" class=\"headerlink\" title=\"文件批量重命名\"></a>文件批量重命名</h2><figure class=\"highlight bash\"><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># 使用 for 循环</span></div><div class=\"line\"><span class=\"keyword\">for</span> fn <span class=\"keyword\">in</span> *.jpg; <span class=\"keyword\">do</span> convert <span class=\"string\">\"<span class=\"variable\">$fn</span>\"</span> `<span class=\"built_in\">echo</span> <span class=\"variable\">$fn</span> | sed <span class=\"string\">'s/jpg$/png/'</span>`; <span class=\"keyword\">done</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 使用 xargs </span></div><div class=\"line\">ls *.jpg | xargs -I&#123;&#125; convert <span class=\"string\">\"&#123;&#125;\"</span> `<span class=\"built_in\">echo</span> &#123;&#125; | sed <span class=\"string\">'s/jpg$/png/'</span>`</div></pre></div></div></figure>\n","site":{"data":{}},"excerpt":"<p>本文主要记录在学习或者工作中用到的一些 <strong>Linux</strong> 命令</p>","more":"<h1 id=\"常用命令\"><a href=\"#常用命令\" class=\"headerlink\" title=\"常用命令\"></a>常用命令</h1><h2 id=\"ls-命令详细\"><a href=\"#ls-命令详细\" class=\"headerlink\" title=\"ls 命令详细\"></a>ls 命令详细</h2><ul>\n<li>按文件大小列出： <code>ls -s</code></li>\n<li>按时间和日期排序： <code>ls -t</code></li>\n<li>按扩展名排序： <code>ls -X</code></li>\n<li>按文件大小排序：<code>ls -S</code></li>\n</ul>\n<h2 id=\"find-文件查找\"><a href=\"#find-文件查找\" class=\"headerlink\" title=\"find 文件查找\"></a>find 文件查找</h2><figure class=\"highlight bash\"><figcaption><span class=\"caption\">Find 命令</span><a href=\"https://linux.cn/article-9648-1.html\" target=\"_blank\">相关链接</a></figcaption><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># 查找最后修改的时间为7天前的，jpg 或 jpeg 格式的图片 【注意括号后面需要添加一个空格】</span></div><div class=\"line\">find ./ \\( -iname <span class=\"string\">'*.jpeg'</span> -o -iname <span class=\"string\">'*.jpg'</span> \\) -<span class=\"built_in\">type</span> f -mtime + 7</div></pre></div></div></figure>\n<hr>\n<h1 id=\"文本处理命令-awk-amp-sed\"><a href=\"#文本处理命令-awk-amp-sed\" class=\"headerlink\" title=\"文本处理命令 awk &amp; sed\"></a>文本处理命令 awk &amp; sed</h1><h2 id=\"awk\"><a href=\"#awk\" class=\"headerlink\" title=\"awk\"></a>awk</h2><blockquote>\n<p>awk 是一个行文本处理工具，逐行处理文件中的数据</p>\n</blockquote>\n<h3 id=\"使用方式\"><a href=\"#使用方式\" class=\"headerlink\" title=\"使用方式\"></a>使用方式</h3><p><code>awk &#39;pattern + {action}&#39;</code></p>\n<blockquote>\n<p><code>{action}</code> 是一个命令分组，<code>action</code> 是处理命令<br><code>pattern</code> 是一个过滤器，表示经过过滤后的内容经过 <code>action</code> 处理，两者必须存在其一，可以同时存在<br><code>pattern</code> 参数可以是正则表达式<br>示例： <code>cat 11-08.log | awk &#39;/hello/&#39;</code>  # 输出 11-08.log 文件中包含 hello 的行<br>      `cat 11-08.log | awk ‘/hello/ {print NR}’  # 输出 11-08.log 文件中包含 hello 的行号</p>\n</blockquote>\n<h3 id=\"awk-内置变量-和-函数\"><a href=\"#awk-内置变量-和-函数\" class=\"headerlink\" title=\"awk 内置变量 和 函数\"></a>awk 内置变量 和 函数</h3><h4 id=\"变量\"><a href=\"#变量\" class=\"headerlink\" title=\"变量\"></a>变量</h4><ul>\n<li>NR 当前行号</li>\n<li>FS 分隔符，默认是空格</li>\n<li>NF 当前记录的字段个数</li>\n<li>$0 当前记录</li>\n<li>$1~$n 当前记录的第 n 个字段 <blockquote>\n<p>例如： <code>cat 11-08.log | awk &#39;NR==2,NR==4 {print $NF}&#39;</code>  # 显示 11-08.log 文件中的第2行到第4行的最后一列</p>\n</blockquote>\n</li>\n</ul>\n<h4 id=\"函数\"><a href=\"#函数\" class=\"headerlink\" title=\"函数\"></a>函数</h4><ul>\n<li>gsub(r,s)：在 <strong>$0</strong> 中用 <strong>s</strong> 代替 <strong>r</strong></li>\n<li>index(s,t)：返回 <strong>s</strong> 中 <strong>t</strong> 的第一个位置</li>\n<li>length(s)： <strong>s</strong> 的长度</li>\n<li>match(s,r)： <strong>s</strong> 是否匹配 <strong>r</strong></li>\n<li>split(s,a,fs)：在 <strong>fs</strong> 上将 <strong>s</strong> 切割成序列 <strong>a</strong></li>\n<li>substr(s,p)：返回 <strong>s</strong> 从 <strong>p</strong> 开始的子串</li>\n</ul>\n<h3 id=\"流程控制语句\"><a href=\"#流程控制语句\" class=\"headerlink\" title=\"流程控制语句\"></a>流程控制语句</h3><ol>\n<li><code>BEGIN {} END {}</code></li>\n<li><code>if(coondotion){}else{}</code></li>\n<li><code>while(condition){}</code></li>\n<li><code>do()while(condition)</code></li>\n<li><code>for(init;condition;step){}</code></li>\n<li><code>break/continue</code></li>\n</ol>\n<h2 id=\"sed\"><a href=\"#sed\" class=\"headerlink\" title=\"sed\"></a>sed</h2><blockquote>\n<p>sed是一种行文本处理工具，它一次处理一行内容</p>\n</blockquote>\n<h3 id=\"使用方式-1\"><a href=\"#使用方式-1\" class=\"headerlink\" title=\"使用方式\"></a>使用方式</h3><p><code>sed [options] &#39;command&#39; file(s)</code></p>\n<blockquote>\n<p>  示例： 输出某个文本里面全部的内容：<br>    <code>sed -n p 11-07.log</code> # 输出 11-07.log 文件的日志<br>        -n：sed会在处理一行文本前，将待处理的文本打印出来，-n参数关闭了这个功能<br>        p：命令表示打印当前行<br>    若要输出某几行显示 则可以在 P 前面加上行数 并以 , 分割 格式为 sed -n ‘第几行,截止到第几行’p file(s)<br>    sed -n ‘1,2’p 11-07.log  # 输出 11-07.log 文件中第一行到第二行的内容<br>    如果要输出第几行到最后的内容可以使用 $<br>    sed -n ‘5,$’p 11-07.log  # 输出 11-07.log 文件中第五行开始一直到最后的所有内容 </p>\n</blockquote>\n<h3 id=\"相关命令\"><a href=\"#相关命令\" class=\"headerlink\" title=\"相关命令\"></a>相关命令</h3><h4 id=\"将匹配行删除\"><a href=\"#将匹配行删除\" class=\"headerlink\" title=\"将匹配行删除\"></a>将匹配行删除</h4><p><code>sed &#39;/hello/&#39;d 11-07.log</code> 该命令会输出 11-07.log 文件中的内容，同时把匹配到 hello 的行会删除 （该命令只会影响输出后的显示内容，对源文件不做修改）</p>\n<h4 id=\"将匹配行替换\"><a href=\"#将匹配行替换\" class=\"headerlink\" title=\"将匹配行替换\"></a>将匹配行替换</h4><p>命令格式： <code>s/pattern-to-find/replacement-pattern/g</code><br>        <strong>pattern-to-find</strong>：被替换的串<br>        <strong>replacement-pattern</strong>：替换成这个串<br>        <strong>g</strong>：全部替换，如果不加 <strong>g</strong> 默认只替换匹配到的第一个<br><code>sed &#39;s/php/python/g&#39; 11-07.log</code> 该命令会输出 11-07.log 文件中的内容，同时把文件中出现的 <code>php</code> 全部替换为 <code>python</code></p>\n<h2 id=\"实例：-查找某个时间段内服务器的访问IP\"><a href=\"#实例：-查找某个时间段内服务器的访问IP\" class=\"headerlink\" title=\"实例： 查找某个时间段内服务器的访问IP\"></a>实例： 查找某个时间段内服务器的访问IP</h2><p><em>在此感谢某位大佬</em> <a href=\"https://gitee.com/alwaysthanksFel\" target=\"_blank\" rel=\"noopener\">@大佬</a></p>\n<figure class=\"highlight bash\"><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\">sed -n <span class=\"string\">'/2018:06:25:59/,/2018:09:50/p'</span> access.log | awk <span class=\"string\">'&#123;print $1&#125;'</span> | sort -nrk1 | uniq -c | tee</div></pre></div></div></figure>\n<blockquote>\n<p>uniq -c       统计去重的行数<br>  sort -nrk1    k : 第几列 n：以数字模式排序 r：倒序排序<br>  sed ‘/^$/d’   删除空行</p>\n</blockquote>\n<hr>\n<h1 id=\"OpenSSL-生成秘钥文件\"><a href=\"#OpenSSL-生成秘钥文件\" class=\"headerlink\" title=\"OpenSSL 生成秘钥文件\"></a>OpenSSL 生成秘钥文件</h1><blockquote>\n<p>输入<code>openssl</code>进入openssl交互界面 </p>\n</blockquote>\n<ol>\n<li><p>生成私钥：       </p>\n<figure class=\"highlight bash\"><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\">genrsa -out rsa_private_key.pem 1024</div></pre></div></div></figure>\n</li>\n<li><p>转换成pckcs8格式：</p>\n<figure class=\"highlight bash\"><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\">pkcs8 -topk8 -nocrypt -inform PEM -<span class=\"keyword\">in</span> rsa_private_key.pem -outform PEM outform</div></pre></div></div></figure>\n</li>\n<li><p>根据私钥生成公钥： </p>\n<figure class=\"highlight bash\"><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\">rsa -<span class=\"keyword\">in</span> rsa_private_key.pem -pubout -out rsa_public_key.pem</div></pre></div></div></figure>\n</li>\n</ol>\n<hr>\n<h1 id=\"其他命令\"><a href=\"#其他命令\" class=\"headerlink\" title=\"其他命令\"></a>其他命令</h1><ul>\n<li><code>grep -C 5 foo file</code> 显示file文件里匹配foo字串那行以及上下5行</li>\n<li><code>cut -d &#39;,&#39; -f 1</code>   d：以逗号切割  f：每行切割的第几份</li>\n<li><code>ps -eo %mem,%cpu,comm --sort=-%mem | head -n 6</code> 查看使用内存最多的五个进程</li>\n</ul>\n<h2 id=\"文件批量重命名\"><a href=\"#文件批量重命名\" class=\"headerlink\" title=\"文件批量重命名\"></a>文件批量重命名</h2><figure class=\"highlight bash\"><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># 使用 for 循环</span></div><div class=\"line\"><span class=\"keyword\">for</span> fn <span class=\"keyword\">in</span> *.jpg; <span class=\"keyword\">do</span> convert <span class=\"string\">\"<span class=\"variable\">$fn</span>\"</span> `<span class=\"built_in\">echo</span> <span class=\"variable\">$fn</span> | sed <span class=\"string\">'s/jpg$/png/'</span>`; <span class=\"keyword\">done</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 使用 xargs </span></div><div class=\"line\">ls *.jpg | xargs -I&#123;&#125; convert <span class=\"string\">\"&#123;&#125;\"</span> `<span class=\"built_in\">echo</span> &#123;&#125; | sed <span class=\"string\">'s/jpg$/png/'</span>`</div></pre></div></div></figure>"},{"title":"MySQL要点","date":"2018-11-01T03:45:27.000Z","_content":"\n在一个中大型项目中，随着时间的积累和业务的不断升级，数据的优化处理愈发关键，一个好的数据库设计和优化是项目业务稳定运行的根本\n\n<!-- more -->\n\n# MySQL 的基础架构\n`MySQL` 是一种关系数据库产品，是建立在关系模型基础上的数据库。架构一般可分为 **应用层** ，**逻辑层**，**物理层**\n- 应用层 ： 负责和客户端以及用户进行交互\n- 逻辑层 ： 负责具体的查询处理，事物管理，存储管理，恢复管理等\n- 物理层 ： 磁盘上的数据库文件（存储文件，日志文件等）\n\n# MySQL 常用存储引擎比较\n> 查看MySQL的默认存储引擎 `show variables like '%storage_engine%'`\n\n- InnoDB： MySQL版本大于5.5时的默认引擎 适用于读少，写多以及高并发场景\n    + 灾难恢复性好\n    + 支持全部的事物[隔离级别](#事物的隔离级别)\n    + 使用行级锁\n    + 支持外键\n    + 不支持全文索引 （全文索引可以使用**Sphinx**）\n    + 按行删除\n    \n- MyISAM： 适用于读多，写少对原子性要求低的场景\n    + 支持全文索引\n    + 单独维护索引文件(MYI)\n    + 不支持事物\n    + 不支持外键\n    + 只支持表级锁\n    + 可以被压缩，存储空间小\n    + 删除时会先删除表，然后重新建立表结构\n\n# 事物\n## 事物的基本要素\n1. 原子性(Atomicity)： 事物开始后的所有操作要么回退，要么提交，不会停留在中间的某个部分，类似于化学中的原子，构成物质的最基本单位\n2. 一致性(Consistency)： 事务开始前和结束后，数据库的完整性约束没有被破坏\n3. 隔离性(Isolation)： 同一时间，只允许一个事务请求同一数据，不同的事务之间彼此没有任何干扰\n4. 持久性(Durability)： 事务完成后，事务对数据库的所有更新将被保存到数据库，不能回滚\n\n## 事物的隔离级别\n|事物的隔离级别|脏读|不可重复度|幻读|\n|--|--|--|--|\n|读未提交| 是 | 是 | 是 |\n|不可重复读 | 否 | 是 | 是 |\n|可重复读 (默认) | 否 | 否 | 是 |\n|串行化 | 否 | 否 | 否 |\n\n# 优化\n\n## 常见优化\n- 避免使用函数索引\n- 使用 `in` 来代替 `between`\n- 使用 `union all` 来代替 `or`\n- 避免类型转换（查询的类型要与字段的类型一致）\n- 尽量不使用 `NOT IN` 和 `<>` \n- 除非必要的条件下 **事物** 可以使用锁表来代替\n\n## 索引命中\n\n**在以下场景中MySQL不会使用索引**\n- 使用 `NOT IN` 、 `!=` 以及 `<>` 不等于的时候\n- 在 `join` 时条件字段类型不一致的时候\n- 以 `%` 开头 的 `like` 查询\n- 使用 `or` 的时候， `or` 的前后字段中存在没有索引的情况时\n- 在组合索引里使用非第一个索引字段时也不使用索引","source":"_posts/MySQL要点.md","raw":"---\ntitle: MySQL要点\ndate: 2018-11-01 11:45:27\ncategories: MySQL\ntags: ['MySQL']\n---\n\n在一个中大型项目中，随着时间的积累和业务的不断升级，数据的优化处理愈发关键，一个好的数据库设计和优化是项目业务稳定运行的根本\n\n<!-- more -->\n\n# MySQL 的基础架构\n`MySQL` 是一种关系数据库产品，是建立在关系模型基础上的数据库。架构一般可分为 **应用层** ，**逻辑层**，**物理层**\n- 应用层 ： 负责和客户端以及用户进行交互\n- 逻辑层 ： 负责具体的查询处理，事物管理，存储管理，恢复管理等\n- 物理层 ： 磁盘上的数据库文件（存储文件，日志文件等）\n\n# MySQL 常用存储引擎比较\n> 查看MySQL的默认存储引擎 `show variables like '%storage_engine%'`\n\n- InnoDB： MySQL版本大于5.5时的默认引擎 适用于读少，写多以及高并发场景\n    + 灾难恢复性好\n    + 支持全部的事物[隔离级别](#事物的隔离级别)\n    + 使用行级锁\n    + 支持外键\n    + 不支持全文索引 （全文索引可以使用**Sphinx**）\n    + 按行删除\n    \n- MyISAM： 适用于读多，写少对原子性要求低的场景\n    + 支持全文索引\n    + 单独维护索引文件(MYI)\n    + 不支持事物\n    + 不支持外键\n    + 只支持表级锁\n    + 可以被压缩，存储空间小\n    + 删除时会先删除表，然后重新建立表结构\n\n# 事物\n## 事物的基本要素\n1. 原子性(Atomicity)： 事物开始后的所有操作要么回退，要么提交，不会停留在中间的某个部分，类似于化学中的原子，构成物质的最基本单位\n2. 一致性(Consistency)： 事务开始前和结束后，数据库的完整性约束没有被破坏\n3. 隔离性(Isolation)： 同一时间，只允许一个事务请求同一数据，不同的事务之间彼此没有任何干扰\n4. 持久性(Durability)： 事务完成后，事务对数据库的所有更新将被保存到数据库，不能回滚\n\n## 事物的隔离级别\n|事物的隔离级别|脏读|不可重复度|幻读|\n|--|--|--|--|\n|读未提交| 是 | 是 | 是 |\n|不可重复读 | 否 | 是 | 是 |\n|可重复读 (默认) | 否 | 否 | 是 |\n|串行化 | 否 | 否 | 否 |\n\n# 优化\n\n## 常见优化\n- 避免使用函数索引\n- 使用 `in` 来代替 `between`\n- 使用 `union all` 来代替 `or`\n- 避免类型转换（查询的类型要与字段的类型一致）\n- 尽量不使用 `NOT IN` 和 `<>` \n- 除非必要的条件下 **事物** 可以使用锁表来代替\n\n## 索引命中\n\n**在以下场景中MySQL不会使用索引**\n- 使用 `NOT IN` 、 `!=` 以及 `<>` 不等于的时候\n- 在 `join` 时条件字段类型不一致的时候\n- 以 `%` 开头 的 `like` 查询\n- 使用 `or` 的时候， `or` 的前后字段中存在没有索引的情况时\n- 在组合索引里使用非第一个索引字段时也不使用索引","slug":"MySQL要点","published":1,"updated":"2018-11-08T04:19:01.035Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjopirm6h000d2cwmt4tarxex","content":"<p>在一个中大型项目中，随着时间的积累和业务的不断升级，数据的优化处理愈发关键，一个好的数据库设计和优化是项目业务稳定运行的根本</p>\n<a id=\"more\"></a>\n<h1 id=\"MySQL-的基础架构\"><a href=\"#MySQL-的基础架构\" class=\"headerlink\" title=\"MySQL 的基础架构\"></a>MySQL 的基础架构</h1><p><code>MySQL</code> 是一种关系数据库产品，是建立在关系模型基础上的数据库。架构一般可分为 <strong>应用层</strong> ，<strong>逻辑层</strong>，<strong>物理层</strong></p>\n<ul>\n<li>应用层 ： 负责和客户端以及用户进行交互</li>\n<li>逻辑层 ： 负责具体的查询处理，事物管理，存储管理，恢复管理等</li>\n<li>物理层 ： 磁盘上的数据库文件（存储文件，日志文件等）</li>\n</ul>\n<h1 id=\"MySQL-常用存储引擎比较\"><a href=\"#MySQL-常用存储引擎比较\" class=\"headerlink\" title=\"MySQL 常用存储引擎比较\"></a>MySQL 常用存储引擎比较</h1><blockquote>\n<p>查看MySQL的默认存储引擎 <code>show variables like &#39;%storage_engine%&#39;</code></p>\n</blockquote>\n<ul>\n<li><p>InnoDB： MySQL版本大于5.5时的默认引擎 适用于读少，写多以及高并发场景</p>\n<ul>\n<li>灾难恢复性好</li>\n<li>支持全部的事物<a href=\"#事物的隔离级别\">隔离级别</a></li>\n<li>使用行级锁</li>\n<li>支持外键</li>\n<li>不支持全文索引 （全文索引可以使用<strong>Sphinx</strong>）</li>\n<li>按行删除</li>\n</ul>\n</li>\n<li><p>MyISAM： 适用于读多，写少对原子性要求低的场景</p>\n<ul>\n<li>支持全文索引</li>\n<li>单独维护索引文件(MYI)</li>\n<li>不支持事物</li>\n<li>不支持外键</li>\n<li>只支持表级锁</li>\n<li>可以被压缩，存储空间小</li>\n<li>删除时会先删除表，然后重新建立表结构</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"事物\"><a href=\"#事物\" class=\"headerlink\" title=\"事物\"></a>事物</h1><h2 id=\"事物的基本要素\"><a href=\"#事物的基本要素\" class=\"headerlink\" title=\"事物的基本要素\"></a>事物的基本要素</h2><ol>\n<li>原子性(Atomicity)： 事物开始后的所有操作要么回退，要么提交，不会停留在中间的某个部分，类似于化学中的原子，构成物质的最基本单位</li>\n<li>一致性(Consistency)： 事务开始前和结束后，数据库的完整性约束没有被破坏</li>\n<li>隔离性(Isolation)： 同一时间，只允许一个事务请求同一数据，不同的事务之间彼此没有任何干扰</li>\n<li>持久性(Durability)： 事务完成后，事务对数据库的所有更新将被保存到数据库，不能回滚</li>\n</ol>\n<h2 id=\"事物的隔离级别\"><a href=\"#事物的隔离级别\" class=\"headerlink\" title=\"事物的隔离级别\"></a>事物的隔离级别</h2><table>\n<thead>\n<tr>\n<th>事物的隔离级别</th>\n<th>脏读</th>\n<th>不可重复度</th>\n<th>幻读</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>读未提交</td>\n<td>是</td>\n<td>是</td>\n<td>是</td>\n</tr>\n<tr>\n<td>不可重复读</td>\n<td>否</td>\n<td>是</td>\n<td>是</td>\n</tr>\n<tr>\n<td>可重复读 (默认)</td>\n<td>否</td>\n<td>否</td>\n<td>是</td>\n</tr>\n<tr>\n<td>串行化</td>\n<td>否</td>\n<td>否</td>\n<td>否</td>\n</tr>\n</tbody>\n</table>\n<h1 id=\"优化\"><a href=\"#优化\" class=\"headerlink\" title=\"优化\"></a>优化</h1><h2 id=\"常见优化\"><a href=\"#常见优化\" class=\"headerlink\" title=\"常见优化\"></a>常见优化</h2><ul>\n<li>避免使用函数索引</li>\n<li>使用 <code>in</code> 来代替 <code>between</code></li>\n<li>使用 <code>union all</code> 来代替 <code>or</code></li>\n<li>避免类型转换（查询的类型要与字段的类型一致）</li>\n<li>尽量不使用 <code>NOT IN</code> 和 <code>&lt;&gt;</code> </li>\n<li>除非必要的条件下 <strong>事物</strong> 可以使用锁表来代替</li>\n</ul>\n<h2 id=\"索引命中\"><a href=\"#索引命中\" class=\"headerlink\" title=\"索引命中\"></a>索引命中</h2><p><strong>在以下场景中MySQL不会使用索引</strong></p>\n<ul>\n<li>使用 <code>NOT IN</code> 、 <code>!=</code> 以及 <code>&lt;&gt;</code> 不等于的时候</li>\n<li>在 <code>join</code> 时条件字段类型不一致的时候</li>\n<li>以 <code>%</code> 开头 的 <code>like</code> 查询</li>\n<li>使用 <code>or</code> 的时候， <code>or</code> 的前后字段中存在没有索引的情况时</li>\n<li>在组合索引里使用非第一个索引字段时也不使用索引</li>\n</ul>\n","site":{"data":{}},"excerpt":"<p>在一个中大型项目中，随着时间的积累和业务的不断升级，数据的优化处理愈发关键，一个好的数据库设计和优化是项目业务稳定运行的根本</p>","more":"<h1 id=\"MySQL-的基础架构\"><a href=\"#MySQL-的基础架构\" class=\"headerlink\" title=\"MySQL 的基础架构\"></a>MySQL 的基础架构</h1><p><code>MySQL</code> 是一种关系数据库产品，是建立在关系模型基础上的数据库。架构一般可分为 <strong>应用层</strong> ，<strong>逻辑层</strong>，<strong>物理层</strong></p>\n<ul>\n<li>应用层 ： 负责和客户端以及用户进行交互</li>\n<li>逻辑层 ： 负责具体的查询处理，事物管理，存储管理，恢复管理等</li>\n<li>物理层 ： 磁盘上的数据库文件（存储文件，日志文件等）</li>\n</ul>\n<h1 id=\"MySQL-常用存储引擎比较\"><a href=\"#MySQL-常用存储引擎比较\" class=\"headerlink\" title=\"MySQL 常用存储引擎比较\"></a>MySQL 常用存储引擎比较</h1><blockquote>\n<p>查看MySQL的默认存储引擎 <code>show variables like &#39;%storage_engine%&#39;</code></p>\n</blockquote>\n<ul>\n<li><p>InnoDB： MySQL版本大于5.5时的默认引擎 适用于读少，写多以及高并发场景</p>\n<ul>\n<li>灾难恢复性好</li>\n<li>支持全部的事物<a href=\"#事物的隔离级别\">隔离级别</a></li>\n<li>使用行级锁</li>\n<li>支持外键</li>\n<li>不支持全文索引 （全文索引可以使用<strong>Sphinx</strong>）</li>\n<li>按行删除</li>\n</ul>\n</li>\n<li><p>MyISAM： 适用于读多，写少对原子性要求低的场景</p>\n<ul>\n<li>支持全文索引</li>\n<li>单独维护索引文件(MYI)</li>\n<li>不支持事物</li>\n<li>不支持外键</li>\n<li>只支持表级锁</li>\n<li>可以被压缩，存储空间小</li>\n<li>删除时会先删除表，然后重新建立表结构</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"事物\"><a href=\"#事物\" class=\"headerlink\" title=\"事物\"></a>事物</h1><h2 id=\"事物的基本要素\"><a href=\"#事物的基本要素\" class=\"headerlink\" title=\"事物的基本要素\"></a>事物的基本要素</h2><ol>\n<li>原子性(Atomicity)： 事物开始后的所有操作要么回退，要么提交，不会停留在中间的某个部分，类似于化学中的原子，构成物质的最基本单位</li>\n<li>一致性(Consistency)： 事务开始前和结束后，数据库的完整性约束没有被破坏</li>\n<li>隔离性(Isolation)： 同一时间，只允许一个事务请求同一数据，不同的事务之间彼此没有任何干扰</li>\n<li>持久性(Durability)： 事务完成后，事务对数据库的所有更新将被保存到数据库，不能回滚</li>\n</ol>\n<h2 id=\"事物的隔离级别\"><a href=\"#事物的隔离级别\" class=\"headerlink\" title=\"事物的隔离级别\"></a>事物的隔离级别</h2><table>\n<thead>\n<tr>\n<th>事物的隔离级别</th>\n<th>脏读</th>\n<th>不可重复度</th>\n<th>幻读</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>读未提交</td>\n<td>是</td>\n<td>是</td>\n<td>是</td>\n</tr>\n<tr>\n<td>不可重复读</td>\n<td>否</td>\n<td>是</td>\n<td>是</td>\n</tr>\n<tr>\n<td>可重复读 (默认)</td>\n<td>否</td>\n<td>否</td>\n<td>是</td>\n</tr>\n<tr>\n<td>串行化</td>\n<td>否</td>\n<td>否</td>\n<td>否</td>\n</tr>\n</tbody>\n</table>\n<h1 id=\"优化\"><a href=\"#优化\" class=\"headerlink\" title=\"优化\"></a>优化</h1><h2 id=\"常见优化\"><a href=\"#常见优化\" class=\"headerlink\" title=\"常见优化\"></a>常见优化</h2><ul>\n<li>避免使用函数索引</li>\n<li>使用 <code>in</code> 来代替 <code>between</code></li>\n<li>使用 <code>union all</code> 来代替 <code>or</code></li>\n<li>避免类型转换（查询的类型要与字段的类型一致）</li>\n<li>尽量不使用 <code>NOT IN</code> 和 <code>&lt;&gt;</code> </li>\n<li>除非必要的条件下 <strong>事物</strong> 可以使用锁表来代替</li>\n</ul>\n<h2 id=\"索引命中\"><a href=\"#索引命中\" class=\"headerlink\" title=\"索引命中\"></a>索引命中</h2><p><strong>在以下场景中MySQL不会使用索引</strong></p>\n<ul>\n<li>使用 <code>NOT IN</code> 、 <code>!=</code> 以及 <code>&lt;&gt;</code> 不等于的时候</li>\n<li>在 <code>join</code> 时条件字段类型不一致的时候</li>\n<li>以 <code>%</code> 开头 的 <code>like</code> 查询</li>\n<li>使用 <code>or</code> 的时候， <code>or</code> 的前后字段中存在没有索引的情况时</li>\n<li>在组合索引里使用非第一个索引字段时也不使用索引</li>\n</ul>"},{"title":"Hello World","_content":" ## Hello Hexo\n ## Hello Github.io\n ## Hello Myblog","source":"_posts/hello-world.md","raw":"---\ntitle: Hello World\n---\n ## Hello Hexo\n ## Hello Github.io\n ## Hello Myblog","slug":"hello-world","published":1,"date":"2018-05-14T03:42:55.092Z","updated":"2018-11-08T04:19:01.039Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjopirm6o000e2cwm015w2fph","content":"<h2 id=\"Hello-Hexo\"><a href=\"#Hello-Hexo\" class=\"headerlink\" title=\"Hello Hexo\"></a>Hello Hexo</h2><h2 id=\"Hello-Github-io\"><a href=\"#Hello-Github-io\" class=\"headerlink\" title=\"Hello Github.io\"></a>Hello Github.io</h2><h2 id=\"Hello-Myblog\"><a href=\"#Hello-Myblog\" class=\"headerlink\" title=\"Hello Myblog\"></a>Hello Myblog</h2>","site":{"data":{}},"excerpt":"","more":"<h2 id=\"Hello-Hexo\"><a href=\"#Hello-Hexo\" class=\"headerlink\" title=\"Hello Hexo\"></a>Hello Hexo</h2><h2 id=\"Hello-Github-io\"><a href=\"#Hello-Github-io\" class=\"headerlink\" title=\"Hello Github.io\"></a>Hello Github.io</h2><h2 id=\"Hello-Myblog\"><a href=\"#Hello-Myblog\" class=\"headerlink\" title=\"Hello Myblog\"></a>Hello Myblog</h2>"},{"title":"即书服务器搭建记录","date":"2018-06-22T03:35:38.000Z","_content":"<blockquote class=\"blockquote-center\">学而践行之</blockquote>\n\n<!--more-->\n\n服务器环境： *Ubuntu: V16.04*\n\n# 软件列表\n\n | 环境 | 版本 |\n | -------- | -------- |\n | Nginx    | V1.10.3  |\n | PHP      | V7.1.18 |\n | MySQL    | V5.7.22 |\n | Redis    | V3.1.6  |\n | Git      | V2.7.4 |\n | libreoffice| V5.4  |\n | inkscape | -  |\n | lrzsz    | V0.12.21-8 |\n | tmux     | V2.1.3  |\n \n# 准备\n> 更新软件源为阿里源\n```bash :/etc/apt/source.list\n    # 备份\n    sudo cp /etc/apt/sources.list /etc/apt/sources.list.old\n    \n    # vim: /etc/apt/source.list\n    # deb cdrom:[Ubuntu 16.04 LTS _Xenial Xerus_ - Release amd64 (20160420.1)]/ xenial main restricted\n    deb-src http://archive.ubuntu.com/ubuntu xenial main restricted #Added by software-properties\n    deb http://mirrors.aliyun.com/ubuntu/ xenial main restricted\n    deb-src http://mirrors.aliyun.com/ubuntu/ xenial main restricted multiverse universe #Added by software-properties\n    deb http://mirrors.aliyun.com/ubuntu/ xenial-updates main restricted\n    deb-src http://mirrors.aliyun.com/ubuntu/ xenial-updates main restricted multiverse universe #Added by software-properties\n    deb http://mirrors.aliyun.com/ubuntu/ xenial universe\n    deb http://mirrors.aliyun.com/ubuntu/ xenial-updates universe\n    deb http://mirrors.aliyun.com/ubuntu/ xenial multiverse\n    deb http://mirrors.aliyun.com/ubuntu/ xenial-updates multiverse\n    deb http://mirrors.aliyun.com/ubuntu/ xenial-backports main restricted universe multiverse\n    deb-src http://mirrors.aliyun.com/ubuntu/ xenial-backports main restricted universe multiverse #Added by software-properties\n    deb http://archive.canonical.com/ubuntu xenial partner\n    deb-src http://archive.canonical.com/ubuntu xenial partner\n    deb http://mirrors.aliyun.com/ubuntu/ xenial-security main restricted\n    deb-src http://mirrors.aliyun.com/ubuntu/ xenial-security main restricted multiverse universe #Added by software-properties\n    deb http://mirrors.aliyun.com/ubuntu/ xenial-security universe\n    deb http://mirrors.aliyun.com/ubuntu/ xenial-security multiverse\n    \n    # 执行更新\n    sudo apt-get update\n```\n\n```shell :#@Ubuntu:>_ line_number:false\n    sudo apt-add-repository ppa:ondrej/php   # 添加 PHP 软件源\n    sudo add-apt-repository ppa:libreoffice/libreoffice-5-4    # 添加 Libreoffice5.4 软件源\n    报错则执行：\n        1. sudo apt-get install python-software-properties\n        2. sudo apt-get install software-properties-common\n    \n    sudo apt-get update    # 更新软件源\n```\n\n-----\n\n# 安装 Web 服务器环境\n [Nginx](#Nginx), [PHP](#PHP), [MySql](#MySql)\n\n## Nginx\n直接命令安装：`sudo apt-get install nginx` \n启动 Nginx ：`sudo service nginx start`\n\n>相关命令：\n- netstat -anp | grep nginx    查看Nginx进程\n- lsof -i:80                   查看80端口状态\n    \n## PHP\n命令安装：`sudo apt-get install php7.1`\n安装fpm：`sudo apt-get install php7.1-fpm`\n\n>相关命令：\n- php -v  安装完后检查\n- php -m  已安装的 PHP 模块\n\n## MySql\n命令安装：`apt-get install mysql-server mysql-client php7.1-mysql`\n> 在安装过程中会提示输入 root 用户的登录密码\n\n## Nginx 解析 PHP \n>PHP-FPM 与 Nginx 通信方式有两种，一种是基于TCP的 Internet domain socket 方式，一种是 UNIX domain socket 方式。 推荐使用第二种连接方式 Socket 路径为：/run/php/php7.1-fpm.sock\n\n```nginx :nginx.conf\n    location ~ \\.php$ {\n        include snippets/fastcgi-php.conf;\n        # With php7.0-cgi alone:\n        # fastcgi_pass 127.0.0.1:9000;\n        # With php7.0-fpm:\n        fastcgi_pass unix:/run/php/php7.1-fpm.sock;\n        fastcgi_index  index.php;\n        fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;\n        include        fastcgi_params;\n    }\n```\n\n```ini :/etc/php/7.1/fpm/pool.d/www.conf\n    ; 与 Nginx监听同一个 sock\n    listen = /run/php/php7.1-fpm.sock\n```\n## Redis 的安装\n```bash\n# 先安装 redis-server 和 redis-tools, 以及 编译PHP扩展包工具\nsudo apt-get install redis-server redis-tools php7.1-dev\n\n# 安装 php-redis 扩展 依次执行\nphpize7.1\n./configure --with-php-config=/usr/bin/php-config\nmake\nsudo make install\n\n# 安装完成后添加 扩展\necho \"extension=redis.so\" >> /etc/php/7.1/mods-available/redis.ini\nsudo ln -s /etc/php/7.1/mods-available/redis.ini /etc/php/7.1/cli/conf.d/20-redis.ini\nsudo ln -s /etc/php/7.1/mods-available/redis.ini /etc/php/7.1/fpm/conf.d/20-redis.ini\n```\n\n# 应用软件\n1. sudo apt-get install libreoffice   # 开源办公套件\n> eg： 将 word/ppt/excel 转换为 pdf ： `libreoffice  --invisible --convert-to pdf  demo.docx  `\n    \n2. sudo apt-get install inksacpe      # 矢量图转换工具\n> eg： 将 emf 转换为 png ： `inkscape -e output.png input.emf`\n\n3. sudo apt-get install lrzsz         # linux 快速传输工具\n> eg： 上传文件 `rz`， 下载文件 `sz filename`\n\n4. sudo apt-get install git           \n\n# 其他配置\n\n## tmux 配置\n\n```ini :~/.tmux.conf url:https://gitee.com/kongvip/config/blob/master/tmux.config 链接地址\n# 设置前缀为Ctrl + a\nset -g prefix C-x\n\n#解除Ctrl+b 与前缀的对应关系\nunbind C-b\n\n## 切换面板\n#up\nbind-key k select-pane -U\n#down\nbind-key j select-pane -D\n#left\nbind-key h select-pane -L\n#right\nbind-key l select-pane -R\n```\n\n## vim 配置\n\n```vim :~/.vimrc url:https://gitee.com/kongvip/config/blob/master/vimrc 链接地址\n\n\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\n\" 显示相关  \n\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\n\n\"set shortmess=atI   \" 启动的时候不显示那个援助乌干达儿童的提示  \n\"winpos 5 5          \" 设定窗口位置  \n\"set lines=40 columns=155    \" 设定窗口大小  \n\"set nu              \" 显示行号  \nset go=              \" 不要图形按钮  \n\"color asmanian2     \" 设置背景主题  \n\"syntax on           \" 语法高亮  \nautocmd InsertLeave * se nocul  \" 用浅色高亮当前行  \nautocmd InsertEnter * se cul    \" 用浅色高亮当前行  \n\"set ruler           \" 显示标尺  \nset showcmd         \" 输入的命令显示出来，看的清楚些  \n\"set cmdheight=1     \" 命令行（在状态行下）的高度，设置为1  \n\"set whichwrap+=<,>,h,l   \" 允许backspace和光标键跨越行边界(不建议)  \n\"set scrolloff=3     \" 光标移动到buffer的顶部和底部时保持3行距离  \n\nset statusline=%F%m%r%h%w\\ [FORMAT=%{&ff}]\\ [TYPE=%Y]\\ [POS=%l,%v][%p%%]\\ %{strftime(\\\"%d/%m/%y\\ -\\ %H:%M\\\")}   \"状态行显示的内容  \nset laststatus=1    \" 启动显示状态行(1),总是显示状态行(2)  \nset foldenable      \" 允许折叠  \nset foldmethod=manual   \" 手动折叠  \n\"set background=dark \"背景使用黑色 \nset nocompatible  \"去掉讨厌的有关vi一致性模式，避免以前版本的一些bug和局限  \n\n\" 显示中文帮助\nif version >= 603\n    set helplang=cn\n    set encoding=utf-8\nendif\n\n\" 设置配色方案\n\"colorscheme murphy\n\nset fencs=utf-8,ucs-bom,shift-jis,gb18030,gbk,gb2312,cp936\nset termencoding=utf-8\nset encoding=utf-8\nset fileencodings=ucs-bom,utf-8,cp936\nset fileencoding=utf-8\n\n\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\n\"\"\"\"\"新文件标题\n\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\n\n\"新建.c,.h,.sh,.java文件，自动插入文件头 \nautocmd BufNewFile *.cpp,*.[ch],*.sh,*.java exec \":call SetTitle()\" \n\n\"\"定义函数SetTitle，自动插入文件头 \nfunc SetTitle() \n    \"如果文件类型为.sh文件 \n    if &filetype == 'sh' \n        call setline(1,\"\\#########################################################################\") \n        call append(line(\".\"), \"\\# File Name: \".expand(\"%\")) \n        call append(line(\".\")+3, \"\\# Created Time: \".strftime(\"%c\")) \n        call append(line(\".\")+4, \"\\#########################################################################\") \n        call append(line(\".\")+5, \"\\#!/bin/bash\") \n        call append(line(\".\")+6, \"\") \n    else \n        call setline(1, \"/*************************************************************************\") \n        call append(line(\".\"), \"    > File Name: \".expand(\"%\")) \n        call append(line(\".\")+3, \"    > Created Time: \".strftime(\"%c\")) \n        call append(line(\".\")+4, \" ************************************************************************/\") \n        call append(line(\".\")+5, \"\")\n    endif\n\n    if &filetype == 'cpp'\n        call append(line(\".\")+6, \"#include<iostream>\")\n        call append(line(\".\")+7, \"using namespace std;\")\n        call append(line(\".\")+8, \"\")\n    endif\n\n    if &filetype == 'c'\n        call append(line(\".\")+6, \"#include<stdio.h>\")\n        call append(line(\".\")+7, \"\")\n    endif\n    \"新建文件后，自动定位到文件末尾\n    autocmd BufNewFile * normal G\nendfunc \n\n\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\n\"键盘命令\n\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\n\nnmap <leader>w :w!<cr>\nnmap <leader>f :find<cr>\n\n\"去空行  \nnnoremap <F2> :g/^\\s*$/d<CR> \n\n\"比较文件  \nnnoremap <C-F2> :vert diffsplit \n\n\"新建标签  \nmap <M-F2> :tabnew<CR>  \n\n\"列出当前目录文件  \nmap <F3> :tabnew .<CR>  \n\n\"打开树状文件目录  \nmap <C-F3> \\be  \n\n\n\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\n\"\"实用设置\n\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\n\n\" 设置当文件被改动时自动载入\nset autoread\n\n\" quickfix模式\nautocmd FileType c,cpp map <buffer> <leader><space> :w<cr>:make<cr>\n\n\"代码补全 \nset completeopt=preview,menu \n\n\"允许插件  \nfiletype plugin on\n\n\"共享剪贴板  \nset clipboard+=unnamed \n\n\"从不备份  \nset nobackup\n\n\"make 运行\n:set makeprg=g++\\ -Wall\\ \\ %\n\n\"自动保存\nset autowrite\nset ruler                   \" 打开状态栏标尺\nset cursorline              \" 突出显示当前行\nset magic                   \" 设置魔术\nset guioptions-=T           \" 隐藏工具栏\nset guioptions-=m           \" 隐藏菜单栏\n\n\"set statusline=\\ %<%F[%1*%M%*%n%R%H]%=\\ %y\\ %0(%{&fileformat}\\ %{&encoding}\\ %c:%l/%L%)\\\n\" 设置在状态行显示的信息\nset foldcolumn=0\nset foldmethod=indent \n\n\" 不要使用vi的键盘模式，而是vim自己的\nset nocompatible\n\n\" 语法高亮\nset syntax=on\n\n\" 去掉输入错误的提示声音\nset noeb\n\n\" 在处理未保存或只读文件的时候，弹出确认\nset confirm\n\n\" 自动缩进\nset autoindent\nset cindent\n\n\" Tab键的宽度\nset tabstop=4\n\n\" 统一缩进为4\nset softtabstop=4\nset shiftwidth=4\n\n\" 不要用空格代替制表符\nset noexpandtab\n\n\" 在行和段开始处使用制表符\nset smarttab\n\n\" 显示行号\nset number\n\n\" 历史记录数\nset history=1000\n\n\"禁止生成临时文件\nset nobackup\nset noswapfile\n\n\"搜索忽略大小写\nset ignorecase\n\n\"搜索逐字符高亮\nset hlsearch\nset incsearch\n\n\"行内替换\nset gdefault\n\n\"编码设置\nset enc=utf-8\nset fencs=utf-8,ucs-bom,shift-jis,gb18030,gbk,gb2312,cp936\n\n\"语言设置\nset langmenu=zh_CN.UTF-8\nset helplang=cn\n\n\" 我的状态行显示的内容（包括文件类型和解码）\n\"set statusline=%F%m%r%h%w\\ [FORMAT=%{&ff}]\\ [TYPE=%Y]\\ [POS=%l,%v][%p%%]\\ %{strftime(\\\"%d/%m/%y\\ -\\ %H:%M\\\")}\n\"set statusline=[%F]%y%r%m%*%=[Line:%l/%L,Column:%c][%p%%]\n\n\" 总是显示状态行\nset laststatus=2\n\n\" 命令行（在状态行下）的高度，默认为1，这里是2\nset cmdheight=2\n\n\" 侦测文件类型\nfiletype on\n\n\" 载入文件类型插件\nfiletype plugin on\n\n\" 为特定文件类型载入相关缩进文件\nfiletype indent on\n\n\" 保存全局变量\nset viminfo+=!\n\n\" 带有如下符号的单词不要被换行分割\nset iskeyword+=_,$,@,%,#,-\n\n\" 字符间插入的像素行数目\nset linespace=0\n\n\" 通过使用: commands命令，告诉我们文件的哪一行被改变过\nset report=0\n\n\" 在被分割的窗口间显示空白，便于阅读\nset fillchars=vert:\\ ,stl:\\ ,stlnc:\\\n\n\" 高亮显示匹配的括号\nset showmatch\n\n\" 匹配括号高亮的时间（单位是十分之一秒）\nset matchtime=1\n\n\" 光标移动到buffer的顶部和底部时保持3行距离\nset scrolloff=3\n\n\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\n\" CTags的设定  \n\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\n\nlet Tlist_Sort_Type = \"name\"    \" 按照名称排序  \nlet Tlist_Use_Right_Window = 1  \" 在右侧显示窗口  \nlet Tlist_Compart_Format = 1    \" 压缩方式  \nlet Tlist_Exist_OnlyWindow = 1  \" 如果只有一个buffer，kill窗口也kill掉buffer  \nlet Tlist_File_Fold_Auto_Close = 0  \" 不要关闭其他文件的tags  \nlet Tlist_Enable_Fold_Column = 0    \" 不要显示折叠树  \n\"let Tlist_Show_One_File=1            \"不同时显示多个文件的tag，只显示当前文件的\n\n\"设置tags  \nset tags=tags  \n\"set autochdir \n\n\n\"默认打开Taglist \nlet Tlist_Auto_Open=1 \n\n\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\" \n\" Tag list (ctags) \n\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\" \n\nlet Tlist_Ctags_Cmd = '/usr/bin/ctags' \nlet Tlist_Show_One_File = 1 \"不同时显示多个文件的tag，只显示当前文件的 \nlet Tlist_Exit_OnlyWindow = 1 \"如果taglist窗口是最后一个窗口，则退出vim \nlet Tlist_Use_Right_Window = 1 \"在右侧窗口中显示taglist窗口\n\n\" minibufexpl插件的一般设置\nlet g:miniBufExplMapWindowNavVim = 1\n\nlet g:miniBufExplMapWindowNavArrows = 1\n\nlet g:miniBufExplMapCTabSwitchBufs = 1\nlet g:miniBufExplModSelTarget = 1\n```\n\n# 其他命令 \n[点击跳转](https://kjh123.github.io/2018/06/27/Linux%E5%91%BD%E4%BB%A4%E5%AD%A6%E4%B9%A0/)\n\n","source":"_posts/即书服务器搭建记录.md","raw":"---\ntitle: 即书服务器搭建记录\ndate: 2018-06-22 11:35:38\ntags: [记录, 服务器, Ubuntu]\ncategories: Linux\n---\n<blockquote class=\"blockquote-center\">学而践行之</blockquote>\n\n<!--more-->\n\n服务器环境： *Ubuntu: V16.04*\n\n# 软件列表\n\n | 环境 | 版本 |\n | -------- | -------- |\n | Nginx    | V1.10.3  |\n | PHP      | V7.1.18 |\n | MySQL    | V5.7.22 |\n | Redis    | V3.1.6  |\n | Git      | V2.7.4 |\n | libreoffice| V5.4  |\n | inkscape | -  |\n | lrzsz    | V0.12.21-8 |\n | tmux     | V2.1.3  |\n \n# 准备\n> 更新软件源为阿里源\n```bash :/etc/apt/source.list\n    # 备份\n    sudo cp /etc/apt/sources.list /etc/apt/sources.list.old\n    \n    # vim: /etc/apt/source.list\n    # deb cdrom:[Ubuntu 16.04 LTS _Xenial Xerus_ - Release amd64 (20160420.1)]/ xenial main restricted\n    deb-src http://archive.ubuntu.com/ubuntu xenial main restricted #Added by software-properties\n    deb http://mirrors.aliyun.com/ubuntu/ xenial main restricted\n    deb-src http://mirrors.aliyun.com/ubuntu/ xenial main restricted multiverse universe #Added by software-properties\n    deb http://mirrors.aliyun.com/ubuntu/ xenial-updates main restricted\n    deb-src http://mirrors.aliyun.com/ubuntu/ xenial-updates main restricted multiverse universe #Added by software-properties\n    deb http://mirrors.aliyun.com/ubuntu/ xenial universe\n    deb http://mirrors.aliyun.com/ubuntu/ xenial-updates universe\n    deb http://mirrors.aliyun.com/ubuntu/ xenial multiverse\n    deb http://mirrors.aliyun.com/ubuntu/ xenial-updates multiverse\n    deb http://mirrors.aliyun.com/ubuntu/ xenial-backports main restricted universe multiverse\n    deb-src http://mirrors.aliyun.com/ubuntu/ xenial-backports main restricted universe multiverse #Added by software-properties\n    deb http://archive.canonical.com/ubuntu xenial partner\n    deb-src http://archive.canonical.com/ubuntu xenial partner\n    deb http://mirrors.aliyun.com/ubuntu/ xenial-security main restricted\n    deb-src http://mirrors.aliyun.com/ubuntu/ xenial-security main restricted multiverse universe #Added by software-properties\n    deb http://mirrors.aliyun.com/ubuntu/ xenial-security universe\n    deb http://mirrors.aliyun.com/ubuntu/ xenial-security multiverse\n    \n    # 执行更新\n    sudo apt-get update\n```\n\n```shell :#@Ubuntu:>_ line_number:false\n    sudo apt-add-repository ppa:ondrej/php   # 添加 PHP 软件源\n    sudo add-apt-repository ppa:libreoffice/libreoffice-5-4    # 添加 Libreoffice5.4 软件源\n    报错则执行：\n        1. sudo apt-get install python-software-properties\n        2. sudo apt-get install software-properties-common\n    \n    sudo apt-get update    # 更新软件源\n```\n\n-----\n\n# 安装 Web 服务器环境\n [Nginx](#Nginx), [PHP](#PHP), [MySql](#MySql)\n\n## Nginx\n直接命令安装：`sudo apt-get install nginx` \n启动 Nginx ：`sudo service nginx start`\n\n>相关命令：\n- netstat -anp | grep nginx    查看Nginx进程\n- lsof -i:80                   查看80端口状态\n    \n## PHP\n命令安装：`sudo apt-get install php7.1`\n安装fpm：`sudo apt-get install php7.1-fpm`\n\n>相关命令：\n- php -v  安装完后检查\n- php -m  已安装的 PHP 模块\n\n## MySql\n命令安装：`apt-get install mysql-server mysql-client php7.1-mysql`\n> 在安装过程中会提示输入 root 用户的登录密码\n\n## Nginx 解析 PHP \n>PHP-FPM 与 Nginx 通信方式有两种，一种是基于TCP的 Internet domain socket 方式，一种是 UNIX domain socket 方式。 推荐使用第二种连接方式 Socket 路径为：/run/php/php7.1-fpm.sock\n\n```nginx :nginx.conf\n    location ~ \\.php$ {\n        include snippets/fastcgi-php.conf;\n        # With php7.0-cgi alone:\n        # fastcgi_pass 127.0.0.1:9000;\n        # With php7.0-fpm:\n        fastcgi_pass unix:/run/php/php7.1-fpm.sock;\n        fastcgi_index  index.php;\n        fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;\n        include        fastcgi_params;\n    }\n```\n\n```ini :/etc/php/7.1/fpm/pool.d/www.conf\n    ; 与 Nginx监听同一个 sock\n    listen = /run/php/php7.1-fpm.sock\n```\n## Redis 的安装\n```bash\n# 先安装 redis-server 和 redis-tools, 以及 编译PHP扩展包工具\nsudo apt-get install redis-server redis-tools php7.1-dev\n\n# 安装 php-redis 扩展 依次执行\nphpize7.1\n./configure --with-php-config=/usr/bin/php-config\nmake\nsudo make install\n\n# 安装完成后添加 扩展\necho \"extension=redis.so\" >> /etc/php/7.1/mods-available/redis.ini\nsudo ln -s /etc/php/7.1/mods-available/redis.ini /etc/php/7.1/cli/conf.d/20-redis.ini\nsudo ln -s /etc/php/7.1/mods-available/redis.ini /etc/php/7.1/fpm/conf.d/20-redis.ini\n```\n\n# 应用软件\n1. sudo apt-get install libreoffice   # 开源办公套件\n> eg： 将 word/ppt/excel 转换为 pdf ： `libreoffice  --invisible --convert-to pdf  demo.docx  `\n    \n2. sudo apt-get install inksacpe      # 矢量图转换工具\n> eg： 将 emf 转换为 png ： `inkscape -e output.png input.emf`\n\n3. sudo apt-get install lrzsz         # linux 快速传输工具\n> eg： 上传文件 `rz`， 下载文件 `sz filename`\n\n4. sudo apt-get install git           \n\n# 其他配置\n\n## tmux 配置\n\n```ini :~/.tmux.conf url:https://gitee.com/kongvip/config/blob/master/tmux.config 链接地址\n# 设置前缀为Ctrl + a\nset -g prefix C-x\n\n#解除Ctrl+b 与前缀的对应关系\nunbind C-b\n\n## 切换面板\n#up\nbind-key k select-pane -U\n#down\nbind-key j select-pane -D\n#left\nbind-key h select-pane -L\n#right\nbind-key l select-pane -R\n```\n\n## vim 配置\n\n```vim :~/.vimrc url:https://gitee.com/kongvip/config/blob/master/vimrc 链接地址\n\n\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\n\" 显示相关  \n\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\n\n\"set shortmess=atI   \" 启动的时候不显示那个援助乌干达儿童的提示  \n\"winpos 5 5          \" 设定窗口位置  \n\"set lines=40 columns=155    \" 设定窗口大小  \n\"set nu              \" 显示行号  \nset go=              \" 不要图形按钮  \n\"color asmanian2     \" 设置背景主题  \n\"syntax on           \" 语法高亮  \nautocmd InsertLeave * se nocul  \" 用浅色高亮当前行  \nautocmd InsertEnter * se cul    \" 用浅色高亮当前行  \n\"set ruler           \" 显示标尺  \nset showcmd         \" 输入的命令显示出来，看的清楚些  \n\"set cmdheight=1     \" 命令行（在状态行下）的高度，设置为1  \n\"set whichwrap+=<,>,h,l   \" 允许backspace和光标键跨越行边界(不建议)  \n\"set scrolloff=3     \" 光标移动到buffer的顶部和底部时保持3行距离  \n\nset statusline=%F%m%r%h%w\\ [FORMAT=%{&ff}]\\ [TYPE=%Y]\\ [POS=%l,%v][%p%%]\\ %{strftime(\\\"%d/%m/%y\\ -\\ %H:%M\\\")}   \"状态行显示的内容  \nset laststatus=1    \" 启动显示状态行(1),总是显示状态行(2)  \nset foldenable      \" 允许折叠  \nset foldmethod=manual   \" 手动折叠  \n\"set background=dark \"背景使用黑色 \nset nocompatible  \"去掉讨厌的有关vi一致性模式，避免以前版本的一些bug和局限  \n\n\" 显示中文帮助\nif version >= 603\n    set helplang=cn\n    set encoding=utf-8\nendif\n\n\" 设置配色方案\n\"colorscheme murphy\n\nset fencs=utf-8,ucs-bom,shift-jis,gb18030,gbk,gb2312,cp936\nset termencoding=utf-8\nset encoding=utf-8\nset fileencodings=ucs-bom,utf-8,cp936\nset fileencoding=utf-8\n\n\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\n\"\"\"\"\"新文件标题\n\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\n\n\"新建.c,.h,.sh,.java文件，自动插入文件头 \nautocmd BufNewFile *.cpp,*.[ch],*.sh,*.java exec \":call SetTitle()\" \n\n\"\"定义函数SetTitle，自动插入文件头 \nfunc SetTitle() \n    \"如果文件类型为.sh文件 \n    if &filetype == 'sh' \n        call setline(1,\"\\#########################################################################\") \n        call append(line(\".\"), \"\\# File Name: \".expand(\"%\")) \n        call append(line(\".\")+3, \"\\# Created Time: \".strftime(\"%c\")) \n        call append(line(\".\")+4, \"\\#########################################################################\") \n        call append(line(\".\")+5, \"\\#!/bin/bash\") \n        call append(line(\".\")+6, \"\") \n    else \n        call setline(1, \"/*************************************************************************\") \n        call append(line(\".\"), \"    > File Name: \".expand(\"%\")) \n        call append(line(\".\")+3, \"    > Created Time: \".strftime(\"%c\")) \n        call append(line(\".\")+4, \" ************************************************************************/\") \n        call append(line(\".\")+5, \"\")\n    endif\n\n    if &filetype == 'cpp'\n        call append(line(\".\")+6, \"#include<iostream>\")\n        call append(line(\".\")+7, \"using namespace std;\")\n        call append(line(\".\")+8, \"\")\n    endif\n\n    if &filetype == 'c'\n        call append(line(\".\")+6, \"#include<stdio.h>\")\n        call append(line(\".\")+7, \"\")\n    endif\n    \"新建文件后，自动定位到文件末尾\n    autocmd BufNewFile * normal G\nendfunc \n\n\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\n\"键盘命令\n\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\n\nnmap <leader>w :w!<cr>\nnmap <leader>f :find<cr>\n\n\"去空行  \nnnoremap <F2> :g/^\\s*$/d<CR> \n\n\"比较文件  \nnnoremap <C-F2> :vert diffsplit \n\n\"新建标签  \nmap <M-F2> :tabnew<CR>  \n\n\"列出当前目录文件  \nmap <F3> :tabnew .<CR>  \n\n\"打开树状文件目录  \nmap <C-F3> \\be  \n\n\n\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\n\"\"实用设置\n\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\n\n\" 设置当文件被改动时自动载入\nset autoread\n\n\" quickfix模式\nautocmd FileType c,cpp map <buffer> <leader><space> :w<cr>:make<cr>\n\n\"代码补全 \nset completeopt=preview,menu \n\n\"允许插件  \nfiletype plugin on\n\n\"共享剪贴板  \nset clipboard+=unnamed \n\n\"从不备份  \nset nobackup\n\n\"make 运行\n:set makeprg=g++\\ -Wall\\ \\ %\n\n\"自动保存\nset autowrite\nset ruler                   \" 打开状态栏标尺\nset cursorline              \" 突出显示当前行\nset magic                   \" 设置魔术\nset guioptions-=T           \" 隐藏工具栏\nset guioptions-=m           \" 隐藏菜单栏\n\n\"set statusline=\\ %<%F[%1*%M%*%n%R%H]%=\\ %y\\ %0(%{&fileformat}\\ %{&encoding}\\ %c:%l/%L%)\\\n\" 设置在状态行显示的信息\nset foldcolumn=0\nset foldmethod=indent \n\n\" 不要使用vi的键盘模式，而是vim自己的\nset nocompatible\n\n\" 语法高亮\nset syntax=on\n\n\" 去掉输入错误的提示声音\nset noeb\n\n\" 在处理未保存或只读文件的时候，弹出确认\nset confirm\n\n\" 自动缩进\nset autoindent\nset cindent\n\n\" Tab键的宽度\nset tabstop=4\n\n\" 统一缩进为4\nset softtabstop=4\nset shiftwidth=4\n\n\" 不要用空格代替制表符\nset noexpandtab\n\n\" 在行和段开始处使用制表符\nset smarttab\n\n\" 显示行号\nset number\n\n\" 历史记录数\nset history=1000\n\n\"禁止生成临时文件\nset nobackup\nset noswapfile\n\n\"搜索忽略大小写\nset ignorecase\n\n\"搜索逐字符高亮\nset hlsearch\nset incsearch\n\n\"行内替换\nset gdefault\n\n\"编码设置\nset enc=utf-8\nset fencs=utf-8,ucs-bom,shift-jis,gb18030,gbk,gb2312,cp936\n\n\"语言设置\nset langmenu=zh_CN.UTF-8\nset helplang=cn\n\n\" 我的状态行显示的内容（包括文件类型和解码）\n\"set statusline=%F%m%r%h%w\\ [FORMAT=%{&ff}]\\ [TYPE=%Y]\\ [POS=%l,%v][%p%%]\\ %{strftime(\\\"%d/%m/%y\\ -\\ %H:%M\\\")}\n\"set statusline=[%F]%y%r%m%*%=[Line:%l/%L,Column:%c][%p%%]\n\n\" 总是显示状态行\nset laststatus=2\n\n\" 命令行（在状态行下）的高度，默认为1，这里是2\nset cmdheight=2\n\n\" 侦测文件类型\nfiletype on\n\n\" 载入文件类型插件\nfiletype plugin on\n\n\" 为特定文件类型载入相关缩进文件\nfiletype indent on\n\n\" 保存全局变量\nset viminfo+=!\n\n\" 带有如下符号的单词不要被换行分割\nset iskeyword+=_,$,@,%,#,-\n\n\" 字符间插入的像素行数目\nset linespace=0\n\n\" 通过使用: commands命令，告诉我们文件的哪一行被改变过\nset report=0\n\n\" 在被分割的窗口间显示空白，便于阅读\nset fillchars=vert:\\ ,stl:\\ ,stlnc:\\\n\n\" 高亮显示匹配的括号\nset showmatch\n\n\" 匹配括号高亮的时间（单位是十分之一秒）\nset matchtime=1\n\n\" 光标移动到buffer的顶部和底部时保持3行距离\nset scrolloff=3\n\n\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\n\" CTags的设定  \n\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\n\nlet Tlist_Sort_Type = \"name\"    \" 按照名称排序  \nlet Tlist_Use_Right_Window = 1  \" 在右侧显示窗口  \nlet Tlist_Compart_Format = 1    \" 压缩方式  \nlet Tlist_Exist_OnlyWindow = 1  \" 如果只有一个buffer，kill窗口也kill掉buffer  \nlet Tlist_File_Fold_Auto_Close = 0  \" 不要关闭其他文件的tags  \nlet Tlist_Enable_Fold_Column = 0    \" 不要显示折叠树  \n\"let Tlist_Show_One_File=1            \"不同时显示多个文件的tag，只显示当前文件的\n\n\"设置tags  \nset tags=tags  \n\"set autochdir \n\n\n\"默认打开Taglist \nlet Tlist_Auto_Open=1 \n\n\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\" \n\" Tag list (ctags) \n\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\" \n\nlet Tlist_Ctags_Cmd = '/usr/bin/ctags' \nlet Tlist_Show_One_File = 1 \"不同时显示多个文件的tag，只显示当前文件的 \nlet Tlist_Exit_OnlyWindow = 1 \"如果taglist窗口是最后一个窗口，则退出vim \nlet Tlist_Use_Right_Window = 1 \"在右侧窗口中显示taglist窗口\n\n\" minibufexpl插件的一般设置\nlet g:miniBufExplMapWindowNavVim = 1\n\nlet g:miniBufExplMapWindowNavArrows = 1\n\nlet g:miniBufExplMapCTabSwitchBufs = 1\nlet g:miniBufExplModSelTarget = 1\n```\n\n# 其他命令 \n[点击跳转](https://kjh123.github.io/2018/06/27/Linux%E5%91%BD%E4%BB%A4%E5%AD%A6%E4%B9%A0/)\n\n","slug":"即书服务器搭建记录","published":1,"updated":"2018-11-21T07:12:34.518Z","_id":"cjopirm6v000i2cwmhn8m1546","comments":1,"layout":"post","photos":[],"link":"","content":"<blockquote class=\"blockquote-center\">学而践行之</blockquote>\n\n<a id=\"more\"></a>\n<p>服务器环境： <em>Ubuntu: V16.04</em></p>\n<h1 id=\"软件列表\"><a href=\"#软件列表\" class=\"headerlink\" title=\"软件列表\"></a>软件列表</h1><table>\n<thead>\n<tr>\n<th>环境</th>\n<th>版本</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Nginx</td>\n<td>V1.10.3</td>\n</tr>\n<tr>\n<td>PHP</td>\n<td>V7.1.18</td>\n</tr>\n<tr>\n<td>MySQL</td>\n<td>V5.7.22</td>\n</tr>\n<tr>\n<td>Redis</td>\n<td>V3.1.6</td>\n</tr>\n<tr>\n<td>Git</td>\n<td>V2.7.4</td>\n</tr>\n<tr>\n<td>libreoffice</td>\n<td>V5.4</td>\n</tr>\n<tr>\n<td>inkscape</td>\n<td>-</td>\n</tr>\n<tr>\n<td>lrzsz</td>\n<td>V0.12.21-8</td>\n</tr>\n<tr>\n<td>tmux</td>\n<td>V2.1.3</td>\n</tr>\n</tbody>\n</table>\n<h1 id=\"准备\"><a href=\"#准备\" class=\"headerlink\" title=\"准备\"></a>准备</h1><blockquote>\n<p>更新软件源为阿里源<br><figure class=\"highlight bash\"><figcaption><span class=\"fileDir\">/etc/apt/</span><span class=\"caption\">source</span><span class=\"suffix\">.list</span></figcaption><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div></pre></div><div class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># 备份</span></div><div class=\"line\">sudo cp /etc/apt/sources.list /etc/apt/sources.list.old</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># vim: /etc/apt/source.list</span></div><div class=\"line\"><span class=\"comment\"># deb cdrom:[Ubuntu 16.04 LTS _Xenial Xerus_ - Release amd64 (20160420.1)]/ xenial main restricted</span></div><div class=\"line\">deb-src http://archive.ubuntu.com/ubuntu xenial main restricted <span class=\"comment\">#Added by software-properties</span></div><div class=\"line\">deb http://mirrors.aliyun.com/ubuntu/ xenial main restricted</div><div class=\"line\">deb-src http://mirrors.aliyun.com/ubuntu/ xenial main restricted multiverse universe <span class=\"comment\">#Added by software-properties</span></div><div class=\"line\">deb http://mirrors.aliyun.com/ubuntu/ xenial-updates main restricted</div><div class=\"line\">deb-src http://mirrors.aliyun.com/ubuntu/ xenial-updates main restricted multiverse universe <span class=\"comment\">#Added by software-properties</span></div><div class=\"line\">deb http://mirrors.aliyun.com/ubuntu/ xenial universe</div><div class=\"line\">deb http://mirrors.aliyun.com/ubuntu/ xenial-updates universe</div><div class=\"line\">deb http://mirrors.aliyun.com/ubuntu/ xenial multiverse</div><div class=\"line\">deb http://mirrors.aliyun.com/ubuntu/ xenial-updates multiverse</div><div class=\"line\">deb http://mirrors.aliyun.com/ubuntu/ xenial-backports main restricted universe multiverse</div><div class=\"line\">deb-src http://mirrors.aliyun.com/ubuntu/ xenial-backports main restricted universe multiverse <span class=\"comment\">#Added by software-properties</span></div><div class=\"line\">deb http://archive.canonical.com/ubuntu xenial partner</div><div class=\"line\">deb-src http://archive.canonical.com/ubuntu xenial partner</div><div class=\"line\">deb http://mirrors.aliyun.com/ubuntu/ xenial-security main restricted</div><div class=\"line\">deb-src http://mirrors.aliyun.com/ubuntu/ xenial-security main restricted multiverse universe <span class=\"comment\">#Added by software-properties</span></div><div class=\"line\">deb http://mirrors.aliyun.com/ubuntu/ xenial-security universe</div><div class=\"line\">deb http://mirrors.aliyun.com/ubuntu/ xenial-security multiverse</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 执行更新</span></div><div class=\"line\">sudo apt-get update</div></pre></div></div></figure></p>\n</blockquote>\n<figure class=\"highlight shell\"><figcaption><span class=\"caption\">#@Ubuntu:>_</span></figcaption><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\">sudo apt-add-repository ppa:ondrej/php   # 添加 PHP 软件源</div><div class=\"line\">sudo add-apt-repository ppa:libreoffice/libreoffice-5-4    # 添加 Libreoffice5.4 软件源</div><div class=\"line\">报错则执行：</div><div class=\"line\">    1. sudo apt-get install python-software-properties</div><div class=\"line\">    2. sudo apt-get install software-properties-common</div><div class=\"line\"></div><div class=\"line\">sudo apt-get update    # 更新软件源</div></pre></div></div></figure>\n<hr>\n<h1 id=\"安装-Web-服务器环境\"><a href=\"#安装-Web-服务器环境\" class=\"headerlink\" title=\"安装 Web 服务器环境\"></a>安装 Web 服务器环境</h1><p> <a href=\"#Nginx\">Nginx</a>, <a href=\"#PHP\">PHP</a>, <a href=\"#MySql\">MySql</a></p>\n<h2 id=\"Nginx\"><a href=\"#Nginx\" class=\"headerlink\" title=\"Nginx\"></a>Nginx</h2><p>直接命令安装：<code>sudo apt-get install nginx</code><br>启动 Nginx ：<code>sudo service nginx start</code></p>\n<blockquote>\n<p>相关命令：</p>\n<ul>\n<li>netstat -anp | grep nginx    查看Nginx进程</li>\n<li>lsof -i:80                   查看80端口状态</li>\n</ul>\n</blockquote>\n<h2 id=\"PHP\"><a href=\"#PHP\" class=\"headerlink\" title=\"PHP\"></a>PHP</h2><p>命令安装：<code>sudo apt-get install php7.1</code><br>安装fpm：<code>sudo apt-get install php7.1-fpm</code></p>\n<blockquote>\n<p>相关命令：</p>\n<ul>\n<li>php -v  安装完后检查</li>\n<li>php -m  已安装的 PHP 模块</li>\n</ul>\n</blockquote>\n<h2 id=\"MySql\"><a href=\"#MySql\" class=\"headerlink\" title=\"MySql\"></a>MySql</h2><p>命令安装：<code>apt-get install mysql-server mysql-client php7.1-mysql</code></p>\n<blockquote>\n<p>在安装过程中会提示输入 root 用户的登录密码</p>\n</blockquote>\n<h2 id=\"Nginx-解析-PHP\"><a href=\"#Nginx-解析-PHP\" class=\"headerlink\" title=\"Nginx 解析 PHP\"></a>Nginx 解析 PHP</h2><blockquote>\n<p>PHP-FPM 与 Nginx 通信方式有两种，一种是基于TCP的 Internet domain socket 方式，一种是 UNIX domain socket 方式。 推荐使用第二种连接方式 Socket 路径为：/run/php/php7.1-fpm.sock</p>\n</blockquote>\n<figure class=\"highlight nginx\"><figcaption><span class=\"caption\">nginx</span><span class=\"suffix\">.conf</span></figcaption><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></div><div class=\"code\"><pre><div class=\"line\"><span class=\"attribute\">location</span> <span class=\"regexp\">~ \\.php$</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">include</span> snippets/fastcgi-php.conf;</div><div class=\"line\">    <span class=\"comment\"># With php7.0-cgi alone:</span></div><div class=\"line\">    <span class=\"comment\"># fastcgi_pass 127.0.0.1:9000;</span></div><div class=\"line\">    <span class=\"comment\"># With php7.0-fpm:</span></div><div class=\"line\">    <span class=\"attribute\">fastcgi_pass</span> unix:/run/php/php7.1-fpm.sock;</div><div class=\"line\">    <span class=\"attribute\">fastcgi_index</span>  index.php;</div><div class=\"line\">    <span class=\"attribute\">fastcgi_param</span>  SCRIPT_FILENAME  <span class=\"variable\">$document_root</span><span class=\"variable\">$fastcgi_script_name</span>;</div><div class=\"line\">    <span class=\"attribute\">include</span>        fastcgi_params;</div><div class=\"line\">&#125;</div></pre></div></div></figure>\n<figure class=\"highlight ini\"><figcaption><span class=\"fileDir\">/etc/php/7.1/fpm/pool.d/</span><span class=\"caption\">www</span><span class=\"suffix\">.conf</span></figcaption><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></div><div class=\"code\"><pre><div class=\"line\"><span class=\"comment\">; 与 Nginx监听同一个 sock</span></div><div class=\"line\"><span class=\"attr\">listen</span> = /run/php/php7.<span class=\"number\">1</span>-fpm.sock</div></pre></div></div></figure>\n<h2 id=\"Redis-的安装\"><a href=\"#Redis-的安装\" class=\"headerlink\" title=\"Redis 的安装\"></a>Redis 的安装</h2><figure class=\"highlight bash\"><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></div><div class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># 先安装 redis-server 和 redis-tools, 以及 编译PHP扩展包工具</span></div><div class=\"line\">sudo apt-get install redis-server redis-tools php7.1-dev</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 安装 php-redis 扩展 依次执行</span></div><div class=\"line\">phpize7.1</div><div class=\"line\">./configure --with-php-config=/usr/bin/php-config</div><div class=\"line\">make</div><div class=\"line\">sudo make install</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 安装完成后添加 扩展</span></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"extension=redis.so\"</span> &gt;&gt; /etc/php/7.1/mods-available/redis.ini</div><div class=\"line\">sudo ln -s /etc/php/7.1/mods-available/redis.ini /etc/php/7.1/cli/conf.d/20-redis.ini</div><div class=\"line\">sudo ln -s /etc/php/7.1/mods-available/redis.ini /etc/php/7.1/fpm/conf.d/20-redis.ini</div></pre></div></div></figure>\n<h1 id=\"应用软件\"><a href=\"#应用软件\" class=\"headerlink\" title=\"应用软件\"></a>应用软件</h1><ol>\n<li><p>sudo apt-get install libreoffice   # 开源办公套件</p>\n<blockquote>\n<p>eg： 将 word/ppt/excel 转换为 pdf ： <code>libreoffice  --invisible --convert-to pdf  demo.docx</code></p>\n</blockquote>\n</li>\n<li><p>sudo apt-get install inksacpe      # 矢量图转换工具</p>\n<blockquote>\n<p>eg： 将 emf 转换为 png ： <code>inkscape -e output.png input.emf</code></p>\n</blockquote>\n</li>\n<li><p>sudo apt-get install lrzsz         # linux 快速传输工具</p>\n<blockquote>\n<p>eg： 上传文件 <code>rz</code>， 下载文件 <code>sz filename</code></p>\n</blockquote>\n</li>\n<li><p>sudo apt-get install git           </p>\n</li>\n</ol>\n<h1 id=\"其他配置\"><a href=\"#其他配置\" class=\"headerlink\" title=\"其他配置\"></a>其他配置</h1><h2 id=\"tmux-配置\"><a href=\"#tmux-配置\" class=\"headerlink\" title=\"tmux 配置\"></a>tmux 配置</h2><figure class=\"highlight\"><figcaption><span class=\"fileDir\">~/</span><span class=\"caption\">.tmux</span><span class=\"suffix\">.conf</span><a href=\"https://gitee.com/kongvip/config/blob/master/tmux.config\" target=\"_blank\">链接地址</a></figcaption><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></div><div class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># 设置前缀为Ctrl + a</span></div><div class=\"line\">set -g prefix C-x</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#解除Ctrl+b 与前缀的对应关系</span></div><div class=\"line\">unbind C-b</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">## 切换面板</span></div><div class=\"line\"><span class=\"comment\">#up</span></div><div class=\"line\">bind-key k select-pane -U</div><div class=\"line\"><span class=\"comment\">#down</span></div><div class=\"line\">bind-key j select-pane -D</div><div class=\"line\"><span class=\"comment\">#left</span></div><div class=\"line\">bind-key h select-pane -L</div><div class=\"line\"><span class=\"comment\">#right</span></div><div class=\"line\">bind-key l select-pane -R</div></pre></div></div></figure>\n<h2 id=\"vim-配置\"><a href=\"#vim-配置\" class=\"headerlink\" title=\"vim 配置\"></a>vim 配置</h2><figure class=\"highlight vim\"><figcaption><span class=\"fileDir\">~/</span><span class=\"caption\">.vimrc</span><a href=\"https://gitee.com/kongvip/config/blob/master/vimrc\" target=\"_blank\">链接地址</a></figcaption><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div><div class=\"line\">117</div><div class=\"line\">118</div><div class=\"line\">119</div><div class=\"line\">120</div><div class=\"line\">121</div><div class=\"line\">122</div><div class=\"line\">123</div><div class=\"line\">124</div><div class=\"line\">125</div><div class=\"line\">126</div><div class=\"line\">127</div><div class=\"line\">128</div><div class=\"line\">129</div><div class=\"line\">130</div><div class=\"line\">131</div><div class=\"line\">132</div><div class=\"line\">133</div><div class=\"line\">134</div><div class=\"line\">135</div><div class=\"line\">136</div><div class=\"line\">137</div><div class=\"line\">138</div><div class=\"line\">139</div><div class=\"line\">140</div><div class=\"line\">141</div><div class=\"line\">142</div><div class=\"line\">143</div><div class=\"line\">144</div><div class=\"line\">145</div><div class=\"line\">146</div><div class=\"line\">147</div><div class=\"line\">148</div><div class=\"line\">149</div><div class=\"line\">150</div><div class=\"line\">151</div><div class=\"line\">152</div><div class=\"line\">153</div><div class=\"line\">154</div><div class=\"line\">155</div><div class=\"line\">156</div><div class=\"line\">157</div><div class=\"line\">158</div><div class=\"line\">159</div><div class=\"line\">160</div><div class=\"line\">161</div><div class=\"line\">162</div><div class=\"line\">163</div><div class=\"line\">164</div><div class=\"line\">165</div><div class=\"line\">166</div><div class=\"line\">167</div><div class=\"line\">168</div><div class=\"line\">169</div><div class=\"line\">170</div><div class=\"line\">171</div><div class=\"line\">172</div><div class=\"line\">173</div><div class=\"line\">174</div><div class=\"line\">175</div><div class=\"line\">176</div><div class=\"line\">177</div><div class=\"line\">178</div><div class=\"line\">179</div><div class=\"line\">180</div><div class=\"line\">181</div><div class=\"line\">182</div><div class=\"line\">183</div><div class=\"line\">184</div><div class=\"line\">185</div><div class=\"line\">186</div><div class=\"line\">187</div><div class=\"line\">188</div><div class=\"line\">189</div><div class=\"line\">190</div><div class=\"line\">191</div><div class=\"line\">192</div><div class=\"line\">193</div><div class=\"line\">194</div><div class=\"line\">195</div><div class=\"line\">196</div><div class=\"line\">197</div><div class=\"line\">198</div><div class=\"line\">199</div><div class=\"line\">200</div><div class=\"line\">201</div><div class=\"line\">202</div><div class=\"line\">203</div><div class=\"line\">204</div><div class=\"line\">205</div><div class=\"line\">206</div><div class=\"line\">207</div><div class=\"line\">208</div><div class=\"line\">209</div><div class=\"line\">210</div><div class=\"line\">211</div><div class=\"line\">212</div><div class=\"line\">213</div><div class=\"line\">214</div><div class=\"line\">215</div><div class=\"line\">216</div><div class=\"line\">217</div><div class=\"line\">218</div><div class=\"line\">219</div><div class=\"line\">220</div><div class=\"line\">221</div><div class=\"line\">222</div><div class=\"line\">223</div><div class=\"line\">224</div><div class=\"line\">225</div><div class=\"line\">226</div><div class=\"line\">227</div><div class=\"line\">228</div><div class=\"line\">229</div><div class=\"line\">230</div><div class=\"line\">231</div><div class=\"line\">232</div><div class=\"line\">233</div><div class=\"line\">234</div><div class=\"line\">235</div><div class=\"line\">236</div><div class=\"line\">237</div><div class=\"line\">238</div><div class=\"line\">239</div><div class=\"line\">240</div><div class=\"line\">241</div><div class=\"line\">242</div><div class=\"line\">243</div><div class=\"line\">244</div><div class=\"line\">245</div><div class=\"line\">246</div><div class=\"line\">247</div><div class=\"line\">248</div><div class=\"line\">249</div><div class=\"line\">250</div><div class=\"line\">251</div><div class=\"line\">252</div><div class=\"line\">253</div><div class=\"line\">254</div><div class=\"line\">255</div><div class=\"line\">256</div><div class=\"line\">257</div><div class=\"line\">258</div><div class=\"line\">259</div><div class=\"line\">260</div><div class=\"line\">261</div><div class=\"line\">262</div><div class=\"line\">263</div><div class=\"line\">264</div><div class=\"line\">265</div><div class=\"line\">266</div><div class=\"line\">267</div><div class=\"line\">268</div><div class=\"line\">269</div><div class=\"line\">270</div><div class=\"line\">271</div><div class=\"line\">272</div><div class=\"line\">273</div><div class=\"line\">274</div><div class=\"line\">275</div><div class=\"line\">276</div><div class=\"line\">277</div></pre></div><div class=\"code\"><pre><div class=\"line\"><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span></div><div class=\"line\"><span class=\"comment\">\" 显示相关  </span></div><div class=\"line\"><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"string\">\"set shortmess=atI   \"</span> 启动的时候不显示那个援助乌干达儿童的提示  </div><div class=\"line\"><span class=\"string\">\"winpos 5 5          \"</span> 设定窗口位置  </div><div class=\"line\"><span class=\"string\">\"set lines=40 columns=155    \"</span> 设定窗口大小  </div><div class=\"line\"><span class=\"string\">\"set nu              \"</span> 显示行号  </div><div class=\"line\"><span class=\"keyword\">set</span> <span class=\"keyword\">go</span>=              <span class=\"comment\">\" 不要图形按钮  </span></div><div class=\"line\"><span class=\"string\">\"color asmanian2     \"</span> 设置背景主题  </div><div class=\"line\"><span class=\"string\">\"syntax on           \"</span> 语法高亮  </div><div class=\"line\"><span class=\"keyword\">autocmd</span> InsertLeave * <span class=\"keyword\">se</span> nocul  <span class=\"comment\">\" 用浅色高亮当前行  </span></div><div class=\"line\"><span class=\"keyword\">autocmd</span> InsertEnter * <span class=\"keyword\">se</span> cul    <span class=\"comment\">\" 用浅色高亮当前行  </span></div><div class=\"line\"><span class=\"string\">\"set ruler           \"</span> 显示标尺  </div><div class=\"line\"><span class=\"keyword\">set</span> showcmd         <span class=\"comment\">\" 输入的命令显示出来，看的清楚些  </span></div><div class=\"line\"><span class=\"string\">\"set cmdheight=1     \"</span> 命令行（在状态行下）的高度，设置为<span class=\"number\">1</span>  </div><div class=\"line\"><span class=\"string\">\"set whichwrap+=&lt;,&gt;,h,l   \"</span> 允许backspace和光标键跨越行边界(不建议)  </div><div class=\"line\"><span class=\"string\">\"set scrolloff=3     \"</span> 光标移动到<span class=\"keyword\">buffer</span>的顶部和底部时保持<span class=\"number\">3</span>行距离  </div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">set</span> statusline=%F%<span class=\"keyword\">m</span>%r%h%<span class=\"keyword\">w</span>\\ [FORMAT=%&#123;&amp;ff&#125;]\\ [TYPE=%Y]\\ [POS=%<span class=\"keyword\">l</span>,%v][%<span class=\"keyword\">p</span>%%]\\ %&#123;<span class=\"built_in\">strftime</span>(\\<span class=\"string\">\"%d/%m/%y\\ -\\ %H:%M\\\")&#125;   \"</span>状态行显示的内容  </div><div class=\"line\"><span class=\"keyword\">set</span> laststatus=<span class=\"number\">1</span>    <span class=\"comment\">\" 启动显示状态行(1),总是显示状态行(2)  </span></div><div class=\"line\"><span class=\"keyword\">set</span> foldenable      <span class=\"comment\">\" 允许折叠  </span></div><div class=\"line\"><span class=\"keyword\">set</span> foldmethod=manual   <span class=\"comment\">\" 手动折叠  </span></div><div class=\"line\"><span class=\"string\">\"set background=dark \"</span>背景使用黑色 </div><div class=\"line\"><span class=\"keyword\">set</span> nocompatible  <span class=\"comment\">\"去掉讨厌的有关vi一致性模式，避免以前版本的一些bug和局限  </span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 显示中文帮助</span></div><div class=\"line\"><span class=\"keyword\">if</span> <span class=\"keyword\">version</span> &gt;= <span class=\"number\">603</span></div><div class=\"line\">    <span class=\"keyword\">set</span> helplang=<span class=\"keyword\">cn</span></div><div class=\"line\">    <span class=\"keyword\">set</span> encoding=utf-<span class=\"number\">8</span></div><div class=\"line\"><span class=\"keyword\">endif</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 设置配色方案</span></div><div class=\"line\"><span class=\"comment\">\"colorscheme murphy</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">set</span> fencs=utf-<span class=\"number\">8</span>,ucs-bom,shift-jis,gb18030,gbk,gb2312,cp936</div><div class=\"line\"><span class=\"keyword\">set</span> termencoding=utf-<span class=\"number\">8</span></div><div class=\"line\"><span class=\"keyword\">set</span> encoding=utf-<span class=\"number\">8</span></div><div class=\"line\"><span class=\"keyword\">set</span> fileencodings=ucs-bom,utf-<span class=\"number\">8</span>,cp936</div><div class=\"line\"><span class=\"keyword\">set</span> fileencoding=utf-<span class=\"number\">8</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span></div><div class=\"line\"><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"comment\">\"新文件标题</span></div><div class=\"line\"><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\"新建.c,.h,.sh,.java文件，自动插入文件头 </span></div><div class=\"line\"><span class=\"keyword\">autocmd</span> BufNewFile *.cpp,*.[ch],*.<span class=\"keyword\">sh</span>,*.java exec <span class=\"string\">\":call SetTitle()\"</span> </div><div class=\"line\"></div><div class=\"line\"><span class=\"string\">\"\"</span>定义函数SetTitle，自动插入文件头 </div><div class=\"line\">func SetTitle() </div><div class=\"line\">    <span class=\"comment\">\"如果文件类型为.sh文件 </span></div><div class=\"line\">    <span class=\"keyword\">if</span> &amp;<span class=\"keyword\">filetype</span> == <span class=\"string\">'sh'</span> </div><div class=\"line\">        <span class=\"keyword\">call</span> <span class=\"built_in\">setline</span>(<span class=\"number\">1</span>,<span class=\"string\">\"\\#########################################################################\"</span>) </div><div class=\"line\">        <span class=\"keyword\">call</span> <span class=\"keyword\">append</span>(<span class=\"built_in\">line</span>(<span class=\"string\">\".\"</span>), <span class=\"string\">\"\\# File Name: \"</span>.<span class=\"built_in\">expand</span>(<span class=\"string\">\"%\"</span>)) </div><div class=\"line\">        <span class=\"keyword\">call</span> <span class=\"keyword\">append</span>(<span class=\"built_in\">line</span>(<span class=\"string\">\".\"</span>)+<span class=\"number\">3</span>, <span class=\"string\">\"\\# Created Time: \"</span>.<span class=\"built_in\">strftime</span>(<span class=\"string\">\"%c\"</span>)) </div><div class=\"line\">        <span class=\"keyword\">call</span> <span class=\"keyword\">append</span>(<span class=\"built_in\">line</span>(<span class=\"string\">\".\"</span>)+<span class=\"number\">4</span>, <span class=\"string\">\"\\#########################################################################\"</span>) </div><div class=\"line\">        <span class=\"keyword\">call</span> <span class=\"keyword\">append</span>(<span class=\"built_in\">line</span>(<span class=\"string\">\".\"</span>)+<span class=\"number\">5</span>, <span class=\"string\">\"\\#!/bin/bash\"</span>) </div><div class=\"line\">        <span class=\"keyword\">call</span> <span class=\"keyword\">append</span>(<span class=\"built_in\">line</span>(<span class=\"string\">\".\"</span>)+<span class=\"number\">6</span>, <span class=\"string\">\"\"</span>) </div><div class=\"line\">    <span class=\"keyword\">else</span> </div><div class=\"line\">        <span class=\"keyword\">call</span> <span class=\"built_in\">setline</span>(<span class=\"number\">1</span>, <span class=\"string\">\"/*************************************************************************\"</span>) </div><div class=\"line\">        <span class=\"keyword\">call</span> <span class=\"keyword\">append</span>(<span class=\"built_in\">line</span>(<span class=\"string\">\".\"</span>), <span class=\"string\">\"    &gt; File Name: \"</span>.<span class=\"built_in\">expand</span>(<span class=\"string\">\"%\"</span>)) </div><div class=\"line\">        <span class=\"keyword\">call</span> <span class=\"keyword\">append</span>(<span class=\"built_in\">line</span>(<span class=\"string\">\".\"</span>)+<span class=\"number\">3</span>, <span class=\"string\">\"    &gt; Created Time: \"</span>.<span class=\"built_in\">strftime</span>(<span class=\"string\">\"%c\"</span>)) </div><div class=\"line\">        <span class=\"keyword\">call</span> <span class=\"keyword\">append</span>(<span class=\"built_in\">line</span>(<span class=\"string\">\".\"</span>)+<span class=\"number\">4</span>, <span class=\"string\">\" ************************************************************************/\"</span>) </div><div class=\"line\">        <span class=\"keyword\">call</span> <span class=\"keyword\">append</span>(<span class=\"built_in\">line</span>(<span class=\"string\">\".\"</span>)+<span class=\"number\">5</span>, <span class=\"string\">\"\"</span>)</div><div class=\"line\">    <span class=\"keyword\">endif</span></div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">if</span> &amp;<span class=\"keyword\">filetype</span> == <span class=\"string\">'cpp'</span></div><div class=\"line\">        <span class=\"keyword\">call</span> <span class=\"keyword\">append</span>(<span class=\"built_in\">line</span>(<span class=\"string\">\".\"</span>)+<span class=\"number\">6</span>, <span class=\"string\">\"#include&lt;iostream&gt;\"</span>)</div><div class=\"line\">        <span class=\"keyword\">call</span> <span class=\"keyword\">append</span>(<span class=\"built_in\">line</span>(<span class=\"string\">\".\"</span>)+<span class=\"number\">7</span>, <span class=\"string\">\"using namespace std;\"</span>)</div><div class=\"line\">        <span class=\"keyword\">call</span> <span class=\"keyword\">append</span>(<span class=\"built_in\">line</span>(<span class=\"string\">\".\"</span>)+<span class=\"number\">8</span>, <span class=\"string\">\"\"</span>)</div><div class=\"line\">    <span class=\"keyword\">endif</span></div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">if</span> &amp;<span class=\"keyword\">filetype</span> == <span class=\"string\">'c'</span></div><div class=\"line\">        <span class=\"keyword\">call</span> <span class=\"keyword\">append</span>(<span class=\"built_in\">line</span>(<span class=\"string\">\".\"</span>)+<span class=\"number\">6</span>, <span class=\"string\">\"#include&lt;stdio.h&gt;\"</span>)</div><div class=\"line\">        <span class=\"keyword\">call</span> <span class=\"keyword\">append</span>(<span class=\"built_in\">line</span>(<span class=\"string\">\".\"</span>)+<span class=\"number\">7</span>, <span class=\"string\">\"\"</span>)</div><div class=\"line\">    <span class=\"keyword\">endif</span></div><div class=\"line\">    <span class=\"comment\">\"新建文件后，自动定位到文件末尾</span></div><div class=\"line\">    <span class=\"keyword\">autocmd</span> BufNewFile * <span class=\"keyword\">normal</span> G</div><div class=\"line\">endfunc </div><div class=\"line\"></div><div class=\"line\"><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span></div><div class=\"line\"><span class=\"comment\">\"键盘命令</span></div><div class=\"line\"><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">nmap</span> <span class=\"symbol\">&lt;leader&gt;</span><span class=\"keyword\">w</span> :w!<span class=\"symbol\">&lt;cr&gt;</span></div><div class=\"line\"><span class=\"keyword\">nmap</span> <span class=\"symbol\">&lt;leader&gt;</span><span class=\"keyword\">f</span> :<span class=\"keyword\">find</span><span class=\"symbol\">&lt;cr&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\"去空行  </span></div><div class=\"line\"><span class=\"keyword\">nnoremap</span> <span class=\"symbol\">&lt;F2&gt;</span> :g/^\\s*$/d<span class=\"symbol\">&lt;CR&gt;</span> </div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\"比较文件  </span></div><div class=\"line\"><span class=\"keyword\">nnoremap</span> <span class=\"symbol\">&lt;C-F2&gt;</span> :<span class=\"keyword\">vert</span> <span class=\"keyword\">diffsplit</span> </div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\"新建标签  </span></div><div class=\"line\"><span class=\"keyword\">map</span> <span class=\"symbol\">&lt;M-F2&gt;</span> :<span class=\"keyword\">tabnew</span><span class=\"symbol\">&lt;CR&gt;</span>  </div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\"列出当前目录文件  </span></div><div class=\"line\"><span class=\"keyword\">map</span> <span class=\"symbol\">&lt;F3&gt;</span> :<span class=\"keyword\">tabnew</span> .<span class=\"symbol\">&lt;CR&gt;</span>  </div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\"打开树状文件目录  </span></div><div class=\"line\"><span class=\"keyword\">map</span> <span class=\"symbol\">&lt;C-F3&gt;</span> \\<span class=\"keyword\">be</span>  </div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span></div><div class=\"line\"><span class=\"string\">\"\"</span>实用设置</div><div class=\"line\"><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"comment\">\"</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 设置当文件被改动时自动载入</span></div><div class=\"line\"><span class=\"keyword\">set</span> autoread</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" quickfix模式</span></div><div class=\"line\"><span class=\"keyword\">autocmd</span> FileType <span class=\"keyword\">c</span>,cpp <span class=\"keyword\">map</span> <span class=\"symbol\">&lt;buffer&gt;</span> <span class=\"symbol\">&lt;leader&gt;</span><span class=\"symbol\">&lt;space&gt;</span> :<span class=\"keyword\">w</span><span class=\"symbol\">&lt;cr&gt;</span>:<span class=\"keyword\">make</span><span class=\"symbol\">&lt;cr&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\"代码补全 </span></div><div class=\"line\"><span class=\"keyword\">set</span> completeopt=preview,<span class=\"keyword\">menu</span> </div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\"允许插件  </span></div><div class=\"line\"><span class=\"keyword\">filetype</span> plugin <span class=\"keyword\">on</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\"共享剪贴板  </span></div><div class=\"line\"><span class=\"keyword\">set</span> clipboard+=unnamed </div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\"从不备份  </span></div><div class=\"line\"><span class=\"keyword\">set</span> nobackup</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\"make 运行</span></div><div class=\"line\">:<span class=\"keyword\">set</span> makeprg=g++\\ -Wall\\ \\ %</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\"自动保存</span></div><div class=\"line\"><span class=\"keyword\">set</span> autowrite</div><div class=\"line\"><span class=\"keyword\">set</span> ruler                   <span class=\"comment\">\" 打开状态栏标尺</span></div><div class=\"line\"><span class=\"keyword\">set</span> cursorline              <span class=\"comment\">\" 突出显示当前行</span></div><div class=\"line\"><span class=\"keyword\">set</span> magic                   <span class=\"comment\">\" 设置魔术</span></div><div class=\"line\"><span class=\"keyword\">set</span> guioptions-=T           <span class=\"comment\">\" 隐藏工具栏</span></div><div class=\"line\"><span class=\"keyword\">set</span> guioptions-=<span class=\"keyword\">m</span>           <span class=\"comment\">\" 隐藏菜单栏</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\"set statusline=\\ %&lt;%F[%1*%M%*%n%R%H]%=\\ %y\\ %0(%&#123;&amp;fileformat&#125;\\ %&#123;&amp;encoding&#125;\\ %c:%l/%L%)\\</span></div><div class=\"line\"><span class=\"comment\">\" 设置在状态行显示的信息</span></div><div class=\"line\"><span class=\"keyword\">set</span> foldcolumn=<span class=\"number\">0</span></div><div class=\"line\"><span class=\"keyword\">set</span> foldmethod=<span class=\"built_in\">indent</span> </div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 不要使用vi的键盘模式，而是vim自己的</span></div><div class=\"line\"><span class=\"keyword\">set</span> nocompatible</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 语法高亮</span></div><div class=\"line\"><span class=\"keyword\">set</span> <span class=\"keyword\">syntax</span>=<span class=\"keyword\">on</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 去掉输入错误的提示声音</span></div><div class=\"line\"><span class=\"keyword\">set</span> noeb</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 在处理未保存或只读文件的时候，弹出确认</span></div><div class=\"line\"><span class=\"keyword\">set</span> <span class=\"keyword\">confirm</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 自动缩进</span></div><div class=\"line\"><span class=\"keyword\">set</span> autoindent</div><div class=\"line\"><span class=\"keyword\">set</span> <span class=\"built_in\">cindent</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" Tab键的宽度</span></div><div class=\"line\"><span class=\"keyword\">set</span> tabstop=<span class=\"number\">4</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 统一缩进为4</span></div><div class=\"line\"><span class=\"keyword\">set</span> softtabstop=<span class=\"number\">4</span></div><div class=\"line\"><span class=\"keyword\">set</span> <span class=\"built_in\">shiftwidth</span>=<span class=\"number\">4</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 不要用空格代替制表符</span></div><div class=\"line\"><span class=\"keyword\">set</span> noexpandtab</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 在行和段开始处使用制表符</span></div><div class=\"line\"><span class=\"keyword\">set</span> smarttab</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 显示行号</span></div><div class=\"line\"><span class=\"keyword\">set</span> <span class=\"keyword\">number</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 历史记录数</span></div><div class=\"line\"><span class=\"keyword\">set</span> <span class=\"keyword\">history</span>=<span class=\"number\">1000</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\"禁止生成临时文件</span></div><div class=\"line\"><span class=\"keyword\">set</span> nobackup</div><div class=\"line\"><span class=\"keyword\">set</span> noswapfile</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\"搜索忽略大小写</span></div><div class=\"line\"><span class=\"keyword\">set</span> ignorecase</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\"搜索逐字符高亮</span></div><div class=\"line\"><span class=\"keyword\">set</span> hlsearch</div><div class=\"line\"><span class=\"keyword\">set</span> incsearch</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\"行内替换</span></div><div class=\"line\"><span class=\"keyword\">set</span> gdefault</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\"编码设置</span></div><div class=\"line\"><span class=\"keyword\">set</span> enc=utf-<span class=\"number\">8</span></div><div class=\"line\"><span class=\"keyword\">set</span> fencs=utf-<span class=\"number\">8</span>,ucs-bom,shift-jis,gb18030,gbk,gb2312,cp936</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\"语言设置</span></div><div class=\"line\"><span class=\"keyword\">set</span> langmenu=zh_CN.UTF-<span class=\"number\">8</span></div><div class=\"line\"><span class=\"keyword\">set</span> helplang=<span class=\"keyword\">cn</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 我的状态行显示的内容（包括文件类型和解码）</span></div><div class=\"line\"><span class=\"string\">\"set statusline=%F%m%r%h%w\\ [FORMAT=%&#123;&amp;ff&#125;]\\ [TYPE=%Y]\\ [POS=%l,%v][%p%%]\\ %&#123;strftime(\\\"%d/%m/%y\\ -\\ %H:%M\\\"</span>)&#125;</div><div class=\"line\"><span class=\"comment\">\"set statusline=[%F]%y%r%m%*%=[Line:%l/%L,Column:%c][%p%%]</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 总是显示状态行</span></div><div class=\"line\"><span class=\"keyword\">set</span> laststatus=<span class=\"number\">2</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 命令行（在状态行下）的高度，默认为1，这里是2</span></div><div class=\"line\"><span class=\"keyword\">set</span> cmdheight=<span class=\"number\">2</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 侦测文件类型</span></div><div class=\"line\"><span class=\"keyword\">filetype</span> <span class=\"keyword\">on</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 载入文件类型插件</span></div><div class=\"line\"><span class=\"keyword\">filetype</span> plugin <span class=\"keyword\">on</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 为特定文件类型载入相关缩进文件</span></div><div class=\"line\"><span class=\"keyword\">filetype</span> <span class=\"built_in\">indent</span> <span class=\"keyword\">on</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 保存全局变量</span></div><div class=\"line\"><span class=\"keyword\">set</span> viminfo+=!</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 带有如下符号的单词不要被换行分割</span></div><div class=\"line\"><span class=\"keyword\">set</span> iskeyword+=_,$,@,%,#,-</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 字符间插入的像素行数目</span></div><div class=\"line\"><span class=\"keyword\">set</span> linespace=<span class=\"number\">0</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 通过使用: commands命令，告诉我们文件的哪一行被改变过</span></div><div class=\"line\"><span class=\"keyword\">set</span> report=<span class=\"number\">0</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 在被分割的窗口间显示空白，便于阅读</span></div><div class=\"line\"><span class=\"keyword\">set</span> fillchars=ver<span class=\"variable\">t:</span>\\ ,<span class=\"keyword\">st</span><span class=\"variable\">l:</span>\\ ,stlnc:\\</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 高亮显示匹配的括号</span></div><div class=\"line\"><span class=\"keyword\">set</span> showmatch</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 匹配括号高亮的时间（单位是十分之一秒）</span></div><div class=\"line\"><span class=\"keyword\">set</span> matchtime=<span class=\"number\">1</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 光标移动到buffer的顶部和底部时保持3行距离</span></div><div class=\"line\"><span class=\"keyword\">set</span> scrolloff=<span class=\"number\">3</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"comment\">\"</span></div><div class=\"line\"><span class=\"comment\">\" CTags的设定  </span></div><div class=\"line\"><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"comment\">\"</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">let</span> Tlist_Sort_Type = <span class=\"string\">\"name\"</span>    <span class=\"comment\">\" 按照名称排序  </span></div><div class=\"line\"><span class=\"keyword\">let</span> Tlist_Use_Right_Window = <span class=\"number\">1</span>  <span class=\"comment\">\" 在右侧显示窗口  </span></div><div class=\"line\"><span class=\"keyword\">let</span> Tlist_Compart_Format = <span class=\"number\">1</span>    <span class=\"comment\">\" 压缩方式  </span></div><div class=\"line\"><span class=\"keyword\">let</span> Tlist_Exist_OnlyWindow = <span class=\"number\">1</span>  <span class=\"comment\">\" 如果只有一个buffer，kill窗口也kill掉buffer  </span></div><div class=\"line\"><span class=\"keyword\">let</span> Tlist_File_Fold_Auto_Close = <span class=\"number\">0</span>  <span class=\"comment\">\" 不要关闭其他文件的tags  </span></div><div class=\"line\"><span class=\"keyword\">let</span> Tlist_Enable_Fold_Column = <span class=\"number\">0</span>    <span class=\"comment\">\" 不要显示折叠树  </span></div><div class=\"line\"><span class=\"string\">\"let Tlist_Show_One_File=1            \"</span>不同时显示多个文件的<span class=\"keyword\">tag</span>，只显示当前文件的</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\"设置tags  </span></div><div class=\"line\"><span class=\"keyword\">set</span> <span class=\"keyword\">tags</span>=<span class=\"keyword\">tags</span>  </div><div class=\"line\"><span class=\"comment\">\"set autochdir </span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\"默认打开Taglist </span></div><div class=\"line\"><span class=\"keyword\">let</span> Tlist_Auto_Open=<span class=\"number\">1</span> </div><div class=\"line\"></div><div class=\"line\"><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span> </div><div class=\"line\"><span class=\"comment\">\" Tag list (ctags) </span></div><div class=\"line\"><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span> </div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">let</span> Tlist_Ctags_Cmd = <span class=\"string\">'/usr/bin/ctags'</span> </div><div class=\"line\"><span class=\"keyword\">let</span> Tlist_Show_One_File = <span class=\"number\">1</span> <span class=\"comment\">\"不同时显示多个文件的tag，只显示当前文件的 </span></div><div class=\"line\"><span class=\"keyword\">let</span> Tlist_Exit_OnlyWindow = <span class=\"number\">1</span> <span class=\"comment\">\"如果taglist窗口是最后一个窗口，则退出vim </span></div><div class=\"line\"><span class=\"keyword\">let</span> Tlist_Use_Right_Window = <span class=\"number\">1</span> <span class=\"comment\">\"在右侧窗口中显示taglist窗口</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" minibufexpl插件的一般设置</span></div><div class=\"line\"><span class=\"keyword\">let</span> <span class=\"variable\">g:miniBufExplMapWindowNavVim</span> = <span class=\"number\">1</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">let</span> <span class=\"variable\">g:miniBufExplMapWindowNavArrows</span> = <span class=\"number\">1</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">let</span> <span class=\"variable\">g:miniBufExplMapCTabSwitchBufs</span> = <span class=\"number\">1</span></div><div class=\"line\"><span class=\"keyword\">let</span> <span class=\"variable\">g:miniBufExplModSelTarget</span> = <span class=\"number\">1</span></div></pre></div></div></figure>\n<h1 id=\"其他命令\"><a href=\"#其他命令\" class=\"headerlink\" title=\"其他命令\"></a>其他命令</h1><p><a href=\"https://kjh123.github.io/2018/06/27/Linux%E5%91%BD%E4%BB%A4%E5%AD%A6%E4%B9%A0/\" target=\"_blank\" rel=\"noopener\">点击跳转</a></p>\n","site":{"data":{}},"excerpt":"<blockquote class=\"blockquote-center\">学而践行之</blockquote>","more":"<p>服务器环境： <em>Ubuntu: V16.04</em></p>\n<h1 id=\"软件列表\"><a href=\"#软件列表\" class=\"headerlink\" title=\"软件列表\"></a>软件列表</h1><table>\n<thead>\n<tr>\n<th>环境</th>\n<th>版本</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Nginx</td>\n<td>V1.10.3</td>\n</tr>\n<tr>\n<td>PHP</td>\n<td>V7.1.18</td>\n</tr>\n<tr>\n<td>MySQL</td>\n<td>V5.7.22</td>\n</tr>\n<tr>\n<td>Redis</td>\n<td>V3.1.6</td>\n</tr>\n<tr>\n<td>Git</td>\n<td>V2.7.4</td>\n</tr>\n<tr>\n<td>libreoffice</td>\n<td>V5.4</td>\n</tr>\n<tr>\n<td>inkscape</td>\n<td>-</td>\n</tr>\n<tr>\n<td>lrzsz</td>\n<td>V0.12.21-8</td>\n</tr>\n<tr>\n<td>tmux</td>\n<td>V2.1.3</td>\n</tr>\n</tbody>\n</table>\n<h1 id=\"准备\"><a href=\"#准备\" class=\"headerlink\" title=\"准备\"></a>准备</h1><blockquote>\n<p>更新软件源为阿里源<br><figure class=\"highlight bash\"><figcaption><span class=\"fileDir\">/etc/apt/</span><span class=\"caption\">source</span><span class=\"suffix\">.list</span></figcaption><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div></pre></div><div class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># 备份</span></div><div class=\"line\">sudo cp /etc/apt/sources.list /etc/apt/sources.list.old</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># vim: /etc/apt/source.list</span></div><div class=\"line\"><span class=\"comment\"># deb cdrom:[Ubuntu 16.04 LTS _Xenial Xerus_ - Release amd64 (20160420.1)]/ xenial main restricted</span></div><div class=\"line\">deb-src http://archive.ubuntu.com/ubuntu xenial main restricted <span class=\"comment\">#Added by software-properties</span></div><div class=\"line\">deb http://mirrors.aliyun.com/ubuntu/ xenial main restricted</div><div class=\"line\">deb-src http://mirrors.aliyun.com/ubuntu/ xenial main restricted multiverse universe <span class=\"comment\">#Added by software-properties</span></div><div class=\"line\">deb http://mirrors.aliyun.com/ubuntu/ xenial-updates main restricted</div><div class=\"line\">deb-src http://mirrors.aliyun.com/ubuntu/ xenial-updates main restricted multiverse universe <span class=\"comment\">#Added by software-properties</span></div><div class=\"line\">deb http://mirrors.aliyun.com/ubuntu/ xenial universe</div><div class=\"line\">deb http://mirrors.aliyun.com/ubuntu/ xenial-updates universe</div><div class=\"line\">deb http://mirrors.aliyun.com/ubuntu/ xenial multiverse</div><div class=\"line\">deb http://mirrors.aliyun.com/ubuntu/ xenial-updates multiverse</div><div class=\"line\">deb http://mirrors.aliyun.com/ubuntu/ xenial-backports main restricted universe multiverse</div><div class=\"line\">deb-src http://mirrors.aliyun.com/ubuntu/ xenial-backports main restricted universe multiverse <span class=\"comment\">#Added by software-properties</span></div><div class=\"line\">deb http://archive.canonical.com/ubuntu xenial partner</div><div class=\"line\">deb-src http://archive.canonical.com/ubuntu xenial partner</div><div class=\"line\">deb http://mirrors.aliyun.com/ubuntu/ xenial-security main restricted</div><div class=\"line\">deb-src http://mirrors.aliyun.com/ubuntu/ xenial-security main restricted multiverse universe <span class=\"comment\">#Added by software-properties</span></div><div class=\"line\">deb http://mirrors.aliyun.com/ubuntu/ xenial-security universe</div><div class=\"line\">deb http://mirrors.aliyun.com/ubuntu/ xenial-security multiverse</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 执行更新</span></div><div class=\"line\">sudo apt-get update</div></pre></div></div></figure></p>\n</blockquote>\n<figure class=\"highlight shell\"><figcaption><span class=\"caption\">#@Ubuntu:>_</span></figcaption><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\">sudo apt-add-repository ppa:ondrej/php   # 添加 PHP 软件源</div><div class=\"line\">sudo add-apt-repository ppa:libreoffice/libreoffice-5-4    # 添加 Libreoffice5.4 软件源</div><div class=\"line\">报错则执行：</div><div class=\"line\">    1. sudo apt-get install python-software-properties</div><div class=\"line\">    2. sudo apt-get install software-properties-common</div><div class=\"line\"></div><div class=\"line\">sudo apt-get update    # 更新软件源</div></pre></div></div></figure>\n<hr>\n<h1 id=\"安装-Web-服务器环境\"><a href=\"#安装-Web-服务器环境\" class=\"headerlink\" title=\"安装 Web 服务器环境\"></a>安装 Web 服务器环境</h1><p> <a href=\"#Nginx\">Nginx</a>, <a href=\"#PHP\">PHP</a>, <a href=\"#MySql\">MySql</a></p>\n<h2 id=\"Nginx\"><a href=\"#Nginx\" class=\"headerlink\" title=\"Nginx\"></a>Nginx</h2><p>直接命令安装：<code>sudo apt-get install nginx</code><br>启动 Nginx ：<code>sudo service nginx start</code></p>\n<blockquote>\n<p>相关命令：</p>\n<ul>\n<li>netstat -anp | grep nginx    查看Nginx进程</li>\n<li>lsof -i:80                   查看80端口状态</li>\n</ul>\n</blockquote>\n<h2 id=\"PHP\"><a href=\"#PHP\" class=\"headerlink\" title=\"PHP\"></a>PHP</h2><p>命令安装：<code>sudo apt-get install php7.1</code><br>安装fpm：<code>sudo apt-get install php7.1-fpm</code></p>\n<blockquote>\n<p>相关命令：</p>\n<ul>\n<li>php -v  安装完后检查</li>\n<li>php -m  已安装的 PHP 模块</li>\n</ul>\n</blockquote>\n<h2 id=\"MySql\"><a href=\"#MySql\" class=\"headerlink\" title=\"MySql\"></a>MySql</h2><p>命令安装：<code>apt-get install mysql-server mysql-client php7.1-mysql</code></p>\n<blockquote>\n<p>在安装过程中会提示输入 root 用户的登录密码</p>\n</blockquote>\n<h2 id=\"Nginx-解析-PHP\"><a href=\"#Nginx-解析-PHP\" class=\"headerlink\" title=\"Nginx 解析 PHP\"></a>Nginx 解析 PHP</h2><blockquote>\n<p>PHP-FPM 与 Nginx 通信方式有两种，一种是基于TCP的 Internet domain socket 方式，一种是 UNIX domain socket 方式。 推荐使用第二种连接方式 Socket 路径为：/run/php/php7.1-fpm.sock</p>\n</blockquote>\n<figure class=\"highlight nginx\"><figcaption><span class=\"caption\">nginx</span><span class=\"suffix\">.conf</span></figcaption><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></div><div class=\"code\"><pre><div class=\"line\"><span class=\"attribute\">location</span> <span class=\"regexp\">~ \\.php$</span> &#123;</div><div class=\"line\">    <span class=\"attribute\">include</span> snippets/fastcgi-php.conf;</div><div class=\"line\">    <span class=\"comment\"># With php7.0-cgi alone:</span></div><div class=\"line\">    <span class=\"comment\"># fastcgi_pass 127.0.0.1:9000;</span></div><div class=\"line\">    <span class=\"comment\"># With php7.0-fpm:</span></div><div class=\"line\">    <span class=\"attribute\">fastcgi_pass</span> unix:/run/php/php7.1-fpm.sock;</div><div class=\"line\">    <span class=\"attribute\">fastcgi_index</span>  index.php;</div><div class=\"line\">    <span class=\"attribute\">fastcgi_param</span>  SCRIPT_FILENAME  <span class=\"variable\">$document_root</span><span class=\"variable\">$fastcgi_script_name</span>;</div><div class=\"line\">    <span class=\"attribute\">include</span>        fastcgi_params;</div><div class=\"line\">&#125;</div></pre></div></div></figure>\n<figure class=\"highlight ini\"><figcaption><span class=\"fileDir\">/etc/php/7.1/fpm/pool.d/</span><span class=\"caption\">www</span><span class=\"suffix\">.conf</span></figcaption><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></div><div class=\"code\"><pre><div class=\"line\"><span class=\"comment\">; 与 Nginx监听同一个 sock</span></div><div class=\"line\"><span class=\"attr\">listen</span> = /run/php/php7.<span class=\"number\">1</span>-fpm.sock</div></pre></div></div></figure>\n<h2 id=\"Redis-的安装\"><a href=\"#Redis-的安装\" class=\"headerlink\" title=\"Redis 的安装\"></a>Redis 的安装</h2><figure class=\"highlight bash\"><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></div><div class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># 先安装 redis-server 和 redis-tools, 以及 编译PHP扩展包工具</span></div><div class=\"line\">sudo apt-get install redis-server redis-tools php7.1-dev</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 安装 php-redis 扩展 依次执行</span></div><div class=\"line\">phpize7.1</div><div class=\"line\">./configure --with-php-config=/usr/bin/php-config</div><div class=\"line\">make</div><div class=\"line\">sudo make install</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 安装完成后添加 扩展</span></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"extension=redis.so\"</span> &gt;&gt; /etc/php/7.1/mods-available/redis.ini</div><div class=\"line\">sudo ln -s /etc/php/7.1/mods-available/redis.ini /etc/php/7.1/cli/conf.d/20-redis.ini</div><div class=\"line\">sudo ln -s /etc/php/7.1/mods-available/redis.ini /etc/php/7.1/fpm/conf.d/20-redis.ini</div></pre></div></div></figure>\n<h1 id=\"应用软件\"><a href=\"#应用软件\" class=\"headerlink\" title=\"应用软件\"></a>应用软件</h1><ol>\n<li><p>sudo apt-get install libreoffice   # 开源办公套件</p>\n<blockquote>\n<p>eg： 将 word/ppt/excel 转换为 pdf ： <code>libreoffice  --invisible --convert-to pdf  demo.docx</code></p>\n</blockquote>\n</li>\n<li><p>sudo apt-get install inksacpe      # 矢量图转换工具</p>\n<blockquote>\n<p>eg： 将 emf 转换为 png ： <code>inkscape -e output.png input.emf</code></p>\n</blockquote>\n</li>\n<li><p>sudo apt-get install lrzsz         # linux 快速传输工具</p>\n<blockquote>\n<p>eg： 上传文件 <code>rz</code>， 下载文件 <code>sz filename</code></p>\n</blockquote>\n</li>\n<li><p>sudo apt-get install git           </p>\n</li>\n</ol>\n<h1 id=\"其他配置\"><a href=\"#其他配置\" class=\"headerlink\" title=\"其他配置\"></a>其他配置</h1><h2 id=\"tmux-配置\"><a href=\"#tmux-配置\" class=\"headerlink\" title=\"tmux 配置\"></a>tmux 配置</h2><figure class=\"highlight\"><figcaption><span class=\"fileDir\">~/</span><span class=\"caption\">.tmux</span><span class=\"suffix\">.conf</span><a href=\"https://gitee.com/kongvip/config/blob/master/tmux.config\" target=\"_blank\">链接地址</a></figcaption><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></div><div class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># 设置前缀为Ctrl + a</span></div><div class=\"line\">set -g prefix C-x</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#解除Ctrl+b 与前缀的对应关系</span></div><div class=\"line\">unbind C-b</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">## 切换面板</span></div><div class=\"line\"><span class=\"comment\">#up</span></div><div class=\"line\">bind-key k select-pane -U</div><div class=\"line\"><span class=\"comment\">#down</span></div><div class=\"line\">bind-key j select-pane -D</div><div class=\"line\"><span class=\"comment\">#left</span></div><div class=\"line\">bind-key h select-pane -L</div><div class=\"line\"><span class=\"comment\">#right</span></div><div class=\"line\">bind-key l select-pane -R</div></pre></div></div></figure>\n<h2 id=\"vim-配置\"><a href=\"#vim-配置\" class=\"headerlink\" title=\"vim 配置\"></a>vim 配置</h2><figure class=\"highlight vim\"><figcaption><span class=\"fileDir\">~/</span><span class=\"caption\">.vimrc</span><a href=\"https://gitee.com/kongvip/config/blob/master/vimrc\" target=\"_blank\">链接地址</a></figcaption><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div><div class=\"line\">117</div><div class=\"line\">118</div><div class=\"line\">119</div><div class=\"line\">120</div><div class=\"line\">121</div><div class=\"line\">122</div><div class=\"line\">123</div><div class=\"line\">124</div><div class=\"line\">125</div><div class=\"line\">126</div><div class=\"line\">127</div><div class=\"line\">128</div><div class=\"line\">129</div><div class=\"line\">130</div><div class=\"line\">131</div><div class=\"line\">132</div><div class=\"line\">133</div><div class=\"line\">134</div><div class=\"line\">135</div><div class=\"line\">136</div><div class=\"line\">137</div><div class=\"line\">138</div><div class=\"line\">139</div><div class=\"line\">140</div><div class=\"line\">141</div><div class=\"line\">142</div><div class=\"line\">143</div><div class=\"line\">144</div><div class=\"line\">145</div><div class=\"line\">146</div><div class=\"line\">147</div><div class=\"line\">148</div><div class=\"line\">149</div><div class=\"line\">150</div><div class=\"line\">151</div><div class=\"line\">152</div><div class=\"line\">153</div><div class=\"line\">154</div><div class=\"line\">155</div><div class=\"line\">156</div><div class=\"line\">157</div><div class=\"line\">158</div><div class=\"line\">159</div><div class=\"line\">160</div><div class=\"line\">161</div><div class=\"line\">162</div><div class=\"line\">163</div><div class=\"line\">164</div><div class=\"line\">165</div><div class=\"line\">166</div><div class=\"line\">167</div><div class=\"line\">168</div><div class=\"line\">169</div><div class=\"line\">170</div><div class=\"line\">171</div><div class=\"line\">172</div><div class=\"line\">173</div><div class=\"line\">174</div><div class=\"line\">175</div><div class=\"line\">176</div><div class=\"line\">177</div><div class=\"line\">178</div><div class=\"line\">179</div><div class=\"line\">180</div><div class=\"line\">181</div><div class=\"line\">182</div><div class=\"line\">183</div><div class=\"line\">184</div><div class=\"line\">185</div><div class=\"line\">186</div><div class=\"line\">187</div><div class=\"line\">188</div><div class=\"line\">189</div><div class=\"line\">190</div><div class=\"line\">191</div><div class=\"line\">192</div><div class=\"line\">193</div><div class=\"line\">194</div><div class=\"line\">195</div><div class=\"line\">196</div><div class=\"line\">197</div><div class=\"line\">198</div><div class=\"line\">199</div><div class=\"line\">200</div><div class=\"line\">201</div><div class=\"line\">202</div><div class=\"line\">203</div><div class=\"line\">204</div><div class=\"line\">205</div><div class=\"line\">206</div><div class=\"line\">207</div><div class=\"line\">208</div><div class=\"line\">209</div><div class=\"line\">210</div><div class=\"line\">211</div><div class=\"line\">212</div><div class=\"line\">213</div><div class=\"line\">214</div><div class=\"line\">215</div><div class=\"line\">216</div><div class=\"line\">217</div><div class=\"line\">218</div><div class=\"line\">219</div><div class=\"line\">220</div><div class=\"line\">221</div><div class=\"line\">222</div><div class=\"line\">223</div><div class=\"line\">224</div><div class=\"line\">225</div><div class=\"line\">226</div><div class=\"line\">227</div><div class=\"line\">228</div><div class=\"line\">229</div><div class=\"line\">230</div><div class=\"line\">231</div><div class=\"line\">232</div><div class=\"line\">233</div><div class=\"line\">234</div><div class=\"line\">235</div><div class=\"line\">236</div><div class=\"line\">237</div><div class=\"line\">238</div><div class=\"line\">239</div><div class=\"line\">240</div><div class=\"line\">241</div><div class=\"line\">242</div><div class=\"line\">243</div><div class=\"line\">244</div><div class=\"line\">245</div><div class=\"line\">246</div><div class=\"line\">247</div><div class=\"line\">248</div><div class=\"line\">249</div><div class=\"line\">250</div><div class=\"line\">251</div><div class=\"line\">252</div><div class=\"line\">253</div><div class=\"line\">254</div><div class=\"line\">255</div><div class=\"line\">256</div><div class=\"line\">257</div><div class=\"line\">258</div><div class=\"line\">259</div><div class=\"line\">260</div><div class=\"line\">261</div><div class=\"line\">262</div><div class=\"line\">263</div><div class=\"line\">264</div><div class=\"line\">265</div><div class=\"line\">266</div><div class=\"line\">267</div><div class=\"line\">268</div><div class=\"line\">269</div><div class=\"line\">270</div><div class=\"line\">271</div><div class=\"line\">272</div><div class=\"line\">273</div><div class=\"line\">274</div><div class=\"line\">275</div><div class=\"line\">276</div><div class=\"line\">277</div></pre></div><div class=\"code\"><pre><div class=\"line\"><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span></div><div class=\"line\"><span class=\"comment\">\" 显示相关  </span></div><div class=\"line\"><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"string\">\"set shortmess=atI   \"</span> 启动的时候不显示那个援助乌干达儿童的提示  </div><div class=\"line\"><span class=\"string\">\"winpos 5 5          \"</span> 设定窗口位置  </div><div class=\"line\"><span class=\"string\">\"set lines=40 columns=155    \"</span> 设定窗口大小  </div><div class=\"line\"><span class=\"string\">\"set nu              \"</span> 显示行号  </div><div class=\"line\"><span class=\"keyword\">set</span> <span class=\"keyword\">go</span>=              <span class=\"comment\">\" 不要图形按钮  </span></div><div class=\"line\"><span class=\"string\">\"color asmanian2     \"</span> 设置背景主题  </div><div class=\"line\"><span class=\"string\">\"syntax on           \"</span> 语法高亮  </div><div class=\"line\"><span class=\"keyword\">autocmd</span> InsertLeave * <span class=\"keyword\">se</span> nocul  <span class=\"comment\">\" 用浅色高亮当前行  </span></div><div class=\"line\"><span class=\"keyword\">autocmd</span> InsertEnter * <span class=\"keyword\">se</span> cul    <span class=\"comment\">\" 用浅色高亮当前行  </span></div><div class=\"line\"><span class=\"string\">\"set ruler           \"</span> 显示标尺  </div><div class=\"line\"><span class=\"keyword\">set</span> showcmd         <span class=\"comment\">\" 输入的命令显示出来，看的清楚些  </span></div><div class=\"line\"><span class=\"string\">\"set cmdheight=1     \"</span> 命令行（在状态行下）的高度，设置为<span class=\"number\">1</span>  </div><div class=\"line\"><span class=\"string\">\"set whichwrap+=&lt;,&gt;,h,l   \"</span> 允许backspace和光标键跨越行边界(不建议)  </div><div class=\"line\"><span class=\"string\">\"set scrolloff=3     \"</span> 光标移动到<span class=\"keyword\">buffer</span>的顶部和底部时保持<span class=\"number\">3</span>行距离  </div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">set</span> statusline=%F%<span class=\"keyword\">m</span>%r%h%<span class=\"keyword\">w</span>\\ [FORMAT=%&#123;&amp;ff&#125;]\\ [TYPE=%Y]\\ [POS=%<span class=\"keyword\">l</span>,%v][%<span class=\"keyword\">p</span>%%]\\ %&#123;<span class=\"built_in\">strftime</span>(\\<span class=\"string\">\"%d/%m/%y\\ -\\ %H:%M\\\")&#125;   \"</span>状态行显示的内容  </div><div class=\"line\"><span class=\"keyword\">set</span> laststatus=<span class=\"number\">1</span>    <span class=\"comment\">\" 启动显示状态行(1),总是显示状态行(2)  </span></div><div class=\"line\"><span class=\"keyword\">set</span> foldenable      <span class=\"comment\">\" 允许折叠  </span></div><div class=\"line\"><span class=\"keyword\">set</span> foldmethod=manual   <span class=\"comment\">\" 手动折叠  </span></div><div class=\"line\"><span class=\"string\">\"set background=dark \"</span>背景使用黑色 </div><div class=\"line\"><span class=\"keyword\">set</span> nocompatible  <span class=\"comment\">\"去掉讨厌的有关vi一致性模式，避免以前版本的一些bug和局限  </span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 显示中文帮助</span></div><div class=\"line\"><span class=\"keyword\">if</span> <span class=\"keyword\">version</span> &gt;= <span class=\"number\">603</span></div><div class=\"line\">    <span class=\"keyword\">set</span> helplang=<span class=\"keyword\">cn</span></div><div class=\"line\">    <span class=\"keyword\">set</span> encoding=utf-<span class=\"number\">8</span></div><div class=\"line\"><span class=\"keyword\">endif</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 设置配色方案</span></div><div class=\"line\"><span class=\"comment\">\"colorscheme murphy</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">set</span> fencs=utf-<span class=\"number\">8</span>,ucs-bom,shift-jis,gb18030,gbk,gb2312,cp936</div><div class=\"line\"><span class=\"keyword\">set</span> termencoding=utf-<span class=\"number\">8</span></div><div class=\"line\"><span class=\"keyword\">set</span> encoding=utf-<span class=\"number\">8</span></div><div class=\"line\"><span class=\"keyword\">set</span> fileencodings=ucs-bom,utf-<span class=\"number\">8</span>,cp936</div><div class=\"line\"><span class=\"keyword\">set</span> fileencoding=utf-<span class=\"number\">8</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span></div><div class=\"line\"><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"comment\">\"新文件标题</span></div><div class=\"line\"><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\"新建.c,.h,.sh,.java文件，自动插入文件头 </span></div><div class=\"line\"><span class=\"keyword\">autocmd</span> BufNewFile *.cpp,*.[ch],*.<span class=\"keyword\">sh</span>,*.java exec <span class=\"string\">\":call SetTitle()\"</span> </div><div class=\"line\"></div><div class=\"line\"><span class=\"string\">\"\"</span>定义函数SetTitle，自动插入文件头 </div><div class=\"line\">func SetTitle() </div><div class=\"line\">    <span class=\"comment\">\"如果文件类型为.sh文件 </span></div><div class=\"line\">    <span class=\"keyword\">if</span> &amp;<span class=\"keyword\">filetype</span> == <span class=\"string\">'sh'</span> </div><div class=\"line\">        <span class=\"keyword\">call</span> <span class=\"built_in\">setline</span>(<span class=\"number\">1</span>,<span class=\"string\">\"\\#########################################################################\"</span>) </div><div class=\"line\">        <span class=\"keyword\">call</span> <span class=\"keyword\">append</span>(<span class=\"built_in\">line</span>(<span class=\"string\">\".\"</span>), <span class=\"string\">\"\\# File Name: \"</span>.<span class=\"built_in\">expand</span>(<span class=\"string\">\"%\"</span>)) </div><div class=\"line\">        <span class=\"keyword\">call</span> <span class=\"keyword\">append</span>(<span class=\"built_in\">line</span>(<span class=\"string\">\".\"</span>)+<span class=\"number\">3</span>, <span class=\"string\">\"\\# Created Time: \"</span>.<span class=\"built_in\">strftime</span>(<span class=\"string\">\"%c\"</span>)) </div><div class=\"line\">        <span class=\"keyword\">call</span> <span class=\"keyword\">append</span>(<span class=\"built_in\">line</span>(<span class=\"string\">\".\"</span>)+<span class=\"number\">4</span>, <span class=\"string\">\"\\#########################################################################\"</span>) </div><div class=\"line\">        <span class=\"keyword\">call</span> <span class=\"keyword\">append</span>(<span class=\"built_in\">line</span>(<span class=\"string\">\".\"</span>)+<span class=\"number\">5</span>, <span class=\"string\">\"\\#!/bin/bash\"</span>) </div><div class=\"line\">        <span class=\"keyword\">call</span> <span class=\"keyword\">append</span>(<span class=\"built_in\">line</span>(<span class=\"string\">\".\"</span>)+<span class=\"number\">6</span>, <span class=\"string\">\"\"</span>) </div><div class=\"line\">    <span class=\"keyword\">else</span> </div><div class=\"line\">        <span class=\"keyword\">call</span> <span class=\"built_in\">setline</span>(<span class=\"number\">1</span>, <span class=\"string\">\"/*************************************************************************\"</span>) </div><div class=\"line\">        <span class=\"keyword\">call</span> <span class=\"keyword\">append</span>(<span class=\"built_in\">line</span>(<span class=\"string\">\".\"</span>), <span class=\"string\">\"    &gt; File Name: \"</span>.<span class=\"built_in\">expand</span>(<span class=\"string\">\"%\"</span>)) </div><div class=\"line\">        <span class=\"keyword\">call</span> <span class=\"keyword\">append</span>(<span class=\"built_in\">line</span>(<span class=\"string\">\".\"</span>)+<span class=\"number\">3</span>, <span class=\"string\">\"    &gt; Created Time: \"</span>.<span class=\"built_in\">strftime</span>(<span class=\"string\">\"%c\"</span>)) </div><div class=\"line\">        <span class=\"keyword\">call</span> <span class=\"keyword\">append</span>(<span class=\"built_in\">line</span>(<span class=\"string\">\".\"</span>)+<span class=\"number\">4</span>, <span class=\"string\">\" ************************************************************************/\"</span>) </div><div class=\"line\">        <span class=\"keyword\">call</span> <span class=\"keyword\">append</span>(<span class=\"built_in\">line</span>(<span class=\"string\">\".\"</span>)+<span class=\"number\">5</span>, <span class=\"string\">\"\"</span>)</div><div class=\"line\">    <span class=\"keyword\">endif</span></div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">if</span> &amp;<span class=\"keyword\">filetype</span> == <span class=\"string\">'cpp'</span></div><div class=\"line\">        <span class=\"keyword\">call</span> <span class=\"keyword\">append</span>(<span class=\"built_in\">line</span>(<span class=\"string\">\".\"</span>)+<span class=\"number\">6</span>, <span class=\"string\">\"#include&lt;iostream&gt;\"</span>)</div><div class=\"line\">        <span class=\"keyword\">call</span> <span class=\"keyword\">append</span>(<span class=\"built_in\">line</span>(<span class=\"string\">\".\"</span>)+<span class=\"number\">7</span>, <span class=\"string\">\"using namespace std;\"</span>)</div><div class=\"line\">        <span class=\"keyword\">call</span> <span class=\"keyword\">append</span>(<span class=\"built_in\">line</span>(<span class=\"string\">\".\"</span>)+<span class=\"number\">8</span>, <span class=\"string\">\"\"</span>)</div><div class=\"line\">    <span class=\"keyword\">endif</span></div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">if</span> &amp;<span class=\"keyword\">filetype</span> == <span class=\"string\">'c'</span></div><div class=\"line\">        <span class=\"keyword\">call</span> <span class=\"keyword\">append</span>(<span class=\"built_in\">line</span>(<span class=\"string\">\".\"</span>)+<span class=\"number\">6</span>, <span class=\"string\">\"#include&lt;stdio.h&gt;\"</span>)</div><div class=\"line\">        <span class=\"keyword\">call</span> <span class=\"keyword\">append</span>(<span class=\"built_in\">line</span>(<span class=\"string\">\".\"</span>)+<span class=\"number\">7</span>, <span class=\"string\">\"\"</span>)</div><div class=\"line\">    <span class=\"keyword\">endif</span></div><div class=\"line\">    <span class=\"comment\">\"新建文件后，自动定位到文件末尾</span></div><div class=\"line\">    <span class=\"keyword\">autocmd</span> BufNewFile * <span class=\"keyword\">normal</span> G</div><div class=\"line\">endfunc </div><div class=\"line\"></div><div class=\"line\"><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span></div><div class=\"line\"><span class=\"comment\">\"键盘命令</span></div><div class=\"line\"><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">nmap</span> <span class=\"symbol\">&lt;leader&gt;</span><span class=\"keyword\">w</span> :w!<span class=\"symbol\">&lt;cr&gt;</span></div><div class=\"line\"><span class=\"keyword\">nmap</span> <span class=\"symbol\">&lt;leader&gt;</span><span class=\"keyword\">f</span> :<span class=\"keyword\">find</span><span class=\"symbol\">&lt;cr&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\"去空行  </span></div><div class=\"line\"><span class=\"keyword\">nnoremap</span> <span class=\"symbol\">&lt;F2&gt;</span> :g/^\\s*$/d<span class=\"symbol\">&lt;CR&gt;</span> </div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\"比较文件  </span></div><div class=\"line\"><span class=\"keyword\">nnoremap</span> <span class=\"symbol\">&lt;C-F2&gt;</span> :<span class=\"keyword\">vert</span> <span class=\"keyword\">diffsplit</span> </div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\"新建标签  </span></div><div class=\"line\"><span class=\"keyword\">map</span> <span class=\"symbol\">&lt;M-F2&gt;</span> :<span class=\"keyword\">tabnew</span><span class=\"symbol\">&lt;CR&gt;</span>  </div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\"列出当前目录文件  </span></div><div class=\"line\"><span class=\"keyword\">map</span> <span class=\"symbol\">&lt;F3&gt;</span> :<span class=\"keyword\">tabnew</span> .<span class=\"symbol\">&lt;CR&gt;</span>  </div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\"打开树状文件目录  </span></div><div class=\"line\"><span class=\"keyword\">map</span> <span class=\"symbol\">&lt;C-F3&gt;</span> \\<span class=\"keyword\">be</span>  </div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span></div><div class=\"line\"><span class=\"string\">\"\"</span>实用设置</div><div class=\"line\"><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"comment\">\"</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 设置当文件被改动时自动载入</span></div><div class=\"line\"><span class=\"keyword\">set</span> autoread</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" quickfix模式</span></div><div class=\"line\"><span class=\"keyword\">autocmd</span> FileType <span class=\"keyword\">c</span>,cpp <span class=\"keyword\">map</span> <span class=\"symbol\">&lt;buffer&gt;</span> <span class=\"symbol\">&lt;leader&gt;</span><span class=\"symbol\">&lt;space&gt;</span> :<span class=\"keyword\">w</span><span class=\"symbol\">&lt;cr&gt;</span>:<span class=\"keyword\">make</span><span class=\"symbol\">&lt;cr&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\"代码补全 </span></div><div class=\"line\"><span class=\"keyword\">set</span> completeopt=preview,<span class=\"keyword\">menu</span> </div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\"允许插件  </span></div><div class=\"line\"><span class=\"keyword\">filetype</span> plugin <span class=\"keyword\">on</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\"共享剪贴板  </span></div><div class=\"line\"><span class=\"keyword\">set</span> clipboard+=unnamed </div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\"从不备份  </span></div><div class=\"line\"><span class=\"keyword\">set</span> nobackup</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\"make 运行</span></div><div class=\"line\">:<span class=\"keyword\">set</span> makeprg=g++\\ -Wall\\ \\ %</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\"自动保存</span></div><div class=\"line\"><span class=\"keyword\">set</span> autowrite</div><div class=\"line\"><span class=\"keyword\">set</span> ruler                   <span class=\"comment\">\" 打开状态栏标尺</span></div><div class=\"line\"><span class=\"keyword\">set</span> cursorline              <span class=\"comment\">\" 突出显示当前行</span></div><div class=\"line\"><span class=\"keyword\">set</span> magic                   <span class=\"comment\">\" 设置魔术</span></div><div class=\"line\"><span class=\"keyword\">set</span> guioptions-=T           <span class=\"comment\">\" 隐藏工具栏</span></div><div class=\"line\"><span class=\"keyword\">set</span> guioptions-=<span class=\"keyword\">m</span>           <span class=\"comment\">\" 隐藏菜单栏</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\"set statusline=\\ %&lt;%F[%1*%M%*%n%R%H]%=\\ %y\\ %0(%&#123;&amp;fileformat&#125;\\ %&#123;&amp;encoding&#125;\\ %c:%l/%L%)\\</span></div><div class=\"line\"><span class=\"comment\">\" 设置在状态行显示的信息</span></div><div class=\"line\"><span class=\"keyword\">set</span> foldcolumn=<span class=\"number\">0</span></div><div class=\"line\"><span class=\"keyword\">set</span> foldmethod=<span class=\"built_in\">indent</span> </div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 不要使用vi的键盘模式，而是vim自己的</span></div><div class=\"line\"><span class=\"keyword\">set</span> nocompatible</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 语法高亮</span></div><div class=\"line\"><span class=\"keyword\">set</span> <span class=\"keyword\">syntax</span>=<span class=\"keyword\">on</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 去掉输入错误的提示声音</span></div><div class=\"line\"><span class=\"keyword\">set</span> noeb</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 在处理未保存或只读文件的时候，弹出确认</span></div><div class=\"line\"><span class=\"keyword\">set</span> <span class=\"keyword\">confirm</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 自动缩进</span></div><div class=\"line\"><span class=\"keyword\">set</span> autoindent</div><div class=\"line\"><span class=\"keyword\">set</span> <span class=\"built_in\">cindent</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" Tab键的宽度</span></div><div class=\"line\"><span class=\"keyword\">set</span> tabstop=<span class=\"number\">4</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 统一缩进为4</span></div><div class=\"line\"><span class=\"keyword\">set</span> softtabstop=<span class=\"number\">4</span></div><div class=\"line\"><span class=\"keyword\">set</span> <span class=\"built_in\">shiftwidth</span>=<span class=\"number\">4</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 不要用空格代替制表符</span></div><div class=\"line\"><span class=\"keyword\">set</span> noexpandtab</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 在行和段开始处使用制表符</span></div><div class=\"line\"><span class=\"keyword\">set</span> smarttab</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 显示行号</span></div><div class=\"line\"><span class=\"keyword\">set</span> <span class=\"keyword\">number</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 历史记录数</span></div><div class=\"line\"><span class=\"keyword\">set</span> <span class=\"keyword\">history</span>=<span class=\"number\">1000</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\"禁止生成临时文件</span></div><div class=\"line\"><span class=\"keyword\">set</span> nobackup</div><div class=\"line\"><span class=\"keyword\">set</span> noswapfile</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\"搜索忽略大小写</span></div><div class=\"line\"><span class=\"keyword\">set</span> ignorecase</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\"搜索逐字符高亮</span></div><div class=\"line\"><span class=\"keyword\">set</span> hlsearch</div><div class=\"line\"><span class=\"keyword\">set</span> incsearch</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\"行内替换</span></div><div class=\"line\"><span class=\"keyword\">set</span> gdefault</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\"编码设置</span></div><div class=\"line\"><span class=\"keyword\">set</span> enc=utf-<span class=\"number\">8</span></div><div class=\"line\"><span class=\"keyword\">set</span> fencs=utf-<span class=\"number\">8</span>,ucs-bom,shift-jis,gb18030,gbk,gb2312,cp936</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\"语言设置</span></div><div class=\"line\"><span class=\"keyword\">set</span> langmenu=zh_CN.UTF-<span class=\"number\">8</span></div><div class=\"line\"><span class=\"keyword\">set</span> helplang=<span class=\"keyword\">cn</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 我的状态行显示的内容（包括文件类型和解码）</span></div><div class=\"line\"><span class=\"string\">\"set statusline=%F%m%r%h%w\\ [FORMAT=%&#123;&amp;ff&#125;]\\ [TYPE=%Y]\\ [POS=%l,%v][%p%%]\\ %&#123;strftime(\\\"%d/%m/%y\\ -\\ %H:%M\\\"</span>)&#125;</div><div class=\"line\"><span class=\"comment\">\"set statusline=[%F]%y%r%m%*%=[Line:%l/%L,Column:%c][%p%%]</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 总是显示状态行</span></div><div class=\"line\"><span class=\"keyword\">set</span> laststatus=<span class=\"number\">2</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 命令行（在状态行下）的高度，默认为1，这里是2</span></div><div class=\"line\"><span class=\"keyword\">set</span> cmdheight=<span class=\"number\">2</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 侦测文件类型</span></div><div class=\"line\"><span class=\"keyword\">filetype</span> <span class=\"keyword\">on</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 载入文件类型插件</span></div><div class=\"line\"><span class=\"keyword\">filetype</span> plugin <span class=\"keyword\">on</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 为特定文件类型载入相关缩进文件</span></div><div class=\"line\"><span class=\"keyword\">filetype</span> <span class=\"built_in\">indent</span> <span class=\"keyword\">on</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 保存全局变量</span></div><div class=\"line\"><span class=\"keyword\">set</span> viminfo+=!</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 带有如下符号的单词不要被换行分割</span></div><div class=\"line\"><span class=\"keyword\">set</span> iskeyword+=_,$,@,%,#,-</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 字符间插入的像素行数目</span></div><div class=\"line\"><span class=\"keyword\">set</span> linespace=<span class=\"number\">0</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 通过使用: commands命令，告诉我们文件的哪一行被改变过</span></div><div class=\"line\"><span class=\"keyword\">set</span> report=<span class=\"number\">0</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 在被分割的窗口间显示空白，便于阅读</span></div><div class=\"line\"><span class=\"keyword\">set</span> fillchars=ver<span class=\"variable\">t:</span>\\ ,<span class=\"keyword\">st</span><span class=\"variable\">l:</span>\\ ,stlnc:\\</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 高亮显示匹配的括号</span></div><div class=\"line\"><span class=\"keyword\">set</span> showmatch</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 匹配括号高亮的时间（单位是十分之一秒）</span></div><div class=\"line\"><span class=\"keyword\">set</span> matchtime=<span class=\"number\">1</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" 光标移动到buffer的顶部和底部时保持3行距离</span></div><div class=\"line\"><span class=\"keyword\">set</span> scrolloff=<span class=\"number\">3</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"comment\">\"</span></div><div class=\"line\"><span class=\"comment\">\" CTags的设定  </span></div><div class=\"line\"><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"comment\">\"</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">let</span> Tlist_Sort_Type = <span class=\"string\">\"name\"</span>    <span class=\"comment\">\" 按照名称排序  </span></div><div class=\"line\"><span class=\"keyword\">let</span> Tlist_Use_Right_Window = <span class=\"number\">1</span>  <span class=\"comment\">\" 在右侧显示窗口  </span></div><div class=\"line\"><span class=\"keyword\">let</span> Tlist_Compart_Format = <span class=\"number\">1</span>    <span class=\"comment\">\" 压缩方式  </span></div><div class=\"line\"><span class=\"keyword\">let</span> Tlist_Exist_OnlyWindow = <span class=\"number\">1</span>  <span class=\"comment\">\" 如果只有一个buffer，kill窗口也kill掉buffer  </span></div><div class=\"line\"><span class=\"keyword\">let</span> Tlist_File_Fold_Auto_Close = <span class=\"number\">0</span>  <span class=\"comment\">\" 不要关闭其他文件的tags  </span></div><div class=\"line\"><span class=\"keyword\">let</span> Tlist_Enable_Fold_Column = <span class=\"number\">0</span>    <span class=\"comment\">\" 不要显示折叠树  </span></div><div class=\"line\"><span class=\"string\">\"let Tlist_Show_One_File=1            \"</span>不同时显示多个文件的<span class=\"keyword\">tag</span>，只显示当前文件的</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\"设置tags  </span></div><div class=\"line\"><span class=\"keyword\">set</span> <span class=\"keyword\">tags</span>=<span class=\"keyword\">tags</span>  </div><div class=\"line\"><span class=\"comment\">\"set autochdir </span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\"默认打开Taglist </span></div><div class=\"line\"><span class=\"keyword\">let</span> Tlist_Auto_Open=<span class=\"number\">1</span> </div><div class=\"line\"></div><div class=\"line\"><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span> </div><div class=\"line\"><span class=\"comment\">\" Tag list (ctags) </span></div><div class=\"line\"><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span><span class=\"string\">\"\"</span> </div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">let</span> Tlist_Ctags_Cmd = <span class=\"string\">'/usr/bin/ctags'</span> </div><div class=\"line\"><span class=\"keyword\">let</span> Tlist_Show_One_File = <span class=\"number\">1</span> <span class=\"comment\">\"不同时显示多个文件的tag，只显示当前文件的 </span></div><div class=\"line\"><span class=\"keyword\">let</span> Tlist_Exit_OnlyWindow = <span class=\"number\">1</span> <span class=\"comment\">\"如果taglist窗口是最后一个窗口，则退出vim </span></div><div class=\"line\"><span class=\"keyword\">let</span> Tlist_Use_Right_Window = <span class=\"number\">1</span> <span class=\"comment\">\"在右侧窗口中显示taglist窗口</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">\" minibufexpl插件的一般设置</span></div><div class=\"line\"><span class=\"keyword\">let</span> <span class=\"variable\">g:miniBufExplMapWindowNavVim</span> = <span class=\"number\">1</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">let</span> <span class=\"variable\">g:miniBufExplMapWindowNavArrows</span> = <span class=\"number\">1</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">let</span> <span class=\"variable\">g:miniBufExplMapCTabSwitchBufs</span> = <span class=\"number\">1</span></div><div class=\"line\"><span class=\"keyword\">let</span> <span class=\"variable\">g:miniBufExplModSelTarget</span> = <span class=\"number\">1</span></div></pre></div></div></figure>\n<h1 id=\"其他命令\"><a href=\"#其他命令\" class=\"headerlink\" title=\"其他命令\"></a>其他命令</h1><p><a href=\"https://kjh123.github.io/2018/06/27/Linux%E5%91%BD%E4%BB%A4%E5%AD%A6%E4%B9%A0/\" target=\"_blank\" rel=\"noopener\">点击跳转</a></p>"},{"title":"shell代码自动部署脚本","date":"2018-07-10T04:44:47.000Z","_content":"> 服务器环境：Ubuntu 16.04\n此脚本仅适用于在多个服务器中有相同环境配置，以及相同的项目路径\n\n<!--more-->\n\n- 待优化的功能\n    - 操作日志记录\n    - 脚本执行文件锁\n    - 代码回滚操作\n    \n- 使用到的工具\n```bash\n# Git 代码版本管理\nsudo apt-get install git\n# expect 可以实现交互式通信\nsudo  apt-get install expect\n```\n- 相关代码\n```bash :deploy.sh\n#!/bin/bash\n# User: Hui\n# Date: 07/10\n\n#########################  ENV  ###############################\nTIME=$(date \"+%H-%M-%S\")\nCODE_DIR=\"/vagrant/jishu\"\nNETWORK='enp0s8'\n\nNAME=('测试1' '测试2')\nHOST=('192.168.33.10' '192.168.0.186')\nACCOUNT=('vagrant' 'vagrant')\nPASSWORD=('vagrant' 'vagrant')\n\n#########################  BASH  ##############################\nusage(){\n    echo \n    echo -e $\"\\e[1;32mUsage:\\e[0m\" \n    echo \"     $0 pull      拉取代码\"\n    echo \"     $0 rollback  回滚代码\"\n    echo \n}\n\n# 检测当前运行的主机\ncheck_host(){\n    IP=$(ifconfig $NETWORK| grep 'inet' | grep -oE \"[0-9\\.]+\" | head -n1)\n    for((i=0; i < ${#HOST[*]}; i++))\n    do\n        if [ ${HOST[$i]} == $IP ]; then\n            check_git_status ${HOST[$i]} ${i};\n        else\n            origin_pull ${HOST[$i]} ${i};\t\n        fi\n    done\n}\n\n# 检测当前的分支状态\ncheck_git_status(){\n    echo -e $\"\\e[1;32m正在同步 ${NAME[$2]}：$1 ------------\\e[0m\"\n    \n    cd $CODE_DIR\n    local git_status=$(git status 2> /dev/null | tail -n1) || $(git status 2> /dev/null | head -n 2 | tail -n1);\n    if [[ \"$git_status\" =~ nothing\\ to\\ commit || \"$git_status\" =~  Your\\ branch\\ is\\ up\\-to\\-date\\ with ]]; then\n        code_pull;\n    else\t\n        echo ${NAME[$2]}：$1 存在未提交的修改，请手动处理\n    fi\n}\n\n# 同步本地代码\ncode_pull(){\n    cd $CODE_DIR\n    git pull origin master\n}\n\n# 同步远程主机代码\norigin_pull(){\n    local _host=$1\n    local _account=${ACCOUNT[$2]}\n    local _password=${PASSWORD[$2]}\n    local _dir=${CODE_DIR}\n    /usr/bin/expect <<-EOF\n    set timeout 2\n    spawn ssh ${_account}@${_host} \"cd ${_dir} && git pull origin master\"\n    expect {\n        \"*yes/no\" { send \"yes\\r\"; exp_continue }\n        \"*password:\" { send \"${_password}\\r\"; exp_continue } \n        \"*https://gitee.com\": { send \"GitName\"; exp_continue } \n        \"Password*\": { send \"GitPassWord\"; exp_continue }\n    }\nEOF\n}\n\n# 代码回滚操作\nroll_back(){\n    echo rollback;\n}\n\nmain(){\n    case $1 in\n    pull)\n        check_host;\n        ;;\n    rollback)\n        roll_back;\n        ;;\n    *)\n        usage;\n    esac\n}\nmain $1\n\n```","source":"_posts/shell代码自动部署脚本.md","raw":"---\ntitle: shell代码自动部署脚本\ndate: 2018-07-10 12:44:47\ntags: [Linux, 命令, 服务器]\ncategories: Linux\n---\n> 服务器环境：Ubuntu 16.04\n此脚本仅适用于在多个服务器中有相同环境配置，以及相同的项目路径\n\n<!--more-->\n\n- 待优化的功能\n    - 操作日志记录\n    - 脚本执行文件锁\n    - 代码回滚操作\n    \n- 使用到的工具\n```bash\n# Git 代码版本管理\nsudo apt-get install git\n# expect 可以实现交互式通信\nsudo  apt-get install expect\n```\n- 相关代码\n```bash :deploy.sh\n#!/bin/bash\n# User: Hui\n# Date: 07/10\n\n#########################  ENV  ###############################\nTIME=$(date \"+%H-%M-%S\")\nCODE_DIR=\"/vagrant/jishu\"\nNETWORK='enp0s8'\n\nNAME=('测试1' '测试2')\nHOST=('192.168.33.10' '192.168.0.186')\nACCOUNT=('vagrant' 'vagrant')\nPASSWORD=('vagrant' 'vagrant')\n\n#########################  BASH  ##############################\nusage(){\n    echo \n    echo -e $\"\\e[1;32mUsage:\\e[0m\" \n    echo \"     $0 pull      拉取代码\"\n    echo \"     $0 rollback  回滚代码\"\n    echo \n}\n\n# 检测当前运行的主机\ncheck_host(){\n    IP=$(ifconfig $NETWORK| grep 'inet' | grep -oE \"[0-9\\.]+\" | head -n1)\n    for((i=0; i < ${#HOST[*]}; i++))\n    do\n        if [ ${HOST[$i]} == $IP ]; then\n            check_git_status ${HOST[$i]} ${i};\n        else\n            origin_pull ${HOST[$i]} ${i};\t\n        fi\n    done\n}\n\n# 检测当前的分支状态\ncheck_git_status(){\n    echo -e $\"\\e[1;32m正在同步 ${NAME[$2]}：$1 ------------\\e[0m\"\n    \n    cd $CODE_DIR\n    local git_status=$(git status 2> /dev/null | tail -n1) || $(git status 2> /dev/null | head -n 2 | tail -n1);\n    if [[ \"$git_status\" =~ nothing\\ to\\ commit || \"$git_status\" =~  Your\\ branch\\ is\\ up\\-to\\-date\\ with ]]; then\n        code_pull;\n    else\t\n        echo ${NAME[$2]}：$1 存在未提交的修改，请手动处理\n    fi\n}\n\n# 同步本地代码\ncode_pull(){\n    cd $CODE_DIR\n    git pull origin master\n}\n\n# 同步远程主机代码\norigin_pull(){\n    local _host=$1\n    local _account=${ACCOUNT[$2]}\n    local _password=${PASSWORD[$2]}\n    local _dir=${CODE_DIR}\n    /usr/bin/expect <<-EOF\n    set timeout 2\n    spawn ssh ${_account}@${_host} \"cd ${_dir} && git pull origin master\"\n    expect {\n        \"*yes/no\" { send \"yes\\r\"; exp_continue }\n        \"*password:\" { send \"${_password}\\r\"; exp_continue } \n        \"*https://gitee.com\": { send \"GitName\"; exp_continue } \n        \"Password*\": { send \"GitPassWord\"; exp_continue }\n    }\nEOF\n}\n\n# 代码回滚操作\nroll_back(){\n    echo rollback;\n}\n\nmain(){\n    case $1 in\n    pull)\n        check_host;\n        ;;\n    rollback)\n        roll_back;\n        ;;\n    *)\n        usage;\n    esac\n}\nmain $1\n\n```","slug":"shell代码自动部署脚本","published":1,"updated":"2018-11-08T04:19:01.042Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjopirm75000j2cwmpxfsn7o5","content":"<blockquote>\n<p>服务器环境：Ubuntu 16.04<br>此脚本仅适用于在多个服务器中有相同环境配置，以及相同的项目路径</p>\n</blockquote>\n<a id=\"more\"></a>\n<ul>\n<li><p>待优化的功能</p>\n<ul>\n<li>操作日志记录</li>\n<li>脚本执行文件锁</li>\n<li>代码回滚操作</li>\n</ul>\n</li>\n<li><p>使用到的工具</p>\n<figure class=\"highlight bash\"><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></div><div class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># Git 代码版本管理</span></div><div class=\"line\">sudo apt-get install git</div><div class=\"line\"><span class=\"comment\"># expect 可以实现交互式通信</span></div><div class=\"line\">sudo  apt-get install expect</div></pre></div></div></figure>\n</li>\n<li><p>相关代码</p>\n<figure class=\"highlight bash\"><figcaption><span class=\"caption\">deploy</span><span class=\"suffix\">.sh</span></figcaption><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div></pre></div><div class=\"code\"><pre><div class=\"line\"><span class=\"meta\">#!/bin/bash</span></div><div class=\"line\"><span class=\"comment\"># User: Hui</span></div><div class=\"line\"><span class=\"comment\"># Date: 07/10</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#########################  ENV  ###############################</span></div><div class=\"line\">TIME=$(date <span class=\"string\">\"+%H-%M-%S\"</span>)</div><div class=\"line\">CODE_DIR=<span class=\"string\">\"/vagrant/jishu\"</span></div><div class=\"line\">NETWORK=<span class=\"string\">'enp0s8'</span></div><div class=\"line\"></div><div class=\"line\">NAME=(<span class=\"string\">'测试1'</span> <span class=\"string\">'测试2'</span>)</div><div class=\"line\">HOST=(<span class=\"string\">'192.168.33.10'</span> <span class=\"string\">'192.168.0.186'</span>)</div><div class=\"line\">ACCOUNT=(<span class=\"string\">'vagrant'</span> <span class=\"string\">'vagrant'</span>)</div><div class=\"line\">PASSWORD=(<span class=\"string\">'vagrant'</span> <span class=\"string\">'vagrant'</span>)</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#########################  BASH  ##############################</span></div><div class=\"line\"><span class=\"function\"><span class=\"title\">usage</span></span>()&#123;</div><div class=\"line\">    <span class=\"built_in\">echo</span> </div><div class=\"line\">    <span class=\"built_in\">echo</span> -e $<span class=\"string\">\"\\e[1;32mUsage:\\e[0m\"</span> </div><div class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">\"     <span class=\"variable\">$0</span> pull      拉取代码\"</span></div><div class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">\"     <span class=\"variable\">$0</span> rollback  回滚代码\"</span></div><div class=\"line\">    <span class=\"built_in\">echo</span> </div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 检测当前运行的主机</span></div><div class=\"line\"><span class=\"function\"><span class=\"title\">check_host</span></span>()&#123;</div><div class=\"line\">    IP=$(ifconfig <span class=\"variable\">$NETWORK</span>| grep <span class=\"string\">'inet'</span> | grep -oE <span class=\"string\">\"[0-9\\.]+\"</span> | head -n1)</div><div class=\"line\">    <span class=\"keyword\">for</span>((i=0; i &lt; <span class=\"variable\">$&#123;#HOST[*]&#125;</span>; i++))</div><div class=\"line\">    <span class=\"keyword\">do</span></div><div class=\"line\">        <span class=\"keyword\">if</span> [ <span class=\"variable\">$&#123;HOST[$i]&#125;</span> == <span class=\"variable\">$IP</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">            check_git_status <span class=\"variable\">$&#123;HOST[$i]&#125;</span> <span class=\"variable\">$&#123;i&#125;</span>;</div><div class=\"line\">        <span class=\"keyword\">else</span></div><div class=\"line\">            origin_pull <span class=\"variable\">$&#123;HOST[$i]&#125;</span> <span class=\"variable\">$&#123;i&#125;</span>;\t</div><div class=\"line\">        <span class=\"keyword\">fi</span></div><div class=\"line\">    <span class=\"keyword\">done</span></div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 检测当前的分支状态</span></div><div class=\"line\"><span class=\"function\"><span class=\"title\">check_git_status</span></span>()&#123;</div><div class=\"line\">    <span class=\"built_in\">echo</span> -e $<span class=\"string\">\"\\e[1;32m正在同步 <span class=\"variable\">$&#123;NAME[$2]&#125;</span>：<span class=\"variable\">$1</span> ------------\\e[0m\"</span></div><div class=\"line\">    </div><div class=\"line\">    <span class=\"built_in\">cd</span> <span class=\"variable\">$CODE_DIR</span></div><div class=\"line\">    <span class=\"built_in\">local</span> git_status=$(git status 2&gt; /dev/null | tail -n1) || $(git status 2&gt; /dev/null | head -n 2 | tail -n1);</div><div class=\"line\">    <span class=\"keyword\">if</span> [[ <span class=\"string\">\"<span class=\"variable\">$git_status</span>\"</span> =~ nothing\\ to\\ commit || <span class=\"string\">\"<span class=\"variable\">$git_status</span>\"</span> =~  Your\\ branch\\ is\\ up\\-to\\-date\\ with ]]; <span class=\"keyword\">then</span></div><div class=\"line\">        code_pull;</div><div class=\"line\">    <span class=\"keyword\">else</span>\t</div><div class=\"line\">        <span class=\"built_in\">echo</span> <span class=\"variable\">$&#123;NAME[$2]&#125;</span>：<span class=\"variable\">$1</span> 存在未提交的修改，请手动处理</div><div class=\"line\">    <span class=\"keyword\">fi</span></div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 同步本地代码</span></div><div class=\"line\"><span class=\"function\"><span class=\"title\">code_pull</span></span>()&#123;</div><div class=\"line\">    <span class=\"built_in\">cd</span> <span class=\"variable\">$CODE_DIR</span></div><div class=\"line\">    git pull origin master</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 同步远程主机代码</span></div><div class=\"line\"><span class=\"function\"><span class=\"title\">origin_pull</span></span>()&#123;</div><div class=\"line\">    <span class=\"built_in\">local</span> _host=<span class=\"variable\">$1</span></div><div class=\"line\">    <span class=\"built_in\">local</span> _account=<span class=\"variable\">$&#123;ACCOUNT[$2]&#125;</span></div><div class=\"line\">    <span class=\"built_in\">local</span> _password=<span class=\"variable\">$&#123;PASSWORD[$2]&#125;</span></div><div class=\"line\">    <span class=\"built_in\">local</span> _dir=<span class=\"variable\">$&#123;CODE_DIR&#125;</span></div><div class=\"line\">    /usr/bin/expect &lt;&lt;-EOF</div><div class=\"line\">    <span class=\"built_in\">set</span> timeout 2</div><div class=\"line\">    spawn ssh <span class=\"variable\">$&#123;_account&#125;</span>@<span class=\"variable\">$&#123;_host&#125;</span> <span class=\"string\">\"cd <span class=\"variable\">$&#123;_dir&#125;</span> &amp;&amp; git pull origin master\"</span></div><div class=\"line\">    expect &#123;</div><div class=\"line\">        <span class=\"string\">\"*yes/no\"</span> &#123; send <span class=\"string\">\"yes\\r\"</span>; exp_continue &#125;</div><div class=\"line\">        <span class=\"string\">\"*password:\"</span> &#123; send <span class=\"string\">\"<span class=\"variable\">$&#123;_password&#125;</span>\\r\"</span>; exp_continue &#125; </div><div class=\"line\">        <span class=\"string\">\"*https://gitee.com\"</span>: &#123; send <span class=\"string\">\"GitName\"</span>; exp_continue &#125; </div><div class=\"line\">        <span class=\"string\">\"Password*\"</span>: &#123; send <span class=\"string\">\"GitPassWord\"</span>; exp_continue &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">EOF</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 代码回滚操作</span></div><div class=\"line\"><span class=\"function\"><span class=\"title\">roll_back</span></span>()&#123;</div><div class=\"line\">    <span class=\"built_in\">echo</span> rollback;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"title\">main</span></span>()&#123;</div><div class=\"line\">    <span class=\"keyword\">case</span> <span class=\"variable\">$1</span> <span class=\"keyword\">in</span></div><div class=\"line\">    pull)</div><div class=\"line\">        check_host;</div><div class=\"line\">        ;;</div><div class=\"line\">    rollback)</div><div class=\"line\">        roll_back;</div><div class=\"line\">        ;;</div><div class=\"line\">    *)</div><div class=\"line\">        usage;</div><div class=\"line\">    <span class=\"keyword\">esac</span></div><div class=\"line\">&#125;</div><div class=\"line\">main <span class=\"variable\">$1</span></div></pre></div></div></figure></li>\n</ul>\n","site":{"data":{}},"excerpt":"<blockquote>\n<p>服务器环境：Ubuntu 16.04<br>此脚本仅适用于在多个服务器中有相同环境配置，以及相同的项目路径</p>\n</blockquote>","more":"<ul>\n<li><p>待优化的功能</p>\n<ul>\n<li>操作日志记录</li>\n<li>脚本执行文件锁</li>\n<li>代码回滚操作</li>\n</ul>\n</li>\n<li><p>使用到的工具</p>\n<figure class=\"highlight bash\"><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></div><div class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># Git 代码版本管理</span></div><div class=\"line\">sudo apt-get install git</div><div class=\"line\"><span class=\"comment\"># expect 可以实现交互式通信</span></div><div class=\"line\">sudo  apt-get install expect</div></pre></div></div></figure>\n</li>\n<li><p>相关代码</p>\n<figure class=\"highlight bash\"><figcaption><span class=\"caption\">deploy</span><span class=\"suffix\">.sh</span></figcaption><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div></pre></div><div class=\"code\"><pre><div class=\"line\"><span class=\"meta\">#!/bin/bash</span></div><div class=\"line\"><span class=\"comment\"># User: Hui</span></div><div class=\"line\"><span class=\"comment\"># Date: 07/10</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#########################  ENV  ###############################</span></div><div class=\"line\">TIME=$(date <span class=\"string\">\"+%H-%M-%S\"</span>)</div><div class=\"line\">CODE_DIR=<span class=\"string\">\"/vagrant/jishu\"</span></div><div class=\"line\">NETWORK=<span class=\"string\">'enp0s8'</span></div><div class=\"line\"></div><div class=\"line\">NAME=(<span class=\"string\">'测试1'</span> <span class=\"string\">'测试2'</span>)</div><div class=\"line\">HOST=(<span class=\"string\">'192.168.33.10'</span> <span class=\"string\">'192.168.0.186'</span>)</div><div class=\"line\">ACCOUNT=(<span class=\"string\">'vagrant'</span> <span class=\"string\">'vagrant'</span>)</div><div class=\"line\">PASSWORD=(<span class=\"string\">'vagrant'</span> <span class=\"string\">'vagrant'</span>)</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#########################  BASH  ##############################</span></div><div class=\"line\"><span class=\"function\"><span class=\"title\">usage</span></span>()&#123;</div><div class=\"line\">    <span class=\"built_in\">echo</span> </div><div class=\"line\">    <span class=\"built_in\">echo</span> -e $<span class=\"string\">\"\\e[1;32mUsage:\\e[0m\"</span> </div><div class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">\"     <span class=\"variable\">$0</span> pull      拉取代码\"</span></div><div class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">\"     <span class=\"variable\">$0</span> rollback  回滚代码\"</span></div><div class=\"line\">    <span class=\"built_in\">echo</span> </div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 检测当前运行的主机</span></div><div class=\"line\"><span class=\"function\"><span class=\"title\">check_host</span></span>()&#123;</div><div class=\"line\">    IP=$(ifconfig <span class=\"variable\">$NETWORK</span>| grep <span class=\"string\">'inet'</span> | grep -oE <span class=\"string\">\"[0-9\\.]+\"</span> | head -n1)</div><div class=\"line\">    <span class=\"keyword\">for</span>((i=0; i &lt; <span class=\"variable\">$&#123;#HOST[*]&#125;</span>; i++))</div><div class=\"line\">    <span class=\"keyword\">do</span></div><div class=\"line\">        <span class=\"keyword\">if</span> [ <span class=\"variable\">$&#123;HOST[$i]&#125;</span> == <span class=\"variable\">$IP</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">            check_git_status <span class=\"variable\">$&#123;HOST[$i]&#125;</span> <span class=\"variable\">$&#123;i&#125;</span>;</div><div class=\"line\">        <span class=\"keyword\">else</span></div><div class=\"line\">            origin_pull <span class=\"variable\">$&#123;HOST[$i]&#125;</span> <span class=\"variable\">$&#123;i&#125;</span>;\t</div><div class=\"line\">        <span class=\"keyword\">fi</span></div><div class=\"line\">    <span class=\"keyword\">done</span></div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 检测当前的分支状态</span></div><div class=\"line\"><span class=\"function\"><span class=\"title\">check_git_status</span></span>()&#123;</div><div class=\"line\">    <span class=\"built_in\">echo</span> -e $<span class=\"string\">\"\\e[1;32m正在同步 <span class=\"variable\">$&#123;NAME[$2]&#125;</span>：<span class=\"variable\">$1</span> ------------\\e[0m\"</span></div><div class=\"line\">    </div><div class=\"line\">    <span class=\"built_in\">cd</span> <span class=\"variable\">$CODE_DIR</span></div><div class=\"line\">    <span class=\"built_in\">local</span> git_status=$(git status 2&gt; /dev/null | tail -n1) || $(git status 2&gt; /dev/null | head -n 2 | tail -n1);</div><div class=\"line\">    <span class=\"keyword\">if</span> [[ <span class=\"string\">\"<span class=\"variable\">$git_status</span>\"</span> =~ nothing\\ to\\ commit || <span class=\"string\">\"<span class=\"variable\">$git_status</span>\"</span> =~  Your\\ branch\\ is\\ up\\-to\\-date\\ with ]]; <span class=\"keyword\">then</span></div><div class=\"line\">        code_pull;</div><div class=\"line\">    <span class=\"keyword\">else</span>\t</div><div class=\"line\">        <span class=\"built_in\">echo</span> <span class=\"variable\">$&#123;NAME[$2]&#125;</span>：<span class=\"variable\">$1</span> 存在未提交的修改，请手动处理</div><div class=\"line\">    <span class=\"keyword\">fi</span></div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 同步本地代码</span></div><div class=\"line\"><span class=\"function\"><span class=\"title\">code_pull</span></span>()&#123;</div><div class=\"line\">    <span class=\"built_in\">cd</span> <span class=\"variable\">$CODE_DIR</span></div><div class=\"line\">    git pull origin master</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 同步远程主机代码</span></div><div class=\"line\"><span class=\"function\"><span class=\"title\">origin_pull</span></span>()&#123;</div><div class=\"line\">    <span class=\"built_in\">local</span> _host=<span class=\"variable\">$1</span></div><div class=\"line\">    <span class=\"built_in\">local</span> _account=<span class=\"variable\">$&#123;ACCOUNT[$2]&#125;</span></div><div class=\"line\">    <span class=\"built_in\">local</span> _password=<span class=\"variable\">$&#123;PASSWORD[$2]&#125;</span></div><div class=\"line\">    <span class=\"built_in\">local</span> _dir=<span class=\"variable\">$&#123;CODE_DIR&#125;</span></div><div class=\"line\">    /usr/bin/expect &lt;&lt;-EOF</div><div class=\"line\">    <span class=\"built_in\">set</span> timeout 2</div><div class=\"line\">    spawn ssh <span class=\"variable\">$&#123;_account&#125;</span>@<span class=\"variable\">$&#123;_host&#125;</span> <span class=\"string\">\"cd <span class=\"variable\">$&#123;_dir&#125;</span> &amp;&amp; git pull origin master\"</span></div><div class=\"line\">    expect &#123;</div><div class=\"line\">        <span class=\"string\">\"*yes/no\"</span> &#123; send <span class=\"string\">\"yes\\r\"</span>; exp_continue &#125;</div><div class=\"line\">        <span class=\"string\">\"*password:\"</span> &#123; send <span class=\"string\">\"<span class=\"variable\">$&#123;_password&#125;</span>\\r\"</span>; exp_continue &#125; </div><div class=\"line\">        <span class=\"string\">\"*https://gitee.com\"</span>: &#123; send <span class=\"string\">\"GitName\"</span>; exp_continue &#125; </div><div class=\"line\">        <span class=\"string\">\"Password*\"</span>: &#123; send <span class=\"string\">\"GitPassWord\"</span>; exp_continue &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">EOF</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 代码回滚操作</span></div><div class=\"line\"><span class=\"function\"><span class=\"title\">roll_back</span></span>()&#123;</div><div class=\"line\">    <span class=\"built_in\">echo</span> rollback;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"title\">main</span></span>()&#123;</div><div class=\"line\">    <span class=\"keyword\">case</span> <span class=\"variable\">$1</span> <span class=\"keyword\">in</span></div><div class=\"line\">    pull)</div><div class=\"line\">        check_host;</div><div class=\"line\">        ;;</div><div class=\"line\">    rollback)</div><div class=\"line\">        roll_back;</div><div class=\"line\">        ;;</div><div class=\"line\">    *)</div><div class=\"line\">        usage;</div><div class=\"line\">    <span class=\"keyword\">esac</span></div><div class=\"line\">&#125;</div><div class=\"line\">main <span class=\"variable\">$1</span></div></pre></div></div></figure></li>\n</ul>"},{"title":"搭建博客记录","date":"2018-05-20T07:10:43.000Z","_content":"> 动手搭建 Hexo 博客, 写个日志记录一下\n\n<blockquote class=\"blockquote-center\">学无止境</blockquote>\n\n<!--more-->\n\n## 安装 Git \n\n* Windows: [点击跳转到Git下载](https://git-scm.com/download/win)\n* Linux:\n - Ubuntu/Debian: `sudo apt-get install git-core`\n - Red Hat/Center OS  `sudo yum install git-core`\n\n## 安装 Node.js\n\n> Hexo 推荐使用 **NVM** (Node Version Manager) 安装\n\ncURL:\n```shell\ncurl -o- https://raw.githubusercontent.com/creationix/nvm/v0.33.2/install.sh | bash\n```\nWget:\n```shell\nwget -qO- https://raw.githubusercontent.com/creationix/nvm/v0.33.2/install.sh | bash\n```\nnvm安装成功后，重新启动终端并运行以下命令来安装Node.js：\n```shell\nnvm install stable\n```\n或者[点击此处](https://nodejs.org)下载并安装\n\n> ![检查node](http://oyvpp7gqd.bkt.clouddn.com/18-5-14/1022082.jpg)\n\n## 安装 Hexo\n```npm\nnpm install -g hexo \n```\n> ![检查Hexo](http://oyvpp7gqd.bkt.clouddn.com/18-5-14/15765643.jpg)\n\n## 创建博客项目\n在合适的位置下初始化hexo,比如 *d:/blog*\n```\nhexo init\t\t# 初始化 hexo\nnpm install\t\t# 安装组件\nhexo g\t\t\t# hexo generated\n```\n安装完成后，输入 hexo s 开启 hexo 服务器\n> 正常情况下会显示 Hexo is running at http://localhost:4000. Press `Ctrl+C` to stop.\n如果4000端口被占用可以ctrl+c停止服务器然后输入 `hexo server -p 端口号` 访问\n\n![运行成功](http://oyvpp7gqd.bkt.clouddn.com/18-5-14/67034961.jpg)\n\n## GitHub 上新建项目\n**项目命名注意：自己的github用户名.github.io**\n![](http://oyvpp7gqd.bkt.clouddn.com/18-5-14/78195897.jpg)\n\nGit下生成 SSH Keys 参照[SSH Key生成步骤](https://blog.csdn.net/hustpzb/article/details/8230454), 将生成好的ssh key 添加到github上\n![github-ssh-key](http://oyvpp7gqd.bkt.clouddn.com/18-5-14/88681793.jpg) \n>配置完成后在Git Bash测试\n![git-key-check](http://oyvpp7gqd.bkt.clouddn.com/18-5-14/99272918.jpg)\n \n## Hexo 配置\n在blog文件夹下，修改 _config.yml 文件中 `deploy` 的 repo 地址\n![dev-repo](http://oyvpp7gqd.bkt.clouddn.com/18-5-14/9649267.jpg)\n要同步部署文章还需要再添加一个npm扩展：`npm install hexo-deployer-git --save`\n\n## 测试\n使用 `hexo new post \"hello hexo\"` 新建一遍文章，新生成的文章在 `blog/source/_posts` 下，使用MarkDown语法编辑\n完成后先在本地预览 `http://localhost:4000`\n最后使用 hexo d -g 命令同步到github上，可以在浏览器上使用 https://username.github.io 查看\n\n","source":"_posts/搭建博客记录.md","raw":"---\ntitle: 搭建博客记录\ndate: 2018-05-20 15:10:43\ntags: [博客, 记录]\ncategories: 记录\n---\n> 动手搭建 Hexo 博客, 写个日志记录一下\n\n<blockquote class=\"blockquote-center\">学无止境</blockquote>\n\n<!--more-->\n\n## 安装 Git \n\n* Windows: [点击跳转到Git下载](https://git-scm.com/download/win)\n* Linux:\n - Ubuntu/Debian: `sudo apt-get install git-core`\n - Red Hat/Center OS  `sudo yum install git-core`\n\n## 安装 Node.js\n\n> Hexo 推荐使用 **NVM** (Node Version Manager) 安装\n\ncURL:\n```shell\ncurl -o- https://raw.githubusercontent.com/creationix/nvm/v0.33.2/install.sh | bash\n```\nWget:\n```shell\nwget -qO- https://raw.githubusercontent.com/creationix/nvm/v0.33.2/install.sh | bash\n```\nnvm安装成功后，重新启动终端并运行以下命令来安装Node.js：\n```shell\nnvm install stable\n```\n或者[点击此处](https://nodejs.org)下载并安装\n\n> ![检查node](http://oyvpp7gqd.bkt.clouddn.com/18-5-14/1022082.jpg)\n\n## 安装 Hexo\n```npm\nnpm install -g hexo \n```\n> ![检查Hexo](http://oyvpp7gqd.bkt.clouddn.com/18-5-14/15765643.jpg)\n\n## 创建博客项目\n在合适的位置下初始化hexo,比如 *d:/blog*\n```\nhexo init\t\t# 初始化 hexo\nnpm install\t\t# 安装组件\nhexo g\t\t\t# hexo generated\n```\n安装完成后，输入 hexo s 开启 hexo 服务器\n> 正常情况下会显示 Hexo is running at http://localhost:4000. Press `Ctrl+C` to stop.\n如果4000端口被占用可以ctrl+c停止服务器然后输入 `hexo server -p 端口号` 访问\n\n![运行成功](http://oyvpp7gqd.bkt.clouddn.com/18-5-14/67034961.jpg)\n\n## GitHub 上新建项目\n**项目命名注意：自己的github用户名.github.io**\n![](http://oyvpp7gqd.bkt.clouddn.com/18-5-14/78195897.jpg)\n\nGit下生成 SSH Keys 参照[SSH Key生成步骤](https://blog.csdn.net/hustpzb/article/details/8230454), 将生成好的ssh key 添加到github上\n![github-ssh-key](http://oyvpp7gqd.bkt.clouddn.com/18-5-14/88681793.jpg) \n>配置完成后在Git Bash测试\n![git-key-check](http://oyvpp7gqd.bkt.clouddn.com/18-5-14/99272918.jpg)\n \n## Hexo 配置\n在blog文件夹下，修改 _config.yml 文件中 `deploy` 的 repo 地址\n![dev-repo](http://oyvpp7gqd.bkt.clouddn.com/18-5-14/9649267.jpg)\n要同步部署文章还需要再添加一个npm扩展：`npm install hexo-deployer-git --save`\n\n## 测试\n使用 `hexo new post \"hello hexo\"` 新建一遍文章，新生成的文章在 `blog/source/_posts` 下，使用MarkDown语法编辑\n完成后先在本地预览 `http://localhost:4000`\n最后使用 hexo d -g 命令同步到github上，可以在浏览器上使用 https://username.github.io 查看\n\n","slug":"搭建博客记录","published":1,"updated":"2018-11-08T04:19:01.063Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjopirm7a000n2cwm9byaav3z","content":"<blockquote>\n<p>动手搭建 Hexo 博客, 写个日志记录一下</p>\n</blockquote>\n<blockquote class=\"blockquote-center\">学无止境</blockquote>\n\n<a id=\"more\"></a>\n<h2 id=\"安装-Git\"><a href=\"#安装-Git\" class=\"headerlink\" title=\"安装 Git\"></a>安装 Git</h2><ul>\n<li>Windows: <a href=\"https://git-scm.com/download/win\" target=\"_blank\" rel=\"noopener\">点击跳转到Git下载</a></li>\n<li>Linux:<ul>\n<li>Ubuntu/Debian: <code>sudo apt-get install git-core</code></li>\n<li>Red Hat/Center OS  <code>sudo yum install git-core</code></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"安装-Node-js\"><a href=\"#安装-Node-js\" class=\"headerlink\" title=\"安装 Node.js\"></a>安装 Node.js</h2><blockquote>\n<p>Hexo 推荐使用 <strong>NVM</strong> (Node Version Manager) 安装</p>\n</blockquote>\n<p>cURL:<br><figure class=\"highlight shell\"><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div></pre></div><div class=\"code\"><pre><div class=\"line\">curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.33.2/install.sh | bash</div></pre></div></div></figure></p>\n<p>Wget:<br><figure class=\"highlight shell\"><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div></pre></div><div class=\"code\"><pre><div class=\"line\">wget -qO- https://raw.githubusercontent.com/creationix/nvm/v0.33.2/install.sh | bash</div></pre></div></div></figure></p>\n<p>nvm安装成功后，重新启动终端并运行以下命令来安装Node.js：<br><figure class=\"highlight shell\"><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div></pre></div><div class=\"code\"><pre><div class=\"line\">nvm install stable</div></pre></div></div></figure></p>\n<p>或者<a href=\"https://nodejs.org\" target=\"_blank\" rel=\"noopener\">点击此处</a>下载并安装</p>\n<blockquote>\n<p><img src=\"http://oyvpp7gqd.bkt.clouddn.com/18-5-14/1022082.jpg\" alt=\"检查node\"></p>\n</blockquote>\n<h2 id=\"安装-Hexo\"><a href=\"#安装-Hexo\" class=\"headerlink\" title=\"安装 Hexo\"></a>安装 Hexo</h2><figure class=\"highlight plain\"><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div></pre></div><div class=\"code\"><pre><div class=\"line\">npm install -g hexo</div></pre></div></div></figure>\n<blockquote>\n<p><img src=\"http://oyvpp7gqd.bkt.clouddn.com/18-5-14/15765643.jpg\" alt=\"检查Hexo\"></p>\n</blockquote>\n<h2 id=\"创建博客项目\"><a href=\"#创建博客项目\" class=\"headerlink\" title=\"创建博客项目\"></a>创建博客项目</h2><p>在合适的位置下初始化hexo,比如 <em>d:/blog</em><br><figure class=\"highlight plain\"><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></div><div class=\"code\"><pre><div class=\"line\">hexo init\t\t# 初始化 hexo</div><div class=\"line\">npm install\t\t# 安装组件</div><div class=\"line\">hexo g\t\t\t# hexo generated</div></pre></div></div></figure></p>\n<p>安装完成后，输入 hexo s 开启 hexo 服务器</p>\n<blockquote>\n<p>正常情况下会显示 Hexo is running at <a href=\"http://localhost:4000\" target=\"_blank\" rel=\"noopener\">http://localhost:4000</a>. Press <code>Ctrl+C</code> to stop.<br>如果4000端口被占用可以ctrl+c停止服务器然后输入 <code>hexo server -p 端口号</code> 访问</p>\n</blockquote>\n<p><img src=\"http://oyvpp7gqd.bkt.clouddn.com/18-5-14/67034961.jpg\" alt=\"运行成功\"></p>\n<h2 id=\"GitHub-上新建项目\"><a href=\"#GitHub-上新建项目\" class=\"headerlink\" title=\"GitHub 上新建项目\"></a>GitHub 上新建项目</h2><p><strong>项目命名注意：自己的github用户名.github.io</strong><br><img src=\"http://oyvpp7gqd.bkt.clouddn.com/18-5-14/78195897.jpg\" alt=\"\"></p>\n<p>Git下生成 SSH Keys 参照<a href=\"https://blog.csdn.net/hustpzb/article/details/8230454\" target=\"_blank\" rel=\"noopener\">SSH Key生成步骤</a>, 将生成好的ssh key 添加到github上<br><img src=\"http://oyvpp7gqd.bkt.clouddn.com/18-5-14/88681793.jpg\" alt=\"github-ssh-key\"> </p>\n<blockquote>\n<p>配置完成后在Git Bash测试<br><img src=\"http://oyvpp7gqd.bkt.clouddn.com/18-5-14/99272918.jpg\" alt=\"git-key-check\"></p>\n</blockquote>\n<h2 id=\"Hexo-配置\"><a href=\"#Hexo-配置\" class=\"headerlink\" title=\"Hexo 配置\"></a>Hexo 配置</h2><p>在blog文件夹下，修改 _config.yml 文件中 <code>deploy</code> 的 repo 地址<br><img src=\"http://oyvpp7gqd.bkt.clouddn.com/18-5-14/9649267.jpg\" alt=\"dev-repo\"><br>要同步部署文章还需要再添加一个npm扩展：<code>npm install hexo-deployer-git --save</code></p>\n<h2 id=\"测试\"><a href=\"#测试\" class=\"headerlink\" title=\"测试\"></a>测试</h2><p>使用 <code>hexo new post &quot;hello hexo&quot;</code> 新建一遍文章，新生成的文章在 <code>blog/source/_posts</code> 下，使用MarkDown语法编辑<br>完成后先在本地预览 <code>http://localhost:4000</code><br>最后使用 hexo d -g 命令同步到github上，可以在浏览器上使用 <a href=\"https://username.github.io\" target=\"_blank\" rel=\"noopener\">https://username.github.io</a> 查看</p>\n","site":{"data":{}},"excerpt":"<blockquote>\n<p>动手搭建 Hexo 博客, 写个日志记录一下</p>\n</blockquote>\n<blockquote class=\"blockquote-center\">学无止境</blockquote>","more":"<h2 id=\"安装-Git\"><a href=\"#安装-Git\" class=\"headerlink\" title=\"安装 Git\"></a>安装 Git</h2><ul>\n<li>Windows: <a href=\"https://git-scm.com/download/win\" target=\"_blank\" rel=\"noopener\">点击跳转到Git下载</a></li>\n<li>Linux:<ul>\n<li>Ubuntu/Debian: <code>sudo apt-get install git-core</code></li>\n<li>Red Hat/Center OS  <code>sudo yum install git-core</code></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"安装-Node-js\"><a href=\"#安装-Node-js\" class=\"headerlink\" title=\"安装 Node.js\"></a>安装 Node.js</h2><blockquote>\n<p>Hexo 推荐使用 <strong>NVM</strong> (Node Version Manager) 安装</p>\n</blockquote>\n<p>cURL:<br><figure class=\"highlight shell\"><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div></pre></div><div class=\"code\"><pre><div class=\"line\">curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.33.2/install.sh | bash</div></pre></div></div></figure></p>\n<p>Wget:<br><figure class=\"highlight shell\"><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div></pre></div><div class=\"code\"><pre><div class=\"line\">wget -qO- https://raw.githubusercontent.com/creationix/nvm/v0.33.2/install.sh | bash</div></pre></div></div></figure></p>\n<p>nvm安装成功后，重新启动终端并运行以下命令来安装Node.js：<br><figure class=\"highlight shell\"><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div></pre></div><div class=\"code\"><pre><div class=\"line\">nvm install stable</div></pre></div></div></figure></p>\n<p>或者<a href=\"https://nodejs.org\" target=\"_blank\" rel=\"noopener\">点击此处</a>下载并安装</p>\n<blockquote>\n<p><img src=\"http://oyvpp7gqd.bkt.clouddn.com/18-5-14/1022082.jpg\" alt=\"检查node\"></p>\n</blockquote>\n<h2 id=\"安装-Hexo\"><a href=\"#安装-Hexo\" class=\"headerlink\" title=\"安装 Hexo\"></a>安装 Hexo</h2><figure class=\"highlight plain\"><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div></pre></div><div class=\"code\"><pre><div class=\"line\">npm install -g hexo</div></pre></div></div></figure>\n<blockquote>\n<p><img src=\"http://oyvpp7gqd.bkt.clouddn.com/18-5-14/15765643.jpg\" alt=\"检查Hexo\"></p>\n</blockquote>\n<h2 id=\"创建博客项目\"><a href=\"#创建博客项目\" class=\"headerlink\" title=\"创建博客项目\"></a>创建博客项目</h2><p>在合适的位置下初始化hexo,比如 <em>d:/blog</em><br><figure class=\"highlight plain\"><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></div><div class=\"code\"><pre><div class=\"line\">hexo init\t\t# 初始化 hexo</div><div class=\"line\">npm install\t\t# 安装组件</div><div class=\"line\">hexo g\t\t\t# hexo generated</div></pre></div></div></figure></p>\n<p>安装完成后，输入 hexo s 开启 hexo 服务器</p>\n<blockquote>\n<p>正常情况下会显示 Hexo is running at <a href=\"http://localhost:4000\" target=\"_blank\" rel=\"noopener\">http://localhost:4000</a>. Press <code>Ctrl+C</code> to stop.<br>如果4000端口被占用可以ctrl+c停止服务器然后输入 <code>hexo server -p 端口号</code> 访问</p>\n</blockquote>\n<p><img src=\"http://oyvpp7gqd.bkt.clouddn.com/18-5-14/67034961.jpg\" alt=\"运行成功\"></p>\n<h2 id=\"GitHub-上新建项目\"><a href=\"#GitHub-上新建项目\" class=\"headerlink\" title=\"GitHub 上新建项目\"></a>GitHub 上新建项目</h2><p><strong>项目命名注意：自己的github用户名.github.io</strong><br><img src=\"http://oyvpp7gqd.bkt.clouddn.com/18-5-14/78195897.jpg\" alt=\"\"></p>\n<p>Git下生成 SSH Keys 参照<a href=\"https://blog.csdn.net/hustpzb/article/details/8230454\" target=\"_blank\" rel=\"noopener\">SSH Key生成步骤</a>, 将生成好的ssh key 添加到github上<br><img src=\"http://oyvpp7gqd.bkt.clouddn.com/18-5-14/88681793.jpg\" alt=\"github-ssh-key\"> </p>\n<blockquote>\n<p>配置完成后在Git Bash测试<br><img src=\"http://oyvpp7gqd.bkt.clouddn.com/18-5-14/99272918.jpg\" alt=\"git-key-check\"></p>\n</blockquote>\n<h2 id=\"Hexo-配置\"><a href=\"#Hexo-配置\" class=\"headerlink\" title=\"Hexo 配置\"></a>Hexo 配置</h2><p>在blog文件夹下，修改 _config.yml 文件中 <code>deploy</code> 的 repo 地址<br><img src=\"http://oyvpp7gqd.bkt.clouddn.com/18-5-14/9649267.jpg\" alt=\"dev-repo\"><br>要同步部署文章还需要再添加一个npm扩展：<code>npm install hexo-deployer-git --save</code></p>\n<h2 id=\"测试\"><a href=\"#测试\" class=\"headerlink\" title=\"测试\"></a>测试</h2><p>使用 <code>hexo new post &quot;hello hexo&quot;</code> 新建一遍文章，新生成的文章在 <code>blog/source/_posts</code> 下，使用MarkDown语法编辑<br>完成后先在本地预览 <code>http://localhost:4000</code><br>最后使用 hexo d -g 命令同步到github上，可以在浏览器上使用 <a href=\"https://username.github.io\" target=\"_blank\" rel=\"noopener\">https://username.github.io</a> 查看</p>"},{"title":"深入理解 Nginx 和 PHP-FPM","date":"2018-09-22T03:32:03.000Z","_content":"\n> B/S 运行原理剖析 `Nignx` `FastCGI` `PHP-FPM`\n\n<!-- more -->\n\n# Nginx\n> 官网： [Nginx](https://nginx.org/)\n> `Nginx` 是一个高性能、轻量级的 Web 服务器 和 反向代理服务器，支持灵活简单的配置以及高达 50,000 个并发连接数的响应\n> [点击此处查看具体介绍](https://baike.baidu.com/item/nginx/3817705?fr=aladdin)\n\n## Nginx 的工作原理\n  `Nginx` 在启动后，会生成一个 **Master** 进程和fork多个 **Worker** 进程\n- **Master** 进程主要是用来管理 **Worker** 进程 『 向各 **Worker** 进程发送信号，监控 **Worker** 进程的运行状态，重启 **Worker** 进程 等 』 \n\n- **Worker** 进程来处理 `Nginx` 的事件，多个 **Worker** 同时获取网络请求，每个 **Worker** 之间是相互独立的，一个网络请求只能被一个 **Worker** 进程处理，一个 **Worker** 进程不能处理其他进程的请求，**Worker** 进程的个数是可以设置的，一般与机器的 CPU 核数一致\n   > 为了保证只有一个进程处理一个网络请求，所有的 **Worker** 进程在注册 **listenfd读事件** 之前抢占 **accept_mutex** 抢到互斥锁的那个进程注册 **listenfd读事件** ，在读事件里调用 **accept** 接收该连接，当一个 **Workder** 进程拿到 **accept** 这个连接之后就开始读取请求，并且解析处理，产生数据后再返回给客户端，最后才断开连接。\n\n# FastCGI\n## CGI\n  **CGI** 是 Web Server 与后台语言交互的协议，有了这个协议，开发者可以使用任何语言处理 Web Server 发来的请求，动态的生成内容\n## FastCGI\n  传统的 **CGI** 在每次处理请求时 都需要fork一个全新的进程去处理，而且安全性差，不适合在高并发的场景中使用，所以产生了 `FastCGI` 它允许在一个进程内处理多个请求，而不是一个请求处理完毕就直接结束进程，性能上有了很大的提高\n\n## Nginx + FastCGI\n  为了使 `Nginx` 能够理解 `FastCGI` 协议，`Nginx` 提供了 `FastCGI` 模块来将 HTTP 请求 映射为对应的 `FastCGI` 请求 [参见fastcgi_params](https://github.com/nginx/nginx/blob/master/conf/fastcgi_params)\n  `Nginx` 不支持对外部程序的直接调用或者解析， 外部程序必须通过 `FastCGI` 接口来调用。\n  > `FastCGI` 接口在 Linux 下是 Socket\n\n# PHP-FPM\n## FPM 『 FastCGI Process Manager 』\n  `FPM` 是 **FastCGI** 的实现， 任何实现了 **FastCGI** 协议的 Web Server 都能够与之通信\n\n## PHP-FPM \n  `PHP-FPM` 是一个 PHP 的进程管理器，包含 **Master** 和 **Worker** 进程 \n  - **Master** 进程负责监听端口，接收来自 Web Server 的请求\n  - **Worker** 进程会有多个(可配置)，每个进程内部都嵌入了一个 PHP 解释器，是 PHP 代码真正执行的地方\n    > 从 `PHP-FPM` 接收到请求，到处理完毕 其流程如下\n    >   1. `PHP-FPM` 的 **Master** 进程接收到请求\n    >   2. **Master** 进程根据配置指派特定的 **Worker** 。进程进行请求处理，如果没有可用进程，返回错误，这也是我们配合 **Nginx** 遇到 502 错误比较多的原因\n    >   3. **Worker** 进程处理请求，如果超时，返回 504 错误\n    >   4. 请求处理结束，返回结果\n\n## Nginx + PHP-FPM\n  在 **Nginx** 的配置文件中，通过 **location** 指令，将所有以 .php 结尾的文件都交给 php7.1-fpm.sock 来处理\n  ```bash :Nginx.conf mark:6\n    ····· \n    location ~ \\.php$ {\n        fastcgi_index  index.php;\n        fastcgi_param  SCRIPT_FILENAME $document_root$fastcgi_script_name;\n        include        fastcgi_params;\n        fastcgi_pass   unix:/run/php/php7.1-fpm.sock;\n    }\n    ·····\n  ```\n \n# 配置优化\n\n## Nginx.Conf 配置优化\n\nif (!-e $request_filename) {\n    rewrite . /index.php last;\n}\n\n- 使用 『 try_files 』： try_files $uri $uri/ /index.php;\n- 开启 gzip\n- 设置 limit_rate 限制客户端的相应速度\n\n### Nginx 常见错误\n\n1. 502 Bad Gateway\n  php-cgi进程数不够用、php执行时间长（mysql慢）、或者是php-cgi进程死掉，都会出现502错误, 一般来说 Nginx 502 Bad Gateway 和 php-fpm.conf 的设置有关，而 Nginx 504 Gateway Time-out 则是与 nginx.conf 的设置有关\n2. 413 Request Entity Too Large\n  Nignx.conf 中配置 `client_max_body_size`\n  php.ini    中配置 `post_max_size` 和 `upload_max_filesize`\n\n## PHP-FPM 配置优化\n\n1. 适当调高 PHP FastCGI 的子进程数\n2. 适当增加 max_requests\n\n更多配置： \n [PHP-FPM 调优：使用 `pm static`来最大化你的服务器负载能力](https://laravel-china.org/topics/14952/php-fpm-tuning-use-pm-static-to-maximize-your-server-load-capability)\n [php配置php-fpm启动参数及配置详解](http://www.php.cn/php-weizijiaocheng-391985.html)\n\n\n> 参考文章\n> https://zhuanlan.zhihu.com/p/20694204\n> https://blog.csdn.net/hguisu/article/details/8930668","source":"_posts/深入理解 Nginx 和 PHP-FPM.md","raw":"---\ntitle: 深入理解 Nginx 和 PHP-FPM\ndate: 2018-09-22 11:32:03\ntags: [Linux, Nginx, FastCGI, PHP-FPM]\ncategories: PHP\n---\n\n> B/S 运行原理剖析 `Nignx` `FastCGI` `PHP-FPM`\n\n<!-- more -->\n\n# Nginx\n> 官网： [Nginx](https://nginx.org/)\n> `Nginx` 是一个高性能、轻量级的 Web 服务器 和 反向代理服务器，支持灵活简单的配置以及高达 50,000 个并发连接数的响应\n> [点击此处查看具体介绍](https://baike.baidu.com/item/nginx/3817705?fr=aladdin)\n\n## Nginx 的工作原理\n  `Nginx` 在启动后，会生成一个 **Master** 进程和fork多个 **Worker** 进程\n- **Master** 进程主要是用来管理 **Worker** 进程 『 向各 **Worker** 进程发送信号，监控 **Worker** 进程的运行状态，重启 **Worker** 进程 等 』 \n\n- **Worker** 进程来处理 `Nginx` 的事件，多个 **Worker** 同时获取网络请求，每个 **Worker** 之间是相互独立的，一个网络请求只能被一个 **Worker** 进程处理，一个 **Worker** 进程不能处理其他进程的请求，**Worker** 进程的个数是可以设置的，一般与机器的 CPU 核数一致\n   > 为了保证只有一个进程处理一个网络请求，所有的 **Worker** 进程在注册 **listenfd读事件** 之前抢占 **accept_mutex** 抢到互斥锁的那个进程注册 **listenfd读事件** ，在读事件里调用 **accept** 接收该连接，当一个 **Workder** 进程拿到 **accept** 这个连接之后就开始读取请求，并且解析处理，产生数据后再返回给客户端，最后才断开连接。\n\n# FastCGI\n## CGI\n  **CGI** 是 Web Server 与后台语言交互的协议，有了这个协议，开发者可以使用任何语言处理 Web Server 发来的请求，动态的生成内容\n## FastCGI\n  传统的 **CGI** 在每次处理请求时 都需要fork一个全新的进程去处理，而且安全性差，不适合在高并发的场景中使用，所以产生了 `FastCGI` 它允许在一个进程内处理多个请求，而不是一个请求处理完毕就直接结束进程，性能上有了很大的提高\n\n## Nginx + FastCGI\n  为了使 `Nginx` 能够理解 `FastCGI` 协议，`Nginx` 提供了 `FastCGI` 模块来将 HTTP 请求 映射为对应的 `FastCGI` 请求 [参见fastcgi_params](https://github.com/nginx/nginx/blob/master/conf/fastcgi_params)\n  `Nginx` 不支持对外部程序的直接调用或者解析， 外部程序必须通过 `FastCGI` 接口来调用。\n  > `FastCGI` 接口在 Linux 下是 Socket\n\n# PHP-FPM\n## FPM 『 FastCGI Process Manager 』\n  `FPM` 是 **FastCGI** 的实现， 任何实现了 **FastCGI** 协议的 Web Server 都能够与之通信\n\n## PHP-FPM \n  `PHP-FPM` 是一个 PHP 的进程管理器，包含 **Master** 和 **Worker** 进程 \n  - **Master** 进程负责监听端口，接收来自 Web Server 的请求\n  - **Worker** 进程会有多个(可配置)，每个进程内部都嵌入了一个 PHP 解释器，是 PHP 代码真正执行的地方\n    > 从 `PHP-FPM` 接收到请求，到处理完毕 其流程如下\n    >   1. `PHP-FPM` 的 **Master** 进程接收到请求\n    >   2. **Master** 进程根据配置指派特定的 **Worker** 。进程进行请求处理，如果没有可用进程，返回错误，这也是我们配合 **Nginx** 遇到 502 错误比较多的原因\n    >   3. **Worker** 进程处理请求，如果超时，返回 504 错误\n    >   4. 请求处理结束，返回结果\n\n## Nginx + PHP-FPM\n  在 **Nginx** 的配置文件中，通过 **location** 指令，将所有以 .php 结尾的文件都交给 php7.1-fpm.sock 来处理\n  ```bash :Nginx.conf mark:6\n    ····· \n    location ~ \\.php$ {\n        fastcgi_index  index.php;\n        fastcgi_param  SCRIPT_FILENAME $document_root$fastcgi_script_name;\n        include        fastcgi_params;\n        fastcgi_pass   unix:/run/php/php7.1-fpm.sock;\n    }\n    ·····\n  ```\n \n# 配置优化\n\n## Nginx.Conf 配置优化\n\nif (!-e $request_filename) {\n    rewrite . /index.php last;\n}\n\n- 使用 『 try_files 』： try_files $uri $uri/ /index.php;\n- 开启 gzip\n- 设置 limit_rate 限制客户端的相应速度\n\n### Nginx 常见错误\n\n1. 502 Bad Gateway\n  php-cgi进程数不够用、php执行时间长（mysql慢）、或者是php-cgi进程死掉，都会出现502错误, 一般来说 Nginx 502 Bad Gateway 和 php-fpm.conf 的设置有关，而 Nginx 504 Gateway Time-out 则是与 nginx.conf 的设置有关\n2. 413 Request Entity Too Large\n  Nignx.conf 中配置 `client_max_body_size`\n  php.ini    中配置 `post_max_size` 和 `upload_max_filesize`\n\n## PHP-FPM 配置优化\n\n1. 适当调高 PHP FastCGI 的子进程数\n2. 适当增加 max_requests\n\n更多配置： \n [PHP-FPM 调优：使用 `pm static`来最大化你的服务器负载能力](https://laravel-china.org/topics/14952/php-fpm-tuning-use-pm-static-to-maximize-your-server-load-capability)\n [php配置php-fpm启动参数及配置详解](http://www.php.cn/php-weizijiaocheng-391985.html)\n\n\n> 参考文章\n> https://zhuanlan.zhihu.com/p/20694204\n> https://blog.csdn.net/hguisu/article/details/8930668","slug":"深入理解 Nginx 和 PHP-FPM","published":1,"updated":"2018-11-08T04:19:01.066Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjopirm7c000o2cwm6ro92f50","content":"<blockquote>\n<p>B/S 运行原理剖析 <code>Nignx</code> <code>FastCGI</code> <code>PHP-FPM</code></p>\n</blockquote>\n<a id=\"more\"></a>\n<h1 id=\"Nginx\"><a href=\"#Nginx\" class=\"headerlink\" title=\"Nginx\"></a>Nginx</h1><blockquote>\n<p>官网： <a href=\"https://nginx.org/\" target=\"_blank\" rel=\"noopener\">Nginx</a><br><code>Nginx</code> 是一个高性能、轻量级的 Web 服务器 和 反向代理服务器，支持灵活简单的配置以及高达 50,000 个并发连接数的响应<br><a href=\"https://baike.baidu.com/item/nginx/3817705?fr=aladdin\" target=\"_blank\" rel=\"noopener\">点击此处查看具体介绍</a></p>\n</blockquote>\n<h2 id=\"Nginx-的工作原理\"><a href=\"#Nginx-的工作原理\" class=\"headerlink\" title=\"Nginx 的工作原理\"></a>Nginx 的工作原理</h2><p>  <code>Nginx</code> 在启动后，会生成一个 <strong>Master</strong> 进程和fork多个 <strong>Worker</strong> 进程</p>\n<ul>\n<li><p><strong>Master</strong> 进程主要是用来管理 <strong>Worker</strong> 进程 『 向各 <strong>Worker</strong> 进程发送信号，监控 <strong>Worker</strong> 进程的运行状态，重启 <strong>Worker</strong> 进程 等 』 </p>\n</li>\n<li><p><strong>Worker</strong> 进程来处理 <code>Nginx</code> 的事件，多个 <strong>Worker</strong> 同时获取网络请求，每个 <strong>Worker</strong> 之间是相互独立的，一个网络请求只能被一个 <strong>Worker</strong> 进程处理，一个 <strong>Worker</strong> 进程不能处理其他进程的请求，<strong>Worker</strong> 进程的个数是可以设置的，一般与机器的 CPU 核数一致</p>\n<blockquote>\n<p>为了保证只有一个进程处理一个网络请求，所有的 <strong>Worker</strong> 进程在注册 <strong>listenfd读事件</strong> 之前抢占 <strong>accept_mutex</strong> 抢到互斥锁的那个进程注册 <strong>listenfd读事件</strong> ，在读事件里调用 <strong>accept</strong> 接收该连接，当一个 <strong>Workder</strong> 进程拿到 <strong>accept</strong> 这个连接之后就开始读取请求，并且解析处理，产生数据后再返回给客户端，最后才断开连接。</p>\n</blockquote>\n</li>\n</ul>\n<h1 id=\"FastCGI\"><a href=\"#FastCGI\" class=\"headerlink\" title=\"FastCGI\"></a>FastCGI</h1><h2 id=\"CGI\"><a href=\"#CGI\" class=\"headerlink\" title=\"CGI\"></a>CGI</h2><p>  <strong>CGI</strong> 是 Web Server 与后台语言交互的协议，有了这个协议，开发者可以使用任何语言处理 Web Server 发来的请求，动态的生成内容</p>\n<h2 id=\"FastCGI-1\"><a href=\"#FastCGI-1\" class=\"headerlink\" title=\"FastCGI\"></a>FastCGI</h2><p>  传统的 <strong>CGI</strong> 在每次处理请求时 都需要fork一个全新的进程去处理，而且安全性差，不适合在高并发的场景中使用，所以产生了 <code>FastCGI</code> 它允许在一个进程内处理多个请求，而不是一个请求处理完毕就直接结束进程，性能上有了很大的提高</p>\n<h2 id=\"Nginx-FastCGI\"><a href=\"#Nginx-FastCGI\" class=\"headerlink\" title=\"Nginx + FastCGI\"></a>Nginx + FastCGI</h2><p>  为了使 <code>Nginx</code> 能够理解 <code>FastCGI</code> 协议，<code>Nginx</code> 提供了 <code>FastCGI</code> 模块来将 HTTP 请求 映射为对应的 <code>FastCGI</code> 请求 <a href=\"https://github.com/nginx/nginx/blob/master/conf/fastcgi_params\" target=\"_blank\" rel=\"noopener\">参见fastcgi_params</a><br>  <code>Nginx</code> 不支持对外部程序的直接调用或者解析， 外部程序必须通过 <code>FastCGI</code> 接口来调用。</p>\n<blockquote>\n<p><code>FastCGI</code> 接口在 Linux 下是 Socket</p>\n</blockquote>\n<h1 id=\"PHP-FPM\"><a href=\"#PHP-FPM\" class=\"headerlink\" title=\"PHP-FPM\"></a>PHP-FPM</h1><h2 id=\"FPM-『-FastCGI-Process-Manager-』\"><a href=\"#FPM-『-FastCGI-Process-Manager-』\" class=\"headerlink\" title=\"FPM 『 FastCGI Process Manager 』\"></a>FPM 『 FastCGI Process Manager 』</h2><p>  <code>FPM</code> 是 <strong>FastCGI</strong> 的实现， 任何实现了 <strong>FastCGI</strong> 协议的 Web Server 都能够与之通信</p>\n<h2 id=\"PHP-FPM-1\"><a href=\"#PHP-FPM-1\" class=\"headerlink\" title=\"PHP-FPM\"></a>PHP-FPM</h2><p>  <code>PHP-FPM</code> 是一个 PHP 的进程管理器，包含 <strong>Master</strong> 和 <strong>Worker</strong> 进程 </p>\n<ul>\n<li><strong>Master</strong> 进程负责监听端口，接收来自 Web Server 的请求</li>\n<li><strong>Worker</strong> 进程会有多个(可配置)，每个进程内部都嵌入了一个 PHP 解释器，是 PHP 代码真正执行的地方<blockquote>\n<p>从 <code>PHP-FPM</code> 接收到请求，到处理完毕 其流程如下</p>\n<ol>\n<li><code>PHP-FPM</code> 的 <strong>Master</strong> 进程接收到请求</li>\n<li><strong>Master</strong> 进程根据配置指派特定的 <strong>Worker</strong> 。进程进行请求处理，如果没有可用进程，返回错误，这也是我们配合 <strong>Nginx</strong> 遇到 502 错误比较多的原因</li>\n<li><strong>Worker</strong> 进程处理请求，如果超时，返回 504 错误</li>\n<li>请求处理结束，返回结果</li>\n</ol>\n</blockquote>\n</li>\n</ul>\n<h2 id=\"Nginx-PHP-FPM\"><a href=\"#Nginx-PHP-FPM\" class=\"headerlink\" title=\"Nginx + PHP-FPM\"></a>Nginx + PHP-FPM</h2><p>  在 <strong>Nginx</strong> 的配置文件中，通过 <strong>location</strong> 指令，将所有以 .php 结尾的文件都交给 php7.1-fpm.sock 来处理<br>  <figure class=\"highlight bash\"><figcaption><span class=\"caption\">Nginx</span><span class=\"suffix\">.conf</span></figcaption><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></div><div class=\"code\"><pre><div class=\"line\">····· </div><div class=\"line\">location ~ \\.php$ &#123;</div><div class=\"line\">    fastcgi_index  index.php;</div><div class=\"line\">    fastcgi_param  SCRIPT_FILENAME <span class=\"variable\">$document_root</span><span class=\"variable\">$fastcgi_script_name</span>;</div><div class=\"line\">    include        fastcgi_params;</div><div class=\"line marked\">    fastcgi_pass   unix:/run/php/php7.1-fpm.sock;</div><div class=\"line\">&#125;</div><div class=\"line\">·····</div></pre></div></div></figure></p>\n<h1 id=\"配置优化\"><a href=\"#配置优化\" class=\"headerlink\" title=\"配置优化\"></a>配置优化</h1><h2 id=\"Nginx-Conf-配置优化\"><a href=\"#Nginx-Conf-配置优化\" class=\"headerlink\" title=\"Nginx.Conf 配置优化\"></a>Nginx.Conf 配置优化</h2><p>if (!-e $request_filename) {<br>    rewrite . /index.php last;<br>}</p>\n<ul>\n<li>使用 『 try_files 』： try_files $uri $uri/ /index.php;</li>\n<li>开启 gzip</li>\n<li>设置 limit_rate 限制客户端的相应速度</li>\n</ul>\n<h3 id=\"Nginx-常见错误\"><a href=\"#Nginx-常见错误\" class=\"headerlink\" title=\"Nginx 常见错误\"></a>Nginx 常见错误</h3><ol>\n<li>502 Bad Gateway<br>php-cgi进程数不够用、php执行时间长（mysql慢）、或者是php-cgi进程死掉，都会出现502错误, 一般来说 Nginx 502 Bad Gateway 和 php-fpm.conf 的设置有关，而 Nginx 504 Gateway Time-out 则是与 nginx.conf 的设置有关</li>\n<li>413 Request Entity Too Large<br>Nignx.conf 中配置 <code>client_max_body_size</code><br>php.ini    中配置 <code>post_max_size</code> 和 <code>upload_max_filesize</code></li>\n</ol>\n<h2 id=\"PHP-FPM-配置优化\"><a href=\"#PHP-FPM-配置优化\" class=\"headerlink\" title=\"PHP-FPM 配置优化\"></a>PHP-FPM 配置优化</h2><ol>\n<li>适当调高 PHP FastCGI 的子进程数</li>\n<li>适当增加 max_requests</li>\n</ol>\n<p>更多配置：<br> <a href=\"https://laravel-china.org/topics/14952/php-fpm-tuning-use-pm-static-to-maximize-your-server-load-capability\" target=\"_blank\" rel=\"noopener\">PHP-FPM 调优：使用 <code>pm static</code>来最大化你的服务器负载能力</a><br> <a href=\"http://www.php.cn/php-weizijiaocheng-391985.html\" target=\"_blank\" rel=\"noopener\">php配置php-fpm启动参数及配置详解</a></p>\n<blockquote>\n<p>参考文章<br><a href=\"https://zhuanlan.zhihu.com/p/20694204\" target=\"_blank\" rel=\"noopener\">https://zhuanlan.zhihu.com/p/20694204</a><br><a href=\"https://blog.csdn.net/hguisu/article/details/8930668\" target=\"_blank\" rel=\"noopener\">https://blog.csdn.net/hguisu/article/details/8930668</a></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"<blockquote>\n<p>B/S 运行原理剖析 <code>Nignx</code> <code>FastCGI</code> <code>PHP-FPM</code></p>\n</blockquote>","more":"<h1 id=\"Nginx\"><a href=\"#Nginx\" class=\"headerlink\" title=\"Nginx\"></a>Nginx</h1><blockquote>\n<p>官网： <a href=\"https://nginx.org/\" target=\"_blank\" rel=\"noopener\">Nginx</a><br><code>Nginx</code> 是一个高性能、轻量级的 Web 服务器 和 反向代理服务器，支持灵活简单的配置以及高达 50,000 个并发连接数的响应<br><a href=\"https://baike.baidu.com/item/nginx/3817705?fr=aladdin\" target=\"_blank\" rel=\"noopener\">点击此处查看具体介绍</a></p>\n</blockquote>\n<h2 id=\"Nginx-的工作原理\"><a href=\"#Nginx-的工作原理\" class=\"headerlink\" title=\"Nginx 的工作原理\"></a>Nginx 的工作原理</h2><p>  <code>Nginx</code> 在启动后，会生成一个 <strong>Master</strong> 进程和fork多个 <strong>Worker</strong> 进程</p>\n<ul>\n<li><p><strong>Master</strong> 进程主要是用来管理 <strong>Worker</strong> 进程 『 向各 <strong>Worker</strong> 进程发送信号，监控 <strong>Worker</strong> 进程的运行状态，重启 <strong>Worker</strong> 进程 等 』 </p>\n</li>\n<li><p><strong>Worker</strong> 进程来处理 <code>Nginx</code> 的事件，多个 <strong>Worker</strong> 同时获取网络请求，每个 <strong>Worker</strong> 之间是相互独立的，一个网络请求只能被一个 <strong>Worker</strong> 进程处理，一个 <strong>Worker</strong> 进程不能处理其他进程的请求，<strong>Worker</strong> 进程的个数是可以设置的，一般与机器的 CPU 核数一致</p>\n<blockquote>\n<p>为了保证只有一个进程处理一个网络请求，所有的 <strong>Worker</strong> 进程在注册 <strong>listenfd读事件</strong> 之前抢占 <strong>accept_mutex</strong> 抢到互斥锁的那个进程注册 <strong>listenfd读事件</strong> ，在读事件里调用 <strong>accept</strong> 接收该连接，当一个 <strong>Workder</strong> 进程拿到 <strong>accept</strong> 这个连接之后就开始读取请求，并且解析处理，产生数据后再返回给客户端，最后才断开连接。</p>\n</blockquote>\n</li>\n</ul>\n<h1 id=\"FastCGI\"><a href=\"#FastCGI\" class=\"headerlink\" title=\"FastCGI\"></a>FastCGI</h1><h2 id=\"CGI\"><a href=\"#CGI\" class=\"headerlink\" title=\"CGI\"></a>CGI</h2><p>  <strong>CGI</strong> 是 Web Server 与后台语言交互的协议，有了这个协议，开发者可以使用任何语言处理 Web Server 发来的请求，动态的生成内容</p>\n<h2 id=\"FastCGI-1\"><a href=\"#FastCGI-1\" class=\"headerlink\" title=\"FastCGI\"></a>FastCGI</h2><p>  传统的 <strong>CGI</strong> 在每次处理请求时 都需要fork一个全新的进程去处理，而且安全性差，不适合在高并发的场景中使用，所以产生了 <code>FastCGI</code> 它允许在一个进程内处理多个请求，而不是一个请求处理完毕就直接结束进程，性能上有了很大的提高</p>\n<h2 id=\"Nginx-FastCGI\"><a href=\"#Nginx-FastCGI\" class=\"headerlink\" title=\"Nginx + FastCGI\"></a>Nginx + FastCGI</h2><p>  为了使 <code>Nginx</code> 能够理解 <code>FastCGI</code> 协议，<code>Nginx</code> 提供了 <code>FastCGI</code> 模块来将 HTTP 请求 映射为对应的 <code>FastCGI</code> 请求 <a href=\"https://github.com/nginx/nginx/blob/master/conf/fastcgi_params\" target=\"_blank\" rel=\"noopener\">参见fastcgi_params</a><br>  <code>Nginx</code> 不支持对外部程序的直接调用或者解析， 外部程序必须通过 <code>FastCGI</code> 接口来调用。</p>\n<blockquote>\n<p><code>FastCGI</code> 接口在 Linux 下是 Socket</p>\n</blockquote>\n<h1 id=\"PHP-FPM\"><a href=\"#PHP-FPM\" class=\"headerlink\" title=\"PHP-FPM\"></a>PHP-FPM</h1><h2 id=\"FPM-『-FastCGI-Process-Manager-』\"><a href=\"#FPM-『-FastCGI-Process-Manager-』\" class=\"headerlink\" title=\"FPM 『 FastCGI Process Manager 』\"></a>FPM 『 FastCGI Process Manager 』</h2><p>  <code>FPM</code> 是 <strong>FastCGI</strong> 的实现， 任何实现了 <strong>FastCGI</strong> 协议的 Web Server 都能够与之通信</p>\n<h2 id=\"PHP-FPM-1\"><a href=\"#PHP-FPM-1\" class=\"headerlink\" title=\"PHP-FPM\"></a>PHP-FPM</h2><p>  <code>PHP-FPM</code> 是一个 PHP 的进程管理器，包含 <strong>Master</strong> 和 <strong>Worker</strong> 进程 </p>\n<ul>\n<li><strong>Master</strong> 进程负责监听端口，接收来自 Web Server 的请求</li>\n<li><strong>Worker</strong> 进程会有多个(可配置)，每个进程内部都嵌入了一个 PHP 解释器，是 PHP 代码真正执行的地方<blockquote>\n<p>从 <code>PHP-FPM</code> 接收到请求，到处理完毕 其流程如下</p>\n<ol>\n<li><code>PHP-FPM</code> 的 <strong>Master</strong> 进程接收到请求</li>\n<li><strong>Master</strong> 进程根据配置指派特定的 <strong>Worker</strong> 。进程进行请求处理，如果没有可用进程，返回错误，这也是我们配合 <strong>Nginx</strong> 遇到 502 错误比较多的原因</li>\n<li><strong>Worker</strong> 进程处理请求，如果超时，返回 504 错误</li>\n<li>请求处理结束，返回结果</li>\n</ol>\n</blockquote>\n</li>\n</ul>\n<h2 id=\"Nginx-PHP-FPM\"><a href=\"#Nginx-PHP-FPM\" class=\"headerlink\" title=\"Nginx + PHP-FPM\"></a>Nginx + PHP-FPM</h2><p>  在 <strong>Nginx</strong> 的配置文件中，通过 <strong>location</strong> 指令，将所有以 .php 结尾的文件都交给 php7.1-fpm.sock 来处理<br>  <figure class=\"highlight bash\"><figcaption><span class=\"caption\">Nginx</span><span class=\"suffix\">.conf</span></figcaption><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></div><div class=\"code\"><pre><div class=\"line\">····· </div><div class=\"line\">location ~ \\.php$ &#123;</div><div class=\"line\">    fastcgi_index  index.php;</div><div class=\"line\">    fastcgi_param  SCRIPT_FILENAME <span class=\"variable\">$document_root</span><span class=\"variable\">$fastcgi_script_name</span>;</div><div class=\"line\">    include        fastcgi_params;</div><div class=\"line marked\">    fastcgi_pass   unix:/run/php/php7.1-fpm.sock;</div><div class=\"line\">&#125;</div><div class=\"line\">·····</div></pre></div></div></figure></p>\n<h1 id=\"配置优化\"><a href=\"#配置优化\" class=\"headerlink\" title=\"配置优化\"></a>配置优化</h1><h2 id=\"Nginx-Conf-配置优化\"><a href=\"#Nginx-Conf-配置优化\" class=\"headerlink\" title=\"Nginx.Conf 配置优化\"></a>Nginx.Conf 配置优化</h2><p>if (!-e $request_filename) {<br>    rewrite . /index.php last;<br>}</p>\n<ul>\n<li>使用 『 try_files 』： try_files $uri $uri/ /index.php;</li>\n<li>开启 gzip</li>\n<li>设置 limit_rate 限制客户端的相应速度</li>\n</ul>\n<h3 id=\"Nginx-常见错误\"><a href=\"#Nginx-常见错误\" class=\"headerlink\" title=\"Nginx 常见错误\"></a>Nginx 常见错误</h3><ol>\n<li>502 Bad Gateway<br>php-cgi进程数不够用、php执行时间长（mysql慢）、或者是php-cgi进程死掉，都会出现502错误, 一般来说 Nginx 502 Bad Gateway 和 php-fpm.conf 的设置有关，而 Nginx 504 Gateway Time-out 则是与 nginx.conf 的设置有关</li>\n<li>413 Request Entity Too Large<br>Nignx.conf 中配置 <code>client_max_body_size</code><br>php.ini    中配置 <code>post_max_size</code> 和 <code>upload_max_filesize</code></li>\n</ol>\n<h2 id=\"PHP-FPM-配置优化\"><a href=\"#PHP-FPM-配置优化\" class=\"headerlink\" title=\"PHP-FPM 配置优化\"></a>PHP-FPM 配置优化</h2><ol>\n<li>适当调高 PHP FastCGI 的子进程数</li>\n<li>适当增加 max_requests</li>\n</ol>\n<p>更多配置：<br> <a href=\"https://laravel-china.org/topics/14952/php-fpm-tuning-use-pm-static-to-maximize-your-server-load-capability\" target=\"_blank\" rel=\"noopener\">PHP-FPM 调优：使用 <code>pm static</code>来最大化你的服务器负载能力</a><br> <a href=\"http://www.php.cn/php-weizijiaocheng-391985.html\" target=\"_blank\" rel=\"noopener\">php配置php-fpm启动参数及配置详解</a></p>\n<blockquote>\n<p>参考文章<br><a href=\"https://zhuanlan.zhihu.com/p/20694204\" target=\"_blank\" rel=\"noopener\">https://zhuanlan.zhihu.com/p/20694204</a><br><a href=\"https://blog.csdn.net/hguisu/article/details/8930668\" target=\"_blank\" rel=\"noopener\">https://blog.csdn.net/hguisu/article/details/8930668</a></p>\n</blockquote>"},{"title":"阿里图标库爬虫","date":"2018-06-07T07:56:08.000Z","_content":"\n> 该爬虫仅作学习交流分享\n\n<!--more-->\n\n```PHP diff:true\n/**\n * 阿里图标库素材爬虫\n * Author：Hui\n * Date：18/06/07\n * Time：14:22\n */\nclass Icon \n{\n    // 图标分类集合\n    CONST COLLECTIONS_URL = \"http://iconfont.cn/api/collections.json?\";\n    // 分类详情\n    CONST COLLECTIONS_DETAIL_URL = \"http://iconfont.cn/api/collection/detail.json?\";\n    // 爬取的初始页数\n    public $page = 1;\n    // 每页爬取的数量\n    public $limit = 9;\n\t\n+    // 认证信息\n+    public $ctoken = '6LQwjc6zvc9P5knLf9LMicon-font';\n\t\n    // 图标分类集合\n    public function collection()\n    {\n        $url = self::COLLECTIONS_URL . \"type=4&sort=time&limit=\".$this -> limit.\"&page=\".$this -> page.\"&keyword=&t=1528351142196&ctoken=\".$this -> ctoken;\n        $collections = $this -> request($url);\n        self::saveFile('icon', 'log', $collections, 'log');\n        $collections_arr = json_decode($collections, true);\n        // 页数记录日志\n        @array_unshift($collections_arr, ['page'=> $this -> page]);\n        if($collections_arr['code'] == 200) {\n            self::saveFile('icon', 'collection_lists', $collections_arr);\n            $this -> getListDetail($collections_arr['data']['lists']);\n        } else {\n            self::saveFile('icon', 'error_collection', $collections_arr, 'log');\n            echo '提取失败'; \n            return false;\n        }\n+       sleep(5); // 间隔爬取\n        if(ceil($collections_arr['data']['count'] / $this -> limit) > $this -> page) {\n            $this -> page += 1;\n            $this -> collection();\n        }\n    }\n\t\n    // 分类详情\n    public function getListDetail($lists)\n    {\n        foreach ($lists as $key => $value) \n        {\n            $url =  self::COLLECTIONS_DETAIL_URL . \"id=\" . $value['id'].\"&t=1528352609403&ctoken=\" . $this -> ctoken;\n            $icons = $this -> request($url);\n            $icons_arr = json_decode($icons, true);\n            if($icons_arr['code'] == 200) {\n                $cate = $icons_arr['data']['collection']['name'];\n                $slug = $icons_arr['data']['collection']['slug'];\n                $data = $icons_arr['data']['icons'];\n                self::saveFile('icon/cate', $cate, ['slug'=> $slug, 'data'=> $data]);\n            } else {\n                self::saveFile('icon', 'error_detail', $icons_arr, 'log');\n            }\n        }\n        \n    }\n\t\n    public function request($url)\n    {\n          $curl = curl_init();\n          curl_setopt_array($curl, array(\n          CURLOPT_URL => $url,\n          CURLOPT_RETURNTRANSFER => true,\n          CURLOPT_ENCODING => \"\",\n          CURLOPT_MAXREDIRS => 10,\n          CURLOPT_TIMEOUT => 30,\n          CURLOPT_HTTP_VERSION => CURL_HTTP_VERSION_1_1,\n          CURLOPT_CUSTOMREQUEST => \"GET\",\n          CURLOPT_HTTPHEADER => array(\n+           \"Cookie: cna=5BdjEtZmvXcCAXJwfKJoE/H4; ctoken=$this -> ctoken; trace=AQAAAKn2MUvYlgYAfjhI3636rvjKjRtI; EGG_SESS=Jy6H0NqsswjXTGxPm7tDsBXmfSCQsVxkM0P6_YvCY0U6eqzm1xar-rSrDYL16dovQD3JbIUf6wyM_iE5RvVhxcXR3QRHilxa7hA_7HO1dPf8dNLmGXnH50MptGouw16S-uzeG7PRQKiNoKr-4f2FhcUHFPYgJPfhiTLjmdM22TE=; isg=BPT0I8QQEz_FhIZT7Fy0CplOxbKmZRjDZcwowI5VgH8C-ZRDtt3oR6qbfTEhGlAP\"\n-           \"Cookie: cna=5BdjEtZmvXcCAXJwfKJoE/H4; ctoken=6LQwjc6zvc9P5knLf9LMicon-font; trace=AQAAAKn2MUvYlgYAfjhI3636rvjKjRtI; EGG_SESS=Jy6H0NqsswjXTGxPm7tDsBXmfSCQsVxkM0P6_YvCY0U6eqzm1xar-rSrDYL16dovQD3JbIUf6wyM_iE5RvVhxcXR3QRHilxa7hA_7HO1dPf8dNLmGXnH50MptGouw16S-uzeG7PRQKiNoKr-4f2FhcUHFPYgJPfhiTLjmdM22TE=; isg=BPT0I8QQEz_FhIZT7Fy0CplOxbKmZRjDZcwowI5VgH8C-ZRDtt3oR6qbfTEhGlAP\"\n          ),\n        ));\n        \n        $response = curl_exec($curl);\n        curl_close($curl);\n        return $response;\n    }\n\t\n    /**\n     * 保存文件到指定目录\n     */\n    public static function saveFile($path, $filename, $content,$saveType = 'json', $mode = 'w')\n    {\n        // 创建目录\n        if(!is_dir($path)) self::createDir($path);\n        if(is_array($content)) $content = json_encode($content);\n        $handle = fopen($path .'/'. $filename . '.' . $saveType, $mode);\n        fwrite($handle, $content);\n        fclose($handle);\n    }\n\t\n    /**\n     * 新建目录\n     */\n    private static function createDir($path)\n    {\n        if (is_dir($path) || @mkdir($path)) return True;\n        if ( !self::createDir(dirname($path))) return False;\n        return mkdir($path);\n    }\n    \n}\n\n/********************************************/\n\nclass IconToSvg\n{\n    // 文件目录\n+   public $path = ['icon/cate0', 'icon/cate1'];\n-   public $path = 'icon/cate0';\n    \n    public function getFile(array $dir = [], bool $deep=true)\n    {\n        if(empty($dir)) return false;\n        while (count($dir) > 0 && $path = array_pop($dir)) {\n            # code...\n            if(!is_dir($path)) continue;\n            $handle = opendir($path);\n            while ($file = readdir($handle)) {\n                if($file == '.' || $file == '..') continue;\n                $real_file = $path . '/' . $file;\n                if($deep && is_dir($real_file)) {\n                    $dir[] = $real_file;\n                } else {\n                    yield $file => file_get_contents($real_file);\n                }\n            }\n            closedir($handle);\n        }\n        return null;\n    }\n    \n    /**\n     *  SVG 源文件生成 SVG 图标文件\n     */\n    public function conver()\n    {\n+       foreach ($this -> getFile($this -> path) as $item => $file)\n-       foreach ($this -> getFile([$this -> path]) as $item => $file)\n        {\n            $file = json_decode($file, true);\n            foreach ($file['data'] as $key => $value)\n            {\n                if(empty($value['slug'])) $value['slug'] = $item;\n                // 保存文件\n                Icon::saveFile('icon/icon/'.$file['slug'], $value['name'], $value['show_svg'], 'svg');\n                sleep(1);\n            }\n        }\n    }\n\t\n}\n\n// 获取 svg 源文件图标\n//(new Icon) -> collection();\n\n// 导出 源文件到svg 图标文件\n(new IconToSvg()) -> conver();\n```\n","source":"_posts/阿里图标库爬虫.md","raw":"---\ntitle: 阿里图标库爬虫\ndate: 2018-06-07 15:56:08\ntags: [记录, 爬虫]\ncategories: 代码\n---\n\n> 该爬虫仅作学习交流分享\n\n<!--more-->\n\n```PHP diff:true\n/**\n * 阿里图标库素材爬虫\n * Author：Hui\n * Date：18/06/07\n * Time：14:22\n */\nclass Icon \n{\n    // 图标分类集合\n    CONST COLLECTIONS_URL = \"http://iconfont.cn/api/collections.json?\";\n    // 分类详情\n    CONST COLLECTIONS_DETAIL_URL = \"http://iconfont.cn/api/collection/detail.json?\";\n    // 爬取的初始页数\n    public $page = 1;\n    // 每页爬取的数量\n    public $limit = 9;\n\t\n+    // 认证信息\n+    public $ctoken = '6LQwjc6zvc9P5knLf9LMicon-font';\n\t\n    // 图标分类集合\n    public function collection()\n    {\n        $url = self::COLLECTIONS_URL . \"type=4&sort=time&limit=\".$this -> limit.\"&page=\".$this -> page.\"&keyword=&t=1528351142196&ctoken=\".$this -> ctoken;\n        $collections = $this -> request($url);\n        self::saveFile('icon', 'log', $collections, 'log');\n        $collections_arr = json_decode($collections, true);\n        // 页数记录日志\n        @array_unshift($collections_arr, ['page'=> $this -> page]);\n        if($collections_arr['code'] == 200) {\n            self::saveFile('icon', 'collection_lists', $collections_arr);\n            $this -> getListDetail($collections_arr['data']['lists']);\n        } else {\n            self::saveFile('icon', 'error_collection', $collections_arr, 'log');\n            echo '提取失败'; \n            return false;\n        }\n+       sleep(5); // 间隔爬取\n        if(ceil($collections_arr['data']['count'] / $this -> limit) > $this -> page) {\n            $this -> page += 1;\n            $this -> collection();\n        }\n    }\n\t\n    // 分类详情\n    public function getListDetail($lists)\n    {\n        foreach ($lists as $key => $value) \n        {\n            $url =  self::COLLECTIONS_DETAIL_URL . \"id=\" . $value['id'].\"&t=1528352609403&ctoken=\" . $this -> ctoken;\n            $icons = $this -> request($url);\n            $icons_arr = json_decode($icons, true);\n            if($icons_arr['code'] == 200) {\n                $cate = $icons_arr['data']['collection']['name'];\n                $slug = $icons_arr['data']['collection']['slug'];\n                $data = $icons_arr['data']['icons'];\n                self::saveFile('icon/cate', $cate, ['slug'=> $slug, 'data'=> $data]);\n            } else {\n                self::saveFile('icon', 'error_detail', $icons_arr, 'log');\n            }\n        }\n        \n    }\n\t\n    public function request($url)\n    {\n          $curl = curl_init();\n          curl_setopt_array($curl, array(\n          CURLOPT_URL => $url,\n          CURLOPT_RETURNTRANSFER => true,\n          CURLOPT_ENCODING => \"\",\n          CURLOPT_MAXREDIRS => 10,\n          CURLOPT_TIMEOUT => 30,\n          CURLOPT_HTTP_VERSION => CURL_HTTP_VERSION_1_1,\n          CURLOPT_CUSTOMREQUEST => \"GET\",\n          CURLOPT_HTTPHEADER => array(\n+           \"Cookie: cna=5BdjEtZmvXcCAXJwfKJoE/H4; ctoken=$this -> ctoken; trace=AQAAAKn2MUvYlgYAfjhI3636rvjKjRtI; EGG_SESS=Jy6H0NqsswjXTGxPm7tDsBXmfSCQsVxkM0P6_YvCY0U6eqzm1xar-rSrDYL16dovQD3JbIUf6wyM_iE5RvVhxcXR3QRHilxa7hA_7HO1dPf8dNLmGXnH50MptGouw16S-uzeG7PRQKiNoKr-4f2FhcUHFPYgJPfhiTLjmdM22TE=; isg=BPT0I8QQEz_FhIZT7Fy0CplOxbKmZRjDZcwowI5VgH8C-ZRDtt3oR6qbfTEhGlAP\"\n-           \"Cookie: cna=5BdjEtZmvXcCAXJwfKJoE/H4; ctoken=6LQwjc6zvc9P5knLf9LMicon-font; trace=AQAAAKn2MUvYlgYAfjhI3636rvjKjRtI; EGG_SESS=Jy6H0NqsswjXTGxPm7tDsBXmfSCQsVxkM0P6_YvCY0U6eqzm1xar-rSrDYL16dovQD3JbIUf6wyM_iE5RvVhxcXR3QRHilxa7hA_7HO1dPf8dNLmGXnH50MptGouw16S-uzeG7PRQKiNoKr-4f2FhcUHFPYgJPfhiTLjmdM22TE=; isg=BPT0I8QQEz_FhIZT7Fy0CplOxbKmZRjDZcwowI5VgH8C-ZRDtt3oR6qbfTEhGlAP\"\n          ),\n        ));\n        \n        $response = curl_exec($curl);\n        curl_close($curl);\n        return $response;\n    }\n\t\n    /**\n     * 保存文件到指定目录\n     */\n    public static function saveFile($path, $filename, $content,$saveType = 'json', $mode = 'w')\n    {\n        // 创建目录\n        if(!is_dir($path)) self::createDir($path);\n        if(is_array($content)) $content = json_encode($content);\n        $handle = fopen($path .'/'. $filename . '.' . $saveType, $mode);\n        fwrite($handle, $content);\n        fclose($handle);\n    }\n\t\n    /**\n     * 新建目录\n     */\n    private static function createDir($path)\n    {\n        if (is_dir($path) || @mkdir($path)) return True;\n        if ( !self::createDir(dirname($path))) return False;\n        return mkdir($path);\n    }\n    \n}\n\n/********************************************/\n\nclass IconToSvg\n{\n    // 文件目录\n+   public $path = ['icon/cate0', 'icon/cate1'];\n-   public $path = 'icon/cate0';\n    \n    public function getFile(array $dir = [], bool $deep=true)\n    {\n        if(empty($dir)) return false;\n        while (count($dir) > 0 && $path = array_pop($dir)) {\n            # code...\n            if(!is_dir($path)) continue;\n            $handle = opendir($path);\n            while ($file = readdir($handle)) {\n                if($file == '.' || $file == '..') continue;\n                $real_file = $path . '/' . $file;\n                if($deep && is_dir($real_file)) {\n                    $dir[] = $real_file;\n                } else {\n                    yield $file => file_get_contents($real_file);\n                }\n            }\n            closedir($handle);\n        }\n        return null;\n    }\n    \n    /**\n     *  SVG 源文件生成 SVG 图标文件\n     */\n    public function conver()\n    {\n+       foreach ($this -> getFile($this -> path) as $item => $file)\n-       foreach ($this -> getFile([$this -> path]) as $item => $file)\n        {\n            $file = json_decode($file, true);\n            foreach ($file['data'] as $key => $value)\n            {\n                if(empty($value['slug'])) $value['slug'] = $item;\n                // 保存文件\n                Icon::saveFile('icon/icon/'.$file['slug'], $value['name'], $value['show_svg'], 'svg');\n                sleep(1);\n            }\n        }\n    }\n\t\n}\n\n// 获取 svg 源文件图标\n//(new Icon) -> collection();\n\n// 导出 源文件到svg 图标文件\n(new IconToSvg()) -> conver();\n```\n","slug":"阿里图标库爬虫","published":1,"updated":"2018-11-08T04:19:01.069Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjopirm7f000s2cwm9vmn1mii","content":"<blockquote>\n<p>该爬虫仅作学习交流分享</p>\n</blockquote>\n<a id=\"more\"></a>\n<figure class=\"highlight php\"><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div><div class=\"line\">117</div><div class=\"line\">118</div><div class=\"line\">119</div><div class=\"line\">120</div><div class=\"line\">121</div><div class=\"line\">122</div><div class=\"line\">123</div><div class=\"line\">124</div><div class=\"line\">125</div><div class=\"line\">126</div><div class=\"line\">127</div><div class=\"line\">128</div><div class=\"line\">129</div><div class=\"line\">130</div><div class=\"line\">131</div><div class=\"line\">132</div><div class=\"line\">133</div><div class=\"line\">134</div><div class=\"line\">135</div><div class=\"line\">136</div><div class=\"line\">137</div><div class=\"line\">138</div><div class=\"line\">139</div><div class=\"line\">140</div><div class=\"line\">141</div><div class=\"line\">142</div><div class=\"line\">143</div><div class=\"line\">144</div><div class=\"line\">145</div><div class=\"line\">146</div><div class=\"line\">147</div><div class=\"line\">148</div><div class=\"line\">149</div><div class=\"line\">150</div><div class=\"line\">151</div><div class=\"line\">152</div><div class=\"line\">153</div><div class=\"line\">154</div><div class=\"line\">155</div><div class=\"line\">156</div><div class=\"line\">157</div><div class=\"line\">158</div><div class=\"line\">159</div><div class=\"line\">160</div><div class=\"line\">161</div><div class=\"line\">162</div><div class=\"line\">163</div><div class=\"line\">164</div><div class=\"line\">165</div><div class=\"line\">166</div></pre></div><div class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"><span class=\"comment\"> * 阿里图标库素材爬虫</span></div><div class=\"line\"><span class=\"comment\"> * Author：Hui</span></div><div class=\"line\"><span class=\"comment\"> * Date：18/06/07</span></div><div class=\"line\"><span class=\"comment\"> * Time：14:22</span></div><div class=\"line\"><span class=\"comment\"> */</span></div><div class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Icon</span> </span></div><div class=\"line\"><span class=\"class\"></span>&#123;</div><div class=\"line\">    <span class=\"comment\">// 图标分类集合</span></div><div class=\"line\">    <span class=\"keyword\">CONST</span> COLLECTIONS_URL = <span class=\"string\">\"http://iconfont.cn/api/collections.json?\"</span>;</div><div class=\"line\">    <span class=\"comment\">// 分类详情</span></div><div class=\"line\">    <span class=\"keyword\">CONST</span> COLLECTIONS_DETAIL_URL = <span class=\"string\">\"http://iconfont.cn/api/collection/detail.json?\"</span>;</div><div class=\"line\">    <span class=\"comment\">// 爬取的初始页数</span></div><div class=\"line\">    <span class=\"keyword\">public</span> $page = <span class=\"number\">1</span>;</div><div class=\"line\">    <span class=\"comment\">// 每页爬取的数量</span></div><div class=\"line\">    <span class=\"keyword\">public</span> $limit = <span class=\"number\">9</span>;</div><div class=\"line\">\t</div><div class=\"line diff-addition\">    <span class=\"comment\">// 认证信息</span></div><div class=\"line diff-addition\">    <span class=\"keyword\">public</span> $ctoken = <span class=\"string\">'6LQwjc6zvc9P5knLf9LMicon-font'</span>;</div><div class=\"line\">\t</div><div class=\"line\">    <span class=\"comment\">// 图标分类集合</span></div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">collection</span><span class=\"params\">()</span></span></div><div class=\"line\"><span class=\"function\">    </span>&#123;</div><div class=\"line\">        $url = <span class=\"keyword\">self</span>::COLLECTIONS_URL . <span class=\"string\">\"type=4&amp;sort=time&amp;limit=\"</span>.<span class=\"keyword\">$this</span> -&gt; limit.<span class=\"string\">\"&amp;page=\"</span>.<span class=\"keyword\">$this</span> -&gt; page.<span class=\"string\">\"&amp;keyword=&amp;t=1528351142196&amp;ctoken=\"</span>.<span class=\"keyword\">$this</span> -&gt; ctoken;</div><div class=\"line\">        $collections = <span class=\"keyword\">$this</span> -&gt; request($url);</div><div class=\"line\">        <span class=\"keyword\">self</span>::saveFile(<span class=\"string\">'icon'</span>, <span class=\"string\">'log'</span>, $collections, <span class=\"string\">'log'</span>);</div><div class=\"line\">        $collections_arr = json_decode($collections, <span class=\"keyword\">true</span>);</div><div class=\"line\">        <span class=\"comment\">// 页数记录日志</span></div><div class=\"line\">        @array_unshift($collections_arr, [<span class=\"string\">'page'</span>=&gt; <span class=\"keyword\">$this</span> -&gt; page]);</div><div class=\"line\">        <span class=\"keyword\">if</span>($collections_arr[<span class=\"string\">'code'</span>] == <span class=\"number\">200</span>) &#123;</div><div class=\"line\">            <span class=\"keyword\">self</span>::saveFile(<span class=\"string\">'icon'</span>, <span class=\"string\">'collection_lists'</span>, $collections_arr);</div><div class=\"line\">            <span class=\"keyword\">$this</span> -&gt; getListDetail($collections_arr[<span class=\"string\">'data'</span>][<span class=\"string\">'lists'</span>]);</div><div class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">            <span class=\"keyword\">self</span>::saveFile(<span class=\"string\">'icon'</span>, <span class=\"string\">'error_collection'</span>, $collections_arr, <span class=\"string\">'log'</span>);</div><div class=\"line\">            <span class=\"keyword\">echo</span> <span class=\"string\">'提取失败'</span>; </div><div class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</div><div class=\"line\">        &#125;</div><div class=\"line diff-addition\">       sleep(<span class=\"number\">5</span>); <span class=\"comment\">// 间隔爬取</span></div><div class=\"line\">        <span class=\"keyword\">if</span>(ceil($collections_arr[<span class=\"string\">'data'</span>][<span class=\"string\">'count'</span>] / <span class=\"keyword\">$this</span> -&gt; limit) &gt; <span class=\"keyword\">$this</span> -&gt; page) &#123;</div><div class=\"line\">            <span class=\"keyword\">$this</span> -&gt; page += <span class=\"number\">1</span>;</div><div class=\"line\">            <span class=\"keyword\">$this</span> -&gt; collection();</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">\t</div><div class=\"line\">    <span class=\"comment\">// 分类详情</span></div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getListDetail</span><span class=\"params\">($lists)</span></span></div><div class=\"line\"><span class=\"function\">    </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">foreach</span> ($lists <span class=\"keyword\">as</span> $key =&gt; $value) </div><div class=\"line\">        &#123;</div><div class=\"line\">            $url =  <span class=\"keyword\">self</span>::COLLECTIONS_DETAIL_URL . <span class=\"string\">\"id=\"</span> . $value[<span class=\"string\">'id'</span>].<span class=\"string\">\"&amp;t=1528352609403&amp;ctoken=\"</span> . <span class=\"keyword\">$this</span> -&gt; ctoken;</div><div class=\"line\">            $icons = <span class=\"keyword\">$this</span> -&gt; request($url);</div><div class=\"line\">            $icons_arr = json_decode($icons, <span class=\"keyword\">true</span>);</div><div class=\"line\">            <span class=\"keyword\">if</span>($icons_arr[<span class=\"string\">'code'</span>] == <span class=\"number\">200</span>) &#123;</div><div class=\"line\">                $cate = $icons_arr[<span class=\"string\">'data'</span>][<span class=\"string\">'collection'</span>][<span class=\"string\">'name'</span>];</div><div class=\"line\">                $slug = $icons_arr[<span class=\"string\">'data'</span>][<span class=\"string\">'collection'</span>][<span class=\"string\">'slug'</span>];</div><div class=\"line\">                $data = $icons_arr[<span class=\"string\">'data'</span>][<span class=\"string\">'icons'</span>];</div><div class=\"line\">                <span class=\"keyword\">self</span>::saveFile(<span class=\"string\">'icon/cate'</span>, $cate, [<span class=\"string\">'slug'</span>=&gt; $slug, <span class=\"string\">'data'</span>=&gt; $data]);</div><div class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">                <span class=\"keyword\">self</span>::saveFile(<span class=\"string\">'icon'</span>, <span class=\"string\">'error_detail'</span>, $icons_arr, <span class=\"string\">'log'</span>);</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">        </div><div class=\"line\">    &#125;</div><div class=\"line\">\t</div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">request</span><span class=\"params\">($url)</span></span></div><div class=\"line\"><span class=\"function\">    </span>&#123;</div><div class=\"line\">          $curl = curl_init();</div><div class=\"line\">          curl_setopt_array($curl, <span class=\"keyword\">array</span>(</div><div class=\"line\">          CURLOPT_URL =&gt; $url,</div><div class=\"line\">          CURLOPT_RETURNTRANSFER =&gt; <span class=\"keyword\">true</span>,</div><div class=\"line\">          CURLOPT_ENCODING =&gt; <span class=\"string\">\"\"</span>,</div><div class=\"line\">          CURLOPT_MAXREDIRS =&gt; <span class=\"number\">10</span>,</div><div class=\"line\">          CURLOPT_TIMEOUT =&gt; <span class=\"number\">30</span>,</div><div class=\"line\">          CURLOPT_HTTP_VERSION =&gt; CURL_HTTP_VERSION_1_1,</div><div class=\"line\">          CURLOPT_CUSTOMREQUEST =&gt; <span class=\"string\">\"GET\"</span>,</div><div class=\"line\">          CURLOPT_HTTPHEADER =&gt; <span class=\"keyword\">array</span>(</div><div class=\"line diff-addition\">           <span class=\"string\">\"Cookie: cna=5BdjEtZmvXcCAXJwfKJoE/H4; ctoken=$this -&gt; ctoken; trace=AQAAAKn2MUvYlgYAfjhI3636rvjKjRtI; EGG_SESS=Jy6H0NqsswjXTGxPm7tDsBXmfSCQsVxkM0P6_YvCY0U6eqzm1xar-rSrDYL16dovQD3JbIUf6wyM_iE5RvVhxcXR3QRHilxa7hA_7HO1dPf8dNLmGXnH50MptGouw16S-uzeG7PRQKiNoKr-4f2FhcUHFPYgJPfhiTLjmdM22TE=; isg=BPT0I8QQEz_FhIZT7Fy0CplOxbKmZRjDZcwowI5VgH8C-ZRDtt3oR6qbfTEhGlAP\"</span></div><div class=\"line diff-deletion\">           <span class=\"string\">\"Cookie: cna=5BdjEtZmvXcCAXJwfKJoE/H4; ctoken=6LQwjc6zvc9P5knLf9LMicon-font; trace=AQAAAKn2MUvYlgYAfjhI3636rvjKjRtI; EGG_SESS=Jy6H0NqsswjXTGxPm7tDsBXmfSCQsVxkM0P6_YvCY0U6eqzm1xar-rSrDYL16dovQD3JbIUf6wyM_iE5RvVhxcXR3QRHilxa7hA_7HO1dPf8dNLmGXnH50MptGouw16S-uzeG7PRQKiNoKr-4f2FhcUHFPYgJPfhiTLjmdM22TE=; isg=BPT0I8QQEz_FhIZT7Fy0CplOxbKmZRjDZcwowI5VgH8C-ZRDtt3oR6qbfTEhGlAP\"</span></div><div class=\"line\">          ),</div><div class=\"line\">        ));</div><div class=\"line\">        </div><div class=\"line\">        $response = curl_exec($curl);</div><div class=\"line\">        curl_close($curl);</div><div class=\"line\">        <span class=\"keyword\">return</span> $response;</div><div class=\"line\">    &#125;</div><div class=\"line\">\t</div><div class=\"line\">    <span class=\"comment\">/**</span></div><div class=\"line\"><span class=\"comment\">     * 保存文件到指定目录</span></div><div class=\"line\"><span class=\"comment\">     */</span></div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">saveFile</span><span class=\"params\">($path, $filename, $content,$saveType = <span class=\"string\">'json'</span>, $mode = <span class=\"string\">'w'</span>)</span></span></div><div class=\"line\"><span class=\"function\">    </span>&#123;</div><div class=\"line\">        <span class=\"comment\">// 创建目录</span></div><div class=\"line\">        <span class=\"keyword\">if</span>(!is_dir($path)) <span class=\"keyword\">self</span>::createDir($path);</div><div class=\"line\">        <span class=\"keyword\">if</span>(is_array($content)) $content = json_encode($content);</div><div class=\"line\">        $handle = fopen($path .<span class=\"string\">'/'</span>. $filename . <span class=\"string\">'.'</span> . $saveType, $mode);</div><div class=\"line\">        fwrite($handle, $content);</div><div class=\"line\">        fclose($handle);</div><div class=\"line\">    &#125;</div><div class=\"line\">\t</div><div class=\"line\">    <span class=\"comment\">/**</span></div><div class=\"line\"><span class=\"comment\">     * 新建目录</span></div><div class=\"line\"><span class=\"comment\">     */</span></div><div class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">createDir</span><span class=\"params\">($path)</span></span></div><div class=\"line\"><span class=\"function\">    </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">if</span> (is_dir($path) || @mkdir($path)) <span class=\"keyword\">return</span> <span class=\"keyword\">True</span>;</div><div class=\"line\">        <span class=\"keyword\">if</span> ( !<span class=\"keyword\">self</span>::createDir(dirname($path))) <span class=\"keyword\">return</span> <span class=\"keyword\">False</span>;</div><div class=\"line\">        <span class=\"keyword\">return</span> mkdir($path);</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">/********************************************/</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">IconToSvg</span></span></div><div class=\"line\"><span class=\"class\"></span>&#123;</div><div class=\"line\">    <span class=\"comment\">// 文件目录</span></div><div class=\"line diff-addition\">   <span class=\"keyword\">public</span> $path = [<span class=\"string\">'icon/cate0'</span>, <span class=\"string\">'icon/cate1'</span>];</div><div class=\"line diff-deletion\">   <span class=\"keyword\">public</span> $path = <span class=\"string\">'icon/cate0'</span>;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getFile</span><span class=\"params\">(array $dir = [], bool $deep=true)</span></span></div><div class=\"line\"><span class=\"function\">    </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">if</span>(<span class=\"keyword\">empty</span>($dir)) <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</div><div class=\"line\">        <span class=\"keyword\">while</span> (count($dir) &gt; <span class=\"number\">0</span> &amp;&amp; $path = array_pop($dir)) &#123;</div><div class=\"line\">            <span class=\"comment\"># code...</span></div><div class=\"line\">            <span class=\"keyword\">if</span>(!is_dir($path)) <span class=\"keyword\">continue</span>;</div><div class=\"line\">            $handle = opendir($path);</div><div class=\"line\">            <span class=\"keyword\">while</span> ($file = readdir($handle)) &#123;</div><div class=\"line\">                <span class=\"keyword\">if</span>($file == <span class=\"string\">'.'</span> || $file == <span class=\"string\">'..'</span>) <span class=\"keyword\">continue</span>;</div><div class=\"line\">                $real_file = $path . <span class=\"string\">'/'</span> . $file;</div><div class=\"line\">                <span class=\"keyword\">if</span>($deep &amp;&amp; is_dir($real_file)) &#123;</div><div class=\"line\">                    $dir[] = $real_file;</div><div class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">                    <span class=\"keyword\">yield</span> $file =&gt; file_get_contents($real_file);</div><div class=\"line\">                &#125;</div><div class=\"line\">            &#125;</div><div class=\"line\">            closedir($handle);</div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"comment\">/**</span></div><div class=\"line\"><span class=\"comment\">     *  SVG 源文件生成 SVG 图标文件</span></div><div class=\"line\"><span class=\"comment\">     */</span></div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">conver</span><span class=\"params\">()</span></span></div><div class=\"line\"><span class=\"function\">    </span>&#123;</div><div class=\"line diff-addition\">       <span class=\"keyword\">foreach</span> (<span class=\"keyword\">$this</span> -&gt; getFile(<span class=\"keyword\">$this</span> -&gt; path) <span class=\"keyword\">as</span> $item =&gt; $file)</div><div class=\"line diff-deletion\">       <span class=\"keyword\">foreach</span> (<span class=\"keyword\">$this</span> -&gt; getFile([<span class=\"keyword\">$this</span> -&gt; path]) <span class=\"keyword\">as</span> $item =&gt; $file)</div><div class=\"line\">        &#123;</div><div class=\"line\">            $file = json_decode($file, <span class=\"keyword\">true</span>);</div><div class=\"line\">            <span class=\"keyword\">foreach</span> ($file[<span class=\"string\">'data'</span>] <span class=\"keyword\">as</span> $key =&gt; $value)</div><div class=\"line\">            &#123;</div><div class=\"line\">                <span class=\"keyword\">if</span>(<span class=\"keyword\">empty</span>($value[<span class=\"string\">'slug'</span>])) $value[<span class=\"string\">'slug'</span>] = $item;</div><div class=\"line\">                <span class=\"comment\">// 保存文件</span></div><div class=\"line\">                Icon::saveFile(<span class=\"string\">'icon/icon/'</span>.$file[<span class=\"string\">'slug'</span>], $value[<span class=\"string\">'name'</span>], $value[<span class=\"string\">'show_svg'</span>], <span class=\"string\">'svg'</span>);</div><div class=\"line\">                sleep(<span class=\"number\">1</span>);</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">\t</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// 获取 svg 源文件图标</span></div><div class=\"line\"><span class=\"comment\">//(new Icon) -&gt; collection();</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// 导出 源文件到svg 图标文件</span></div><div class=\"line\">(<span class=\"keyword\">new</span> IconToSvg()) -&gt; conver();</div></pre></div></div></figure>\n","site":{"data":{}},"excerpt":"<blockquote>\n<p>该爬虫仅作学习交流分享</p>\n</blockquote>","more":"<figure class=\"highlight php\"><div class=\"figcode\"><div class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div><div class=\"line\">117</div><div class=\"line\">118</div><div class=\"line\">119</div><div class=\"line\">120</div><div class=\"line\">121</div><div class=\"line\">122</div><div class=\"line\">123</div><div class=\"line\">124</div><div class=\"line\">125</div><div class=\"line\">126</div><div class=\"line\">127</div><div class=\"line\">128</div><div class=\"line\">129</div><div class=\"line\">130</div><div class=\"line\">131</div><div class=\"line\">132</div><div class=\"line\">133</div><div class=\"line\">134</div><div class=\"line\">135</div><div class=\"line\">136</div><div class=\"line\">137</div><div class=\"line\">138</div><div class=\"line\">139</div><div class=\"line\">140</div><div class=\"line\">141</div><div class=\"line\">142</div><div class=\"line\">143</div><div class=\"line\">144</div><div class=\"line\">145</div><div class=\"line\">146</div><div class=\"line\">147</div><div class=\"line\">148</div><div class=\"line\">149</div><div class=\"line\">150</div><div class=\"line\">151</div><div class=\"line\">152</div><div class=\"line\">153</div><div class=\"line\">154</div><div class=\"line\">155</div><div class=\"line\">156</div><div class=\"line\">157</div><div class=\"line\">158</div><div class=\"line\">159</div><div class=\"line\">160</div><div class=\"line\">161</div><div class=\"line\">162</div><div class=\"line\">163</div><div class=\"line\">164</div><div class=\"line\">165</div><div class=\"line\">166</div></pre></div><div class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"><span class=\"comment\"> * 阿里图标库素材爬虫</span></div><div class=\"line\"><span class=\"comment\"> * Author：Hui</span></div><div class=\"line\"><span class=\"comment\"> * Date：18/06/07</span></div><div class=\"line\"><span class=\"comment\"> * Time：14:22</span></div><div class=\"line\"><span class=\"comment\"> */</span></div><div class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Icon</span> </span></div><div class=\"line\"><span class=\"class\"></span>&#123;</div><div class=\"line\">    <span class=\"comment\">// 图标分类集合</span></div><div class=\"line\">    <span class=\"keyword\">CONST</span> COLLECTIONS_URL = <span class=\"string\">\"http://iconfont.cn/api/collections.json?\"</span>;</div><div class=\"line\">    <span class=\"comment\">// 分类详情</span></div><div class=\"line\">    <span class=\"keyword\">CONST</span> COLLECTIONS_DETAIL_URL = <span class=\"string\">\"http://iconfont.cn/api/collection/detail.json?\"</span>;</div><div class=\"line\">    <span class=\"comment\">// 爬取的初始页数</span></div><div class=\"line\">    <span class=\"keyword\">public</span> $page = <span class=\"number\">1</span>;</div><div class=\"line\">    <span class=\"comment\">// 每页爬取的数量</span></div><div class=\"line\">    <span class=\"keyword\">public</span> $limit = <span class=\"number\">9</span>;</div><div class=\"line\">\t</div><div class=\"line diff-addition\">    <span class=\"comment\">// 认证信息</span></div><div class=\"line diff-addition\">    <span class=\"keyword\">public</span> $ctoken = <span class=\"string\">'6LQwjc6zvc9P5knLf9LMicon-font'</span>;</div><div class=\"line\">\t</div><div class=\"line\">    <span class=\"comment\">// 图标分类集合</span></div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">collection</span><span class=\"params\">()</span></span></div><div class=\"line\"><span class=\"function\">    </span>&#123;</div><div class=\"line\">        $url = <span class=\"keyword\">self</span>::COLLECTIONS_URL . <span class=\"string\">\"type=4&amp;sort=time&amp;limit=\"</span>.<span class=\"keyword\">$this</span> -&gt; limit.<span class=\"string\">\"&amp;page=\"</span>.<span class=\"keyword\">$this</span> -&gt; page.<span class=\"string\">\"&amp;keyword=&amp;t=1528351142196&amp;ctoken=\"</span>.<span class=\"keyword\">$this</span> -&gt; ctoken;</div><div class=\"line\">        $collections = <span class=\"keyword\">$this</span> -&gt; request($url);</div><div class=\"line\">        <span class=\"keyword\">self</span>::saveFile(<span class=\"string\">'icon'</span>, <span class=\"string\">'log'</span>, $collections, <span class=\"string\">'log'</span>);</div><div class=\"line\">        $collections_arr = json_decode($collections, <span class=\"keyword\">true</span>);</div><div class=\"line\">        <span class=\"comment\">// 页数记录日志</span></div><div class=\"line\">        @array_unshift($collections_arr, [<span class=\"string\">'page'</span>=&gt; <span class=\"keyword\">$this</span> -&gt; page]);</div><div class=\"line\">        <span class=\"keyword\">if</span>($collections_arr[<span class=\"string\">'code'</span>] == <span class=\"number\">200</span>) &#123;</div><div class=\"line\">            <span class=\"keyword\">self</span>::saveFile(<span class=\"string\">'icon'</span>, <span class=\"string\">'collection_lists'</span>, $collections_arr);</div><div class=\"line\">            <span class=\"keyword\">$this</span> -&gt; getListDetail($collections_arr[<span class=\"string\">'data'</span>][<span class=\"string\">'lists'</span>]);</div><div class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">            <span class=\"keyword\">self</span>::saveFile(<span class=\"string\">'icon'</span>, <span class=\"string\">'error_collection'</span>, $collections_arr, <span class=\"string\">'log'</span>);</div><div class=\"line\">            <span class=\"keyword\">echo</span> <span class=\"string\">'提取失败'</span>; </div><div class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</div><div class=\"line\">        &#125;</div><div class=\"line diff-addition\">       sleep(<span class=\"number\">5</span>); <span class=\"comment\">// 间隔爬取</span></div><div class=\"line\">        <span class=\"keyword\">if</span>(ceil($collections_arr[<span class=\"string\">'data'</span>][<span class=\"string\">'count'</span>] / <span class=\"keyword\">$this</span> -&gt; limit) &gt; <span class=\"keyword\">$this</span> -&gt; page) &#123;</div><div class=\"line\">            <span class=\"keyword\">$this</span> -&gt; page += <span class=\"number\">1</span>;</div><div class=\"line\">            <span class=\"keyword\">$this</span> -&gt; collection();</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">\t</div><div class=\"line\">    <span class=\"comment\">// 分类详情</span></div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getListDetail</span><span class=\"params\">($lists)</span></span></div><div class=\"line\"><span class=\"function\">    </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">foreach</span> ($lists <span class=\"keyword\">as</span> $key =&gt; $value) </div><div class=\"line\">        &#123;</div><div class=\"line\">            $url =  <span class=\"keyword\">self</span>::COLLECTIONS_DETAIL_URL . <span class=\"string\">\"id=\"</span> . $value[<span class=\"string\">'id'</span>].<span class=\"string\">\"&amp;t=1528352609403&amp;ctoken=\"</span> . <span class=\"keyword\">$this</span> -&gt; ctoken;</div><div class=\"line\">            $icons = <span class=\"keyword\">$this</span> -&gt; request($url);</div><div class=\"line\">            $icons_arr = json_decode($icons, <span class=\"keyword\">true</span>);</div><div class=\"line\">            <span class=\"keyword\">if</span>($icons_arr[<span class=\"string\">'code'</span>] == <span class=\"number\">200</span>) &#123;</div><div class=\"line\">                $cate = $icons_arr[<span class=\"string\">'data'</span>][<span class=\"string\">'collection'</span>][<span class=\"string\">'name'</span>];</div><div class=\"line\">                $slug = $icons_arr[<span class=\"string\">'data'</span>][<span class=\"string\">'collection'</span>][<span class=\"string\">'slug'</span>];</div><div class=\"line\">                $data = $icons_arr[<span class=\"string\">'data'</span>][<span class=\"string\">'icons'</span>];</div><div class=\"line\">                <span class=\"keyword\">self</span>::saveFile(<span class=\"string\">'icon/cate'</span>, $cate, [<span class=\"string\">'slug'</span>=&gt; $slug, <span class=\"string\">'data'</span>=&gt; $data]);</div><div class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">                <span class=\"keyword\">self</span>::saveFile(<span class=\"string\">'icon'</span>, <span class=\"string\">'error_detail'</span>, $icons_arr, <span class=\"string\">'log'</span>);</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">        </div><div class=\"line\">    &#125;</div><div class=\"line\">\t</div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">request</span><span class=\"params\">($url)</span></span></div><div class=\"line\"><span class=\"function\">    </span>&#123;</div><div class=\"line\">          $curl = curl_init();</div><div class=\"line\">          curl_setopt_array($curl, <span class=\"keyword\">array</span>(</div><div class=\"line\">          CURLOPT_URL =&gt; $url,</div><div class=\"line\">          CURLOPT_RETURNTRANSFER =&gt; <span class=\"keyword\">true</span>,</div><div class=\"line\">          CURLOPT_ENCODING =&gt; <span class=\"string\">\"\"</span>,</div><div class=\"line\">          CURLOPT_MAXREDIRS =&gt; <span class=\"number\">10</span>,</div><div class=\"line\">          CURLOPT_TIMEOUT =&gt; <span class=\"number\">30</span>,</div><div class=\"line\">          CURLOPT_HTTP_VERSION =&gt; CURL_HTTP_VERSION_1_1,</div><div class=\"line\">          CURLOPT_CUSTOMREQUEST =&gt; <span class=\"string\">\"GET\"</span>,</div><div class=\"line\">          CURLOPT_HTTPHEADER =&gt; <span class=\"keyword\">array</span>(</div><div class=\"line diff-addition\">           <span class=\"string\">\"Cookie: cna=5BdjEtZmvXcCAXJwfKJoE/H4; ctoken=$this -&gt; ctoken; trace=AQAAAKn2MUvYlgYAfjhI3636rvjKjRtI; EGG_SESS=Jy6H0NqsswjXTGxPm7tDsBXmfSCQsVxkM0P6_YvCY0U6eqzm1xar-rSrDYL16dovQD3JbIUf6wyM_iE5RvVhxcXR3QRHilxa7hA_7HO1dPf8dNLmGXnH50MptGouw16S-uzeG7PRQKiNoKr-4f2FhcUHFPYgJPfhiTLjmdM22TE=; isg=BPT0I8QQEz_FhIZT7Fy0CplOxbKmZRjDZcwowI5VgH8C-ZRDtt3oR6qbfTEhGlAP\"</span></div><div class=\"line diff-deletion\">           <span class=\"string\">\"Cookie: cna=5BdjEtZmvXcCAXJwfKJoE/H4; ctoken=6LQwjc6zvc9P5knLf9LMicon-font; trace=AQAAAKn2MUvYlgYAfjhI3636rvjKjRtI; EGG_SESS=Jy6H0NqsswjXTGxPm7tDsBXmfSCQsVxkM0P6_YvCY0U6eqzm1xar-rSrDYL16dovQD3JbIUf6wyM_iE5RvVhxcXR3QRHilxa7hA_7HO1dPf8dNLmGXnH50MptGouw16S-uzeG7PRQKiNoKr-4f2FhcUHFPYgJPfhiTLjmdM22TE=; isg=BPT0I8QQEz_FhIZT7Fy0CplOxbKmZRjDZcwowI5VgH8C-ZRDtt3oR6qbfTEhGlAP\"</span></div><div class=\"line\">          ),</div><div class=\"line\">        ));</div><div class=\"line\">        </div><div class=\"line\">        $response = curl_exec($curl);</div><div class=\"line\">        curl_close($curl);</div><div class=\"line\">        <span class=\"keyword\">return</span> $response;</div><div class=\"line\">    &#125;</div><div class=\"line\">\t</div><div class=\"line\">    <span class=\"comment\">/**</span></div><div class=\"line\"><span class=\"comment\">     * 保存文件到指定目录</span></div><div class=\"line\"><span class=\"comment\">     */</span></div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">saveFile</span><span class=\"params\">($path, $filename, $content,$saveType = <span class=\"string\">'json'</span>, $mode = <span class=\"string\">'w'</span>)</span></span></div><div class=\"line\"><span class=\"function\">    </span>&#123;</div><div class=\"line\">        <span class=\"comment\">// 创建目录</span></div><div class=\"line\">        <span class=\"keyword\">if</span>(!is_dir($path)) <span class=\"keyword\">self</span>::createDir($path);</div><div class=\"line\">        <span class=\"keyword\">if</span>(is_array($content)) $content = json_encode($content);</div><div class=\"line\">        $handle = fopen($path .<span class=\"string\">'/'</span>. $filename . <span class=\"string\">'.'</span> . $saveType, $mode);</div><div class=\"line\">        fwrite($handle, $content);</div><div class=\"line\">        fclose($handle);</div><div class=\"line\">    &#125;</div><div class=\"line\">\t</div><div class=\"line\">    <span class=\"comment\">/**</span></div><div class=\"line\"><span class=\"comment\">     * 新建目录</span></div><div class=\"line\"><span class=\"comment\">     */</span></div><div class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">createDir</span><span class=\"params\">($path)</span></span></div><div class=\"line\"><span class=\"function\">    </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">if</span> (is_dir($path) || @mkdir($path)) <span class=\"keyword\">return</span> <span class=\"keyword\">True</span>;</div><div class=\"line\">        <span class=\"keyword\">if</span> ( !<span class=\"keyword\">self</span>::createDir(dirname($path))) <span class=\"keyword\">return</span> <span class=\"keyword\">False</span>;</div><div class=\"line\">        <span class=\"keyword\">return</span> mkdir($path);</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">/********************************************/</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">IconToSvg</span></span></div><div class=\"line\"><span class=\"class\"></span>&#123;</div><div class=\"line\">    <span class=\"comment\">// 文件目录</span></div><div class=\"line diff-addition\">   <span class=\"keyword\">public</span> $path = [<span class=\"string\">'icon/cate0'</span>, <span class=\"string\">'icon/cate1'</span>];</div><div class=\"line diff-deletion\">   <span class=\"keyword\">public</span> $path = <span class=\"string\">'icon/cate0'</span>;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getFile</span><span class=\"params\">(array $dir = [], bool $deep=true)</span></span></div><div class=\"line\"><span class=\"function\">    </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">if</span>(<span class=\"keyword\">empty</span>($dir)) <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</div><div class=\"line\">        <span class=\"keyword\">while</span> (count($dir) &gt; <span class=\"number\">0</span> &amp;&amp; $path = array_pop($dir)) &#123;</div><div class=\"line\">            <span class=\"comment\"># code...</span></div><div class=\"line\">            <span class=\"keyword\">if</span>(!is_dir($path)) <span class=\"keyword\">continue</span>;</div><div class=\"line\">            $handle = opendir($path);</div><div class=\"line\">            <span class=\"keyword\">while</span> ($file = readdir($handle)) &#123;</div><div class=\"line\">                <span class=\"keyword\">if</span>($file == <span class=\"string\">'.'</span> || $file == <span class=\"string\">'..'</span>) <span class=\"keyword\">continue</span>;</div><div class=\"line\">                $real_file = $path . <span class=\"string\">'/'</span> . $file;</div><div class=\"line\">                <span class=\"keyword\">if</span>($deep &amp;&amp; is_dir($real_file)) &#123;</div><div class=\"line\">                    $dir[] = $real_file;</div><div class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">                    <span class=\"keyword\">yield</span> $file =&gt; file_get_contents($real_file);</div><div class=\"line\">                &#125;</div><div class=\"line\">            &#125;</div><div class=\"line\">            closedir($handle);</div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"comment\">/**</span></div><div class=\"line\"><span class=\"comment\">     *  SVG 源文件生成 SVG 图标文件</span></div><div class=\"line\"><span class=\"comment\">     */</span></div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">conver</span><span class=\"params\">()</span></span></div><div class=\"line\"><span class=\"function\">    </span>&#123;</div><div class=\"line diff-addition\">       <span class=\"keyword\">foreach</span> (<span class=\"keyword\">$this</span> -&gt; getFile(<span class=\"keyword\">$this</span> -&gt; path) <span class=\"keyword\">as</span> $item =&gt; $file)</div><div class=\"line diff-deletion\">       <span class=\"keyword\">foreach</span> (<span class=\"keyword\">$this</span> -&gt; getFile([<span class=\"keyword\">$this</span> -&gt; path]) <span class=\"keyword\">as</span> $item =&gt; $file)</div><div class=\"line\">        &#123;</div><div class=\"line\">            $file = json_decode($file, <span class=\"keyword\">true</span>);</div><div class=\"line\">            <span class=\"keyword\">foreach</span> ($file[<span class=\"string\">'data'</span>] <span class=\"keyword\">as</span> $key =&gt; $value)</div><div class=\"line\">            &#123;</div><div class=\"line\">                <span class=\"keyword\">if</span>(<span class=\"keyword\">empty</span>($value[<span class=\"string\">'slug'</span>])) $value[<span class=\"string\">'slug'</span>] = $item;</div><div class=\"line\">                <span class=\"comment\">// 保存文件</span></div><div class=\"line\">                Icon::saveFile(<span class=\"string\">'icon/icon/'</span>.$file[<span class=\"string\">'slug'</span>], $value[<span class=\"string\">'name'</span>], $value[<span class=\"string\">'show_svg'</span>], <span class=\"string\">'svg'</span>);</div><div class=\"line\">                sleep(<span class=\"number\">1</span>);</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">\t</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// 获取 svg 源文件图标</span></div><div class=\"line\"><span class=\"comment\">//(new Icon) -&gt; collection();</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// 导出 源文件到svg 图标文件</span></div><div class=\"line\">(<span class=\"keyword\">new</span> IconToSvg()) -&gt; conver();</div></pre></div></div></figure>"},{"title":"[转]秒杀架构和优化思路","date":"2018-11-06T08:57:38.000Z","_content":"\n> 转自 “58沈剑-架构师之路”\n> 原文地址：[秒杀系统架构优化思路](https://mp.weixin.qq.com/s?__biz=MjM5ODYxMDA5OQ==&mid=2651959391&idx=1&sn=fb28fd5e5f0895ddb167406d8a735548&scene=21#wechat_redirect)\n> 部分有整理\n\n<!-- more -->\n\n# 秒杀业务为什么难做\n1. IM 系统，例如 QQ 或者 微博 ，『 每个人都读自己的数据 』（好友列表、群列表、个人信息）\n2. 微博系统，每个人读你关注的人的数据，『 一个人读多个人的数据 』\n3. 秒杀系统，库存只有一份，所有人会在集中的时间读和写这些数据，『 多个人读一个数据 』\n\n>例如：小米手机每周二的秒杀，可能手机只有1万部，但瞬时进入的流量可能是几百几千万。\n>又例如：12306抢票，票是有限的，库存一份，瞬时流量非常多，都读相同的库存。 『 读写冲突，锁非常严重，这是秒杀业务难的地方 』 。那我们怎么优化秒杀业务的架构呢？\n\n# 优化方向\n优化方向有两个：\n\n（1）『 将请求尽量拦截在系统上游 』（不要让锁冲突落到数据库上去）。传统秒杀系统之所以挂，请求都压倒了后端数据层，数据读写锁冲突严重，并发高响应慢，几乎所有请求都超时，流量虽大，下单成功的有效流量甚小。以12306为例，一趟火车其实只有2000张票，200w个人来买，基本没有人能买成功，请求有效率为0。\n\n（2）『 充分利用缓存，秒杀买票 』 ，这是一个典型的读多些少的应用场景，大部分请求是车次查询，票查询，下单和支付才是写请求。一趟火车其实只有2000张票，200w个人来买，最多2000个人下单成功，其他人都是查询库存，写比例只有0.1%，读比例占99.9%，非常适合使用缓存来优化。好，后续讲讲怎么个“将请求尽量拦截在系统上游”法，以及怎么个“缓存”法，讲讲细节。\n\n# 常见秒杀架构\n常见的站点架构基本是这样的：  \n``` line_number:false\n       （1）浏览器端   最上层，会执行到一些 JS 代码\n              ↓\n       （2）站点层     这一层会访问后端数据，拼 HTML 页面返回给浏览器\n              ↓\n       （3）服务层     向上游屏蔽底层数据细节，提供数据访问\n              ↓\n       （4）数据层     最终的库存是存在这里的，MySQL 是一个典型（当然还有会缓存）\n```\n这个图虽然简单，但能形象的说明大流量高并发的秒杀业务架构，大家要记得这一张图。 \n\n# 各层次优化细节\n\n## 第一层，客户端怎么优化（浏览器层，APP层）\n问大家一个问题，大家都玩过微信的摇一摇抢红包对吧，『 每次摇一摇，就会往后端发送请求么 』？回顾我们下单抢票的场景，点击了“查询”按钮之后，系统那个卡呀，进度条涨的慢呀，作为用户，我会不自觉的再去点击“查询”，对么？继续点，继续点，点点点。。。有用么？平白无故的增加了系统负载，一个用户点5次，80%的请求是这么多出来的，怎么整？\n\n- **产品层面**，用户点击“查询”或者“购票”后，『 按钮置灰 』 ，禁止用户重复提交请求\n- **JS层面**，限制用户在 『 x秒之内只能提交一次请求 』\nAPP层面，可以做类似的事情，虽然你疯狂的在摇微信，其实x秒才向后端发起一次请求。这就是所谓的“将请求尽量拦截在系统上游”，越上游越好，浏览器层，APP 层就给拦住，这样就能挡住 80%+ 的请求，这种办法只能拦住普通用户（但 99% 的用户是普通用户）对于群内的 『 高端程序员是拦不住的 』 。 FireBug 一抓包， Http 长啥样都知道， JS 是万万拦不住程序员写 For 循环，调用 Http 接口的，这部分请求怎么处理？\n\n## 第二层，站点层面的请求拦截\n怎么拦截？ 『 怎么防止程序员写 For 循环调用 』 ，有去重依据么？ Ip？ Cookie-id？ … 想复杂了，这类业务都需要登录，用 `uid` 即可。 **在站点层面**，『 对 uid 进行请求计数和去重 』 ，甚至不需要统一存储计数，直接站点层内存存储（这样计数会不准，但最简单）。一个 uid ， 5 秒只准透过 1 个请求，这样又能拦住 99% 的 For 循环请求。\n\n 5s 只透过一个请求，其余的请求怎么办？缓存，『 页面缓存 』 ，同一个 uid ，限制访问频度，做页面缓存，x秒内到达站点层的请求，均返回同一页面。同一个 item 的查询，例如车次，做页面缓存，x秒内到达站点层的请求，均返回同一页面。如此限流，既能保证用户有良好的用户体验（没有返回404）又能保证系统的健壮性（利用页面缓存，把请求拦截在站点层了）。\n页面缓存不一定要保证所有站点返回一致的页面，直接放在每个站点的内存也是可以的。优点是简单，坏处是http请求落到不同的站点，返回的车票数据可能不一样，这是站点层的请求拦截与缓存优化。\n\n好，这个方式拦住了写 For 循环发 Http 请求的程序员，有些高端程序员（黑客）控制了 10w 个肉鸡，手里有 10w 个 uid ，同时发请求（先不考虑实名制的问题，小米抢手机不需要实名制），这下怎么办，站点层按照 uid 限流拦不住了。\n\n## 第三层 服务层来拦截（反正就是不要让请求落到数据库上去）\n服务层怎么拦截？大哥，我是服务层，我清楚的知道小米只有1万部手机，我清楚的知道一列火车只有2000张车票，我透 10w 个请求去数据库有什么意义呢？没错，『 请求队列 』\n对于写请求，做请求队列，每次只透有限的写请求去数据层（下订单，支付这样的写业务）\n**1w** 部手机，只透 **1w** 个下单请求去db\n**3k** 张火车票，只透 **3k** 个下单请求去db\n如果均成功再放下一批，如果库存不够则队列里的写请求全部返回“已售完”。 \n\n对于读请求，怎么优化？ Cache 抗，不管是 `Memcached` 还是 `Redis` ，单机抗个每秒 10w 应该都是没什么问题的。如此限流，只有非常少的写请求，和非常少的读缓存mis的请求会透到数据层去，又有 99.9% 的请求被拦住了。\n\n当然，还有业务规则上的一些优化。回想 12306 所做的，分时分段售票，原来统一10点卖票，现在8点，8点半，9点，...每隔半个小时放出一批：将流量摊匀。\n其次，『 数据粒度的优化 』 ：你去购票，对于余票查询这个业务，票剩了58张，还是26张，你真的关注么，其实我们只关心有票和无票？流量大的时候，做一个粗粒度的“有票”“无票”缓存即可。\n第三，一些业务逻辑的异步：例如下单业务与 支付业务的分离。这些优化都是结合 业务 来的，我之前分享过一个观点“ **一切脱离业务的架构设计都是耍流氓** ”架构的优化也要针对业务。\n\n## 最后是数据库层\n浏览器拦截了 80% ，站点层拦截了 99.9% 并做了页面缓存，服务层又做了写请求队列与数据缓存，每次透到数据库层的请求都是可控的。db基本就没什么压力了，闲庭信步，单机也能扛得住，还是那句话，库存是有限的，小米的产能有限，透这么多请求来数据库没有意义。\n\n全部透到数据库， 100w 个下单， 0 个成功，请求有效率 0% 。透 3k 个到数据，全部成功，请求有效率 100% \n\n\n# 总结\n上文应该描述的非常清楚了，没什么总结了，对于秒杀系统，再次重复下我个人经验的两个架构优化思路：\n（1）『 尽量将请求拦截在系统上游 』（越上游越好）\n（2）『 读多写少的常用多使用缓存 』（缓存抗读压力）\n浏览器 和 APP：做限速\n站点层：按照 `uid` 做限速，做页面缓存\n服务层：按照业务做写请求队列控制流量，做数据缓存\n数据层：闲庭信步\n并且：结合业务做优化","source":"_posts/秒杀架构和优化思路.md","raw":"---\ntitle: '[转]秒杀架构和优化思路'\ndate: 2018-11-06 16:57:38\ntags: [PHP, MySQL,服务器]\ncategories: MySQL\n---\n\n> 转自 “58沈剑-架构师之路”\n> 原文地址：[秒杀系统架构优化思路](https://mp.weixin.qq.com/s?__biz=MjM5ODYxMDA5OQ==&mid=2651959391&idx=1&sn=fb28fd5e5f0895ddb167406d8a735548&scene=21#wechat_redirect)\n> 部分有整理\n\n<!-- more -->\n\n# 秒杀业务为什么难做\n1. IM 系统，例如 QQ 或者 微博 ，『 每个人都读自己的数据 』（好友列表、群列表、个人信息）\n2. 微博系统，每个人读你关注的人的数据，『 一个人读多个人的数据 』\n3. 秒杀系统，库存只有一份，所有人会在集中的时间读和写这些数据，『 多个人读一个数据 』\n\n>例如：小米手机每周二的秒杀，可能手机只有1万部，但瞬时进入的流量可能是几百几千万。\n>又例如：12306抢票，票是有限的，库存一份，瞬时流量非常多，都读相同的库存。 『 读写冲突，锁非常严重，这是秒杀业务难的地方 』 。那我们怎么优化秒杀业务的架构呢？\n\n# 优化方向\n优化方向有两个：\n\n（1）『 将请求尽量拦截在系统上游 』（不要让锁冲突落到数据库上去）。传统秒杀系统之所以挂，请求都压倒了后端数据层，数据读写锁冲突严重，并发高响应慢，几乎所有请求都超时，流量虽大，下单成功的有效流量甚小。以12306为例，一趟火车其实只有2000张票，200w个人来买，基本没有人能买成功，请求有效率为0。\n\n（2）『 充分利用缓存，秒杀买票 』 ，这是一个典型的读多些少的应用场景，大部分请求是车次查询，票查询，下单和支付才是写请求。一趟火车其实只有2000张票，200w个人来买，最多2000个人下单成功，其他人都是查询库存，写比例只有0.1%，读比例占99.9%，非常适合使用缓存来优化。好，后续讲讲怎么个“将请求尽量拦截在系统上游”法，以及怎么个“缓存”法，讲讲细节。\n\n# 常见秒杀架构\n常见的站点架构基本是这样的：  \n``` line_number:false\n       （1）浏览器端   最上层，会执行到一些 JS 代码\n              ↓\n       （2）站点层     这一层会访问后端数据，拼 HTML 页面返回给浏览器\n              ↓\n       （3）服务层     向上游屏蔽底层数据细节，提供数据访问\n              ↓\n       （4）数据层     最终的库存是存在这里的，MySQL 是一个典型（当然还有会缓存）\n```\n这个图虽然简单，但能形象的说明大流量高并发的秒杀业务架构，大家要记得这一张图。 \n\n# 各层次优化细节\n\n## 第一层，客户端怎么优化（浏览器层，APP层）\n问大家一个问题，大家都玩过微信的摇一摇抢红包对吧，『 每次摇一摇，就会往后端发送请求么 』？回顾我们下单抢票的场景，点击了“查询”按钮之后，系统那个卡呀，进度条涨的慢呀，作为用户，我会不自觉的再去点击“查询”，对么？继续点，继续点，点点点。。。有用么？平白无故的增加了系统负载，一个用户点5次，80%的请求是这么多出来的，怎么整？\n\n- **产品层面**，用户点击“查询”或者“购票”后，『 按钮置灰 』 ，禁止用户重复提交请求\n- **JS层面**，限制用户在 『 x秒之内只能提交一次请求 』\nAPP层面，可以做类似的事情，虽然你疯狂的在摇微信，其实x秒才向后端发起一次请求。这就是所谓的“将请求尽量拦截在系统上游”，越上游越好，浏览器层，APP 层就给拦住，这样就能挡住 80%+ 的请求，这种办法只能拦住普通用户（但 99% 的用户是普通用户）对于群内的 『 高端程序员是拦不住的 』 。 FireBug 一抓包， Http 长啥样都知道， JS 是万万拦不住程序员写 For 循环，调用 Http 接口的，这部分请求怎么处理？\n\n## 第二层，站点层面的请求拦截\n怎么拦截？ 『 怎么防止程序员写 For 循环调用 』 ，有去重依据么？ Ip？ Cookie-id？ … 想复杂了，这类业务都需要登录，用 `uid` 即可。 **在站点层面**，『 对 uid 进行请求计数和去重 』 ，甚至不需要统一存储计数，直接站点层内存存储（这样计数会不准，但最简单）。一个 uid ， 5 秒只准透过 1 个请求，这样又能拦住 99% 的 For 循环请求。\n\n 5s 只透过一个请求，其余的请求怎么办？缓存，『 页面缓存 』 ，同一个 uid ，限制访问频度，做页面缓存，x秒内到达站点层的请求，均返回同一页面。同一个 item 的查询，例如车次，做页面缓存，x秒内到达站点层的请求，均返回同一页面。如此限流，既能保证用户有良好的用户体验（没有返回404）又能保证系统的健壮性（利用页面缓存，把请求拦截在站点层了）。\n页面缓存不一定要保证所有站点返回一致的页面，直接放在每个站点的内存也是可以的。优点是简单，坏处是http请求落到不同的站点，返回的车票数据可能不一样，这是站点层的请求拦截与缓存优化。\n\n好，这个方式拦住了写 For 循环发 Http 请求的程序员，有些高端程序员（黑客）控制了 10w 个肉鸡，手里有 10w 个 uid ，同时发请求（先不考虑实名制的问题，小米抢手机不需要实名制），这下怎么办，站点层按照 uid 限流拦不住了。\n\n## 第三层 服务层来拦截（反正就是不要让请求落到数据库上去）\n服务层怎么拦截？大哥，我是服务层，我清楚的知道小米只有1万部手机，我清楚的知道一列火车只有2000张车票，我透 10w 个请求去数据库有什么意义呢？没错，『 请求队列 』\n对于写请求，做请求队列，每次只透有限的写请求去数据层（下订单，支付这样的写业务）\n**1w** 部手机，只透 **1w** 个下单请求去db\n**3k** 张火车票，只透 **3k** 个下单请求去db\n如果均成功再放下一批，如果库存不够则队列里的写请求全部返回“已售完”。 \n\n对于读请求，怎么优化？ Cache 抗，不管是 `Memcached` 还是 `Redis` ，单机抗个每秒 10w 应该都是没什么问题的。如此限流，只有非常少的写请求，和非常少的读缓存mis的请求会透到数据层去，又有 99.9% 的请求被拦住了。\n\n当然，还有业务规则上的一些优化。回想 12306 所做的，分时分段售票，原来统一10点卖票，现在8点，8点半，9点，...每隔半个小时放出一批：将流量摊匀。\n其次，『 数据粒度的优化 』 ：你去购票，对于余票查询这个业务，票剩了58张，还是26张，你真的关注么，其实我们只关心有票和无票？流量大的时候，做一个粗粒度的“有票”“无票”缓存即可。\n第三，一些业务逻辑的异步：例如下单业务与 支付业务的分离。这些优化都是结合 业务 来的，我之前分享过一个观点“ **一切脱离业务的架构设计都是耍流氓** ”架构的优化也要针对业务。\n\n## 最后是数据库层\n浏览器拦截了 80% ，站点层拦截了 99.9% 并做了页面缓存，服务层又做了写请求队列与数据缓存，每次透到数据库层的请求都是可控的。db基本就没什么压力了，闲庭信步，单机也能扛得住，还是那句话，库存是有限的，小米的产能有限，透这么多请求来数据库没有意义。\n\n全部透到数据库， 100w 个下单， 0 个成功，请求有效率 0% 。透 3k 个到数据，全部成功，请求有效率 100% \n\n\n# 总结\n上文应该描述的非常清楚了，没什么总结了，对于秒杀系统，再次重复下我个人经验的两个架构优化思路：\n（1）『 尽量将请求拦截在系统上游 』（越上游越好）\n（2）『 读多写少的常用多使用缓存 』（缓存抗读压力）\n浏览器 和 APP：做限速\n站点层：按照 `uid` 做限速，做页面缓存\n服务层：按照业务做写请求队列控制流量，做数据缓存\n数据层：闲庭信步\n并且：结合业务做优化","slug":"秒杀架构和优化思路","published":1,"updated":"2018-11-08T04:19:01.067Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjopirm7k000v2cwmslwrh2lw","content":"<blockquote>\n<p>转自 “58沈剑-架构师之路”<br>原文地址：<a href=\"https://mp.weixin.qq.com/s?__biz=MjM5ODYxMDA5OQ==&amp;mid=2651959391&amp;idx=1&amp;sn=fb28fd5e5f0895ddb167406d8a735548&amp;scene=21#wechat_redirect\" target=\"_blank\" rel=\"noopener\">秒杀系统架构优化思路</a><br>部分有整理</p>\n</blockquote>\n<a id=\"more\"></a>\n<h1 id=\"秒杀业务为什么难做\"><a href=\"#秒杀业务为什么难做\" class=\"headerlink\" title=\"秒杀业务为什么难做\"></a>秒杀业务为什么难做</h1><ol>\n<li>IM 系统，例如 QQ 或者 微博 ，『 每个人都读自己的数据 』（好友列表、群列表、个人信息）</li>\n<li>微博系统，每个人读你关注的人的数据，『 一个人读多个人的数据 』</li>\n<li>秒杀系统，库存只有一份，所有人会在集中的时间读和写这些数据，『 多个人读一个数据 』</li>\n</ol>\n<blockquote>\n<p>例如：小米手机每周二的秒杀，可能手机只有1万部，但瞬时进入的流量可能是几百几千万。<br>又例如：12306抢票，票是有限的，库存一份，瞬时流量非常多，都读相同的库存。 『 读写冲突，锁非常严重，这是秒杀业务难的地方 』 。那我们怎么优化秒杀业务的架构呢？</p>\n</blockquote>\n<h1 id=\"优化方向\"><a href=\"#优化方向\" class=\"headerlink\" title=\"优化方向\"></a>优化方向</h1><p>优化方向有两个：</p>\n<p>（1）『 将请求尽量拦截在系统上游 』（不要让锁冲突落到数据库上去）。传统秒杀系统之所以挂，请求都压倒了后端数据层，数据读写锁冲突严重，并发高响应慢，几乎所有请求都超时，流量虽大，下单成功的有效流量甚小。以12306为例，一趟火车其实只有2000张票，200w个人来买，基本没有人能买成功，请求有效率为0。</p>\n<p>（2）『 充分利用缓存，秒杀买票 』 ，这是一个典型的读多些少的应用场景，大部分请求是车次查询，票查询，下单和支付才是写请求。一趟火车其实只有2000张票，200w个人来买，最多2000个人下单成功，其他人都是查询库存，写比例只有0.1%，读比例占99.9%，非常适合使用缓存来优化。好，后续讲讲怎么个“将请求尽量拦截在系统上游”法，以及怎么个“缓存”法，讲讲细节。</p>\n<h1 id=\"常见秒杀架构\"><a href=\"#常见秒杀架构\" class=\"headerlink\" title=\"常见秒杀架构\"></a>常见秒杀架构</h1><p>常见的站点架构基本是这样的：<br><figure class=\"highlight plain\"><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\">（1）浏览器端   最上层，会执行到一些 JS 代码</div><div class=\"line\">       ↓</div><div class=\"line\">（2）站点层     这一层会访问后端数据，拼 HTML 页面返回给浏览器</div><div class=\"line\">       ↓</div><div class=\"line\">（3）服务层     向上游屏蔽底层数据细节，提供数据访问</div><div class=\"line\">       ↓</div><div class=\"line\">（4）数据层     最终的库存是存在这里的，MySQL 是一个典型（当然还有会缓存）</div></pre></div></div></figure></p>\n<p>这个图虽然简单，但能形象的说明大流量高并发的秒杀业务架构，大家要记得这一张图。 </p>\n<h1 id=\"各层次优化细节\"><a href=\"#各层次优化细节\" class=\"headerlink\" title=\"各层次优化细节\"></a>各层次优化细节</h1><h2 id=\"第一层，客户端怎么优化（浏览器层，APP层）\"><a href=\"#第一层，客户端怎么优化（浏览器层，APP层）\" class=\"headerlink\" title=\"第一层，客户端怎么优化（浏览器层，APP层）\"></a>第一层，客户端怎么优化（浏览器层，APP层）</h2><p>问大家一个问题，大家都玩过微信的摇一摇抢红包对吧，『 每次摇一摇，就会往后端发送请求么 』？回顾我们下单抢票的场景，点击了“查询”按钮之后，系统那个卡呀，进度条涨的慢呀，作为用户，我会不自觉的再去点击“查询”，对么？继续点，继续点，点点点。。。有用么？平白无故的增加了系统负载，一个用户点5次，80%的请求是这么多出来的，怎么整？</p>\n<ul>\n<li><strong>产品层面</strong>，用户点击“查询”或者“购票”后，『 按钮置灰 』 ，禁止用户重复提交请求</li>\n<li><strong>JS层面</strong>，限制用户在 『 x秒之内只能提交一次请求 』<br>APP层面，可以做类似的事情，虽然你疯狂的在摇微信，其实x秒才向后端发起一次请求。这就是所谓的“将请求尽量拦截在系统上游”，越上游越好，浏览器层，APP 层就给拦住，这样就能挡住 80%+ 的请求，这种办法只能拦住普通用户（但 99% 的用户是普通用户）对于群内的 『 高端程序员是拦不住的 』 。 FireBug 一抓包， Http 长啥样都知道， JS 是万万拦不住程序员写 For 循环，调用 Http 接口的，这部分请求怎么处理？</li>\n</ul>\n<h2 id=\"第二层，站点层面的请求拦截\"><a href=\"#第二层，站点层面的请求拦截\" class=\"headerlink\" title=\"第二层，站点层面的请求拦截\"></a>第二层，站点层面的请求拦截</h2><p>怎么拦截？ 『 怎么防止程序员写 For 循环调用 』 ，有去重依据么？ Ip？ Cookie-id？ … 想复杂了，这类业务都需要登录，用 <code>uid</code> 即可。 <strong>在站点层面</strong>，『 对 uid 进行请求计数和去重 』 ，甚至不需要统一存储计数，直接站点层内存存储（这样计数会不准，但最简单）。一个 uid ， 5 秒只准透过 1 个请求，这样又能拦住 99% 的 For 循环请求。</p>\n<p> 5s 只透过一个请求，其余的请求怎么办？缓存，『 页面缓存 』 ，同一个 uid ，限制访问频度，做页面缓存，x秒内到达站点层的请求，均返回同一页面。同一个 item 的查询，例如车次，做页面缓存，x秒内到达站点层的请求，均返回同一页面。如此限流，既能保证用户有良好的用户体验（没有返回404）又能保证系统的健壮性（利用页面缓存，把请求拦截在站点层了）。<br>页面缓存不一定要保证所有站点返回一致的页面，直接放在每个站点的内存也是可以的。优点是简单，坏处是http请求落到不同的站点，返回的车票数据可能不一样，这是站点层的请求拦截与缓存优化。</p>\n<p>好，这个方式拦住了写 For 循环发 Http 请求的程序员，有些高端程序员（黑客）控制了 10w 个肉鸡，手里有 10w 个 uid ，同时发请求（先不考虑实名制的问题，小米抢手机不需要实名制），这下怎么办，站点层按照 uid 限流拦不住了。</p>\n<h2 id=\"第三层-服务层来拦截（反正就是不要让请求落到数据库上去）\"><a href=\"#第三层-服务层来拦截（反正就是不要让请求落到数据库上去）\" class=\"headerlink\" title=\"第三层 服务层来拦截（反正就是不要让请求落到数据库上去）\"></a>第三层 服务层来拦截（反正就是不要让请求落到数据库上去）</h2><p>服务层怎么拦截？大哥，我是服务层，我清楚的知道小米只有1万部手机，我清楚的知道一列火车只有2000张车票，我透 10w 个请求去数据库有什么意义呢？没错，『 请求队列 』<br>对于写请求，做请求队列，每次只透有限的写请求去数据层（下订单，支付这样的写业务）<br><strong>1w</strong> 部手机，只透 <strong>1w</strong> 个下单请求去db<br><strong>3k</strong> 张火车票，只透 <strong>3k</strong> 个下单请求去db<br>如果均成功再放下一批，如果库存不够则队列里的写请求全部返回“已售完”。 </p>\n<p>对于读请求，怎么优化？ Cache 抗，不管是 <code>Memcached</code> 还是 <code>Redis</code> ，单机抗个每秒 10w 应该都是没什么问题的。如此限流，只有非常少的写请求，和非常少的读缓存mis的请求会透到数据层去，又有 99.9% 的请求被拦住了。</p>\n<p>当然，还有业务规则上的一些优化。回想 12306 所做的，分时分段售票，原来统一10点卖票，现在8点，8点半，9点，…每隔半个小时放出一批：将流量摊匀。<br>其次，『 数据粒度的优化 』 ：你去购票，对于余票查询这个业务，票剩了58张，还是26张，你真的关注么，其实我们只关心有票和无票？流量大的时候，做一个粗粒度的“有票”“无票”缓存即可。<br>第三，一些业务逻辑的异步：例如下单业务与 支付业务的分离。这些优化都是结合 业务 来的，我之前分享过一个观点“ <strong>一切脱离业务的架构设计都是耍流氓</strong> ”架构的优化也要针对业务。</p>\n<h2 id=\"最后是数据库层\"><a href=\"#最后是数据库层\" class=\"headerlink\" title=\"最后是数据库层\"></a>最后是数据库层</h2><p>浏览器拦截了 80% ，站点层拦截了 99.9% 并做了页面缓存，服务层又做了写请求队列与数据缓存，每次透到数据库层的请求都是可控的。db基本就没什么压力了，闲庭信步，单机也能扛得住，还是那句话，库存是有限的，小米的产能有限，透这么多请求来数据库没有意义。</p>\n<p>全部透到数据库， 100w 个下单， 0 个成功，请求有效率 0% 。透 3k 个到数据，全部成功，请求有效率 100% </p>\n<h1 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h1><p>上文应该描述的非常清楚了，没什么总结了，对于秒杀系统，再次重复下我个人经验的两个架构优化思路：<br>（1）『 尽量将请求拦截在系统上游 』（越上游越好）<br>（2）『 读多写少的常用多使用缓存 』（缓存抗读压力）<br>浏览器 和 APP：做限速<br>站点层：按照 <code>uid</code> 做限速，做页面缓存<br>服务层：按照业务做写请求队列控制流量，做数据缓存<br>数据层：闲庭信步<br>并且：结合业务做优化</p>\n","site":{"data":{}},"excerpt":"<blockquote>\n<p>转自 “58沈剑-架构师之路”<br>原文地址：<a href=\"https://mp.weixin.qq.com/s?__biz=MjM5ODYxMDA5OQ==&amp;mid=2651959391&amp;idx=1&amp;sn=fb28fd5e5f0895ddb167406d8a735548&amp;scene=21#wechat_redirect\" target=\"_blank\" rel=\"noopener\">秒杀系统架构优化思路</a><br>部分有整理</p>\n</blockquote>","more":"<h1 id=\"秒杀业务为什么难做\"><a href=\"#秒杀业务为什么难做\" class=\"headerlink\" title=\"秒杀业务为什么难做\"></a>秒杀业务为什么难做</h1><ol>\n<li>IM 系统，例如 QQ 或者 微博 ，『 每个人都读自己的数据 』（好友列表、群列表、个人信息）</li>\n<li>微博系统，每个人读你关注的人的数据，『 一个人读多个人的数据 』</li>\n<li>秒杀系统，库存只有一份，所有人会在集中的时间读和写这些数据，『 多个人读一个数据 』</li>\n</ol>\n<blockquote>\n<p>例如：小米手机每周二的秒杀，可能手机只有1万部，但瞬时进入的流量可能是几百几千万。<br>又例如：12306抢票，票是有限的，库存一份，瞬时流量非常多，都读相同的库存。 『 读写冲突，锁非常严重，这是秒杀业务难的地方 』 。那我们怎么优化秒杀业务的架构呢？</p>\n</blockquote>\n<h1 id=\"优化方向\"><a href=\"#优化方向\" class=\"headerlink\" title=\"优化方向\"></a>优化方向</h1><p>优化方向有两个：</p>\n<p>（1）『 将请求尽量拦截在系统上游 』（不要让锁冲突落到数据库上去）。传统秒杀系统之所以挂，请求都压倒了后端数据层，数据读写锁冲突严重，并发高响应慢，几乎所有请求都超时，流量虽大，下单成功的有效流量甚小。以12306为例，一趟火车其实只有2000张票，200w个人来买，基本没有人能买成功，请求有效率为0。</p>\n<p>（2）『 充分利用缓存，秒杀买票 』 ，这是一个典型的读多些少的应用场景，大部分请求是车次查询，票查询，下单和支付才是写请求。一趟火车其实只有2000张票，200w个人来买，最多2000个人下单成功，其他人都是查询库存，写比例只有0.1%，读比例占99.9%，非常适合使用缓存来优化。好，后续讲讲怎么个“将请求尽量拦截在系统上游”法，以及怎么个“缓存”法，讲讲细节。</p>\n<h1 id=\"常见秒杀架构\"><a href=\"#常见秒杀架构\" class=\"headerlink\" title=\"常见秒杀架构\"></a>常见秒杀架构</h1><p>常见的站点架构基本是这样的：<br><figure class=\"highlight plain\"><div class=\"figcode\"><div class=\"code\"><pre><div class=\"line\">（1）浏览器端   最上层，会执行到一些 JS 代码</div><div class=\"line\">       ↓</div><div class=\"line\">（2）站点层     这一层会访问后端数据，拼 HTML 页面返回给浏览器</div><div class=\"line\">       ↓</div><div class=\"line\">（3）服务层     向上游屏蔽底层数据细节，提供数据访问</div><div class=\"line\">       ↓</div><div class=\"line\">（4）数据层     最终的库存是存在这里的，MySQL 是一个典型（当然还有会缓存）</div></pre></div></div></figure></p>\n<p>这个图虽然简单，但能形象的说明大流量高并发的秒杀业务架构，大家要记得这一张图。 </p>\n<h1 id=\"各层次优化细节\"><a href=\"#各层次优化细节\" class=\"headerlink\" title=\"各层次优化细节\"></a>各层次优化细节</h1><h2 id=\"第一层，客户端怎么优化（浏览器层，APP层）\"><a href=\"#第一层，客户端怎么优化（浏览器层，APP层）\" class=\"headerlink\" title=\"第一层，客户端怎么优化（浏览器层，APP层）\"></a>第一层，客户端怎么优化（浏览器层，APP层）</h2><p>问大家一个问题，大家都玩过微信的摇一摇抢红包对吧，『 每次摇一摇，就会往后端发送请求么 』？回顾我们下单抢票的场景，点击了“查询”按钮之后，系统那个卡呀，进度条涨的慢呀，作为用户，我会不自觉的再去点击“查询”，对么？继续点，继续点，点点点。。。有用么？平白无故的增加了系统负载，一个用户点5次，80%的请求是这么多出来的，怎么整？</p>\n<ul>\n<li><strong>产品层面</strong>，用户点击“查询”或者“购票”后，『 按钮置灰 』 ，禁止用户重复提交请求</li>\n<li><strong>JS层面</strong>，限制用户在 『 x秒之内只能提交一次请求 』<br>APP层面，可以做类似的事情，虽然你疯狂的在摇微信，其实x秒才向后端发起一次请求。这就是所谓的“将请求尽量拦截在系统上游”，越上游越好，浏览器层，APP 层就给拦住，这样就能挡住 80%+ 的请求，这种办法只能拦住普通用户（但 99% 的用户是普通用户）对于群内的 『 高端程序员是拦不住的 』 。 FireBug 一抓包， Http 长啥样都知道， JS 是万万拦不住程序员写 For 循环，调用 Http 接口的，这部分请求怎么处理？</li>\n</ul>\n<h2 id=\"第二层，站点层面的请求拦截\"><a href=\"#第二层，站点层面的请求拦截\" class=\"headerlink\" title=\"第二层，站点层面的请求拦截\"></a>第二层，站点层面的请求拦截</h2><p>怎么拦截？ 『 怎么防止程序员写 For 循环调用 』 ，有去重依据么？ Ip？ Cookie-id？ … 想复杂了，这类业务都需要登录，用 <code>uid</code> 即可。 <strong>在站点层面</strong>，『 对 uid 进行请求计数和去重 』 ，甚至不需要统一存储计数，直接站点层内存存储（这样计数会不准，但最简单）。一个 uid ， 5 秒只准透过 1 个请求，这样又能拦住 99% 的 For 循环请求。</p>\n<p> 5s 只透过一个请求，其余的请求怎么办？缓存，『 页面缓存 』 ，同一个 uid ，限制访问频度，做页面缓存，x秒内到达站点层的请求，均返回同一页面。同一个 item 的查询，例如车次，做页面缓存，x秒内到达站点层的请求，均返回同一页面。如此限流，既能保证用户有良好的用户体验（没有返回404）又能保证系统的健壮性（利用页面缓存，把请求拦截在站点层了）。<br>页面缓存不一定要保证所有站点返回一致的页面，直接放在每个站点的内存也是可以的。优点是简单，坏处是http请求落到不同的站点，返回的车票数据可能不一样，这是站点层的请求拦截与缓存优化。</p>\n<p>好，这个方式拦住了写 For 循环发 Http 请求的程序员，有些高端程序员（黑客）控制了 10w 个肉鸡，手里有 10w 个 uid ，同时发请求（先不考虑实名制的问题，小米抢手机不需要实名制），这下怎么办，站点层按照 uid 限流拦不住了。</p>\n<h2 id=\"第三层-服务层来拦截（反正就是不要让请求落到数据库上去）\"><a href=\"#第三层-服务层来拦截（反正就是不要让请求落到数据库上去）\" class=\"headerlink\" title=\"第三层 服务层来拦截（反正就是不要让请求落到数据库上去）\"></a>第三层 服务层来拦截（反正就是不要让请求落到数据库上去）</h2><p>服务层怎么拦截？大哥，我是服务层，我清楚的知道小米只有1万部手机，我清楚的知道一列火车只有2000张车票，我透 10w 个请求去数据库有什么意义呢？没错，『 请求队列 』<br>对于写请求，做请求队列，每次只透有限的写请求去数据层（下订单，支付这样的写业务）<br><strong>1w</strong> 部手机，只透 <strong>1w</strong> 个下单请求去db<br><strong>3k</strong> 张火车票，只透 <strong>3k</strong> 个下单请求去db<br>如果均成功再放下一批，如果库存不够则队列里的写请求全部返回“已售完”。 </p>\n<p>对于读请求，怎么优化？ Cache 抗，不管是 <code>Memcached</code> 还是 <code>Redis</code> ，单机抗个每秒 10w 应该都是没什么问题的。如此限流，只有非常少的写请求，和非常少的读缓存mis的请求会透到数据层去，又有 99.9% 的请求被拦住了。</p>\n<p>当然，还有业务规则上的一些优化。回想 12306 所做的，分时分段售票，原来统一10点卖票，现在8点，8点半，9点，…每隔半个小时放出一批：将流量摊匀。<br>其次，『 数据粒度的优化 』 ：你去购票，对于余票查询这个业务，票剩了58张，还是26张，你真的关注么，其实我们只关心有票和无票？流量大的时候，做一个粗粒度的“有票”“无票”缓存即可。<br>第三，一些业务逻辑的异步：例如下单业务与 支付业务的分离。这些优化都是结合 业务 来的，我之前分享过一个观点“ <strong>一切脱离业务的架构设计都是耍流氓</strong> ”架构的优化也要针对业务。</p>\n<h2 id=\"最后是数据库层\"><a href=\"#最后是数据库层\" class=\"headerlink\" title=\"最后是数据库层\"></a>最后是数据库层</h2><p>浏览器拦截了 80% ，站点层拦截了 99.9% 并做了页面缓存，服务层又做了写请求队列与数据缓存，每次透到数据库层的请求都是可控的。db基本就没什么压力了，闲庭信步，单机也能扛得住，还是那句话，库存是有限的，小米的产能有限，透这么多请求来数据库没有意义。</p>\n<p>全部透到数据库， 100w 个下单， 0 个成功，请求有效率 0% 。透 3k 个到数据，全部成功，请求有效率 100% </p>\n<h1 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h1><p>上文应该描述的非常清楚了，没什么总结了，对于秒杀系统，再次重复下我个人经验的两个架构优化思路：<br>（1）『 尽量将请求拦截在系统上游 』（越上游越好）<br>（2）『 读多写少的常用多使用缓存 』（缓存抗读压力）<br>浏览器 和 APP：做限速<br>站点层：按照 <code>uid</code> 做限速，做页面缓存<br>服务层：按照业务做写请求队列控制流量，做数据缓存<br>数据层：闲庭信步<br>并且：结合业务做优化</p>"}],"PostAsset":[],"PostCategory":[{"post_id":"cjopirm5w00022cwmsoclm12b","category_id":"cjopirm6f000a2cwmcvhv7r06","_id":"cjopirm78000k2cwmrn6qqxfn"},{"post_id":"cjopirm6800062cwmv9p8pm5f","category_id":"cjopirm6t000g2cwmjqjr27n1","_id":"cjopirm7g000t2cwmu4o29xl8"},{"post_id":"cjopirm75000j2cwmpxfsn7o5","category_id":"cjopirm6t000g2cwmjqjr27n1","_id":"cjopirm7n000w2cwm6vmtcbz4"},{"post_id":"cjopirm7a000n2cwm9byaav3z","category_id":"cjopirm79000l2cwmxhmxkafz","_id":"cjopirm7q00102cwmc9jb9say"},{"post_id":"cjopirm6a00082cwmxeu6adyd","category_id":"cjopirm79000l2cwmxhmxkafz","_id":"cjopirm7r00122cwmguwf6xnl"},{"post_id":"cjopirm6d00092cwm379d78tr","category_id":"cjopirm6t000g2cwmjqjr27n1","_id":"cjopirm7s00142cwmb7j7dc77"},{"post_id":"cjopirm6h000d2cwmt4tarxex","category_id":"cjopirm7o000y2cwmlhg14t1x","_id":"cjopirm7w00192cwmm96e3k9n"},{"post_id":"cjopirm7c000o2cwm6ro92f50","category_id":"cjopirm7s00152cwmolese6xu","_id":"cjopirm7y001c2cwm1txrl6fc"},{"post_id":"cjopirm7f000s2cwm9vmn1mii","category_id":"cjopirm7w001a2cwmf0ajbqgl","_id":"cjopirm82001f2cwm631ofvzg"},{"post_id":"cjopirm7k000v2cwmslwrh2lw","category_id":"cjopirm7o000y2cwmlhg14t1x","_id":"cjopirm86001j2cwmyfvohkys"},{"post_id":"cjopirm5i00002cwmxk5ktn3c","category_id":"cjopirm6t000g2cwmjqjr27n1","_id":"cjoqu0oqe0000qowm53dtfdfi"},{"post_id":"cjopirm6v000i2cwmhn8m1546","category_id":"cjopirm6t000g2cwmjqjr27n1","_id":"cjoqu0oqs0001qowmo7e8kpth"}],"PostTag":[{"post_id":"cjopirm6a00082cwmxeu6adyd","tag_id":"cjopirm6700052cwmnv2th5do","_id":"cjopirm6h000c2cwmq3bk3kj1"},{"post_id":"cjopirm5i00002cwmxk5ktn3c","tag_id":"cjopirm6700052cwmnv2th5do","_id":"cjopirm7k000u2cwmnhz27m4c"},{"post_id":"cjopirm5i00002cwmxk5ktn3c","tag_id":"cjopirm6g000b2cwmaksnfg5t","_id":"cjopirm7o000x2cwmso0rhmwv"},{"post_id":"cjopirm5i00002cwmxk5ktn3c","tag_id":"cjopirm6u000h2cwmct7wzqa6","_id":"cjopirm7r00112cwm5vbt15dg"},{"post_id":"cjopirm5i00002cwmxk5ktn3c","tag_id":"cjopirm79000m2cwmreovuqyk","_id":"cjopirm7s00132cwmozam1j1q"},{"post_id":"cjopirm5w00022cwmsoclm12b","tag_id":"cjopirm6700052cwmnv2th5do","_id":"cjopirm7t00172cwmwvahvifv"},{"post_id":"cjopirm5w00022cwmsoclm12b","tag_id":"cjopirm7p000z2cwm8u9qzhey","_id":"cjopirm7v00182cwmtlmo64b1"},{"post_id":"cjopirm6800062cwmv9p8pm5f","tag_id":"cjopirm7t00162cwman93hls5","_id":"cjopirm84001h2cwmrv5bztgs"},{"post_id":"cjopirm6800062cwmv9p8pm5f","tag_id":"cjopirm7x001b2cwm1az0vkq1","_id":"cjopirm85001i2cwm5nhpjdkg"},{"post_id":"cjopirm6800062cwmv9p8pm5f","tag_id":"cjopirm79000m2cwmreovuqyk","_id":"cjopirm88001l2cwm9du3mope"},{"post_id":"cjopirm6d00092cwm379d78tr","tag_id":"cjopirm7t00162cwman93hls5","_id":"cjopirm8a001n2cwmuqufm9v3"},{"post_id":"cjopirm6d00092cwm379d78tr","tag_id":"cjopirm6700052cwmnv2th5do","_id":"cjopirm8b001o2cwm0nqsfajm"},{"post_id":"cjopirm6d00092cwm379d78tr","tag_id":"cjopirm87001k2cwm68nlhp9j","_id":"cjopirm8d001q2cwm8jpwb7za"},{"post_id":"cjopirm6h000d2cwmt4tarxex","tag_id":"cjopirm89001m2cwmi6blkf59","_id":"cjopirm8d001r2cwm71ffc6jt"},{"post_id":"cjopirm6v000i2cwmhn8m1546","tag_id":"cjopirm6700052cwmnv2th5do","_id":"cjopirm8f001t2cwm1hwfdh00"},{"post_id":"cjopirm6v000i2cwmhn8m1546","tag_id":"cjopirm6g000b2cwmaksnfg5t","_id":"cjopirm8i001u2cwm2iuu07au"},{"post_id":"cjopirm6v000i2cwmhn8m1546","tag_id":"cjopirm8c001p2cwmbvedjn4p","_id":"cjopirm8k001w2cwmg58uhgk9"},{"post_id":"cjopirm75000j2cwmpxfsn7o5","tag_id":"cjopirm7t00162cwman93hls5","_id":"cjopirm8l001y2cwmjcdp1yzx"},{"post_id":"cjopirm75000j2cwmpxfsn7o5","tag_id":"cjopirm87001k2cwm68nlhp9j","_id":"cjopirm8m001z2cwmbshqlof5"},{"post_id":"cjopirm75000j2cwmpxfsn7o5","tag_id":"cjopirm6g000b2cwmaksnfg5t","_id":"cjopirm8o00212cwmxhocrrry"},{"post_id":"cjopirm7a000n2cwm9byaav3z","tag_id":"cjopirm8l001x2cwme52a3iuw","_id":"cjopirm8p00222cwmqjwx7gy7"},{"post_id":"cjopirm7a000n2cwm9byaav3z","tag_id":"cjopirm6700052cwmnv2th5do","_id":"cjopirm8r00242cwmcp81ond9"},{"post_id":"cjopirm7c000o2cwm6ro92f50","tag_id":"cjopirm7t00162cwman93hls5","_id":"cjopirm9100282cwm1n4nxv3y"},{"post_id":"cjopirm7c000o2cwm6ro92f50","tag_id":"cjopirm8q00232cwmsh6mpbig","_id":"cjopirm9100292cwmo3p8ysqj"},{"post_id":"cjopirm7c000o2cwm6ro92f50","tag_id":"cjopirm8s00252cwmrcai9wm4","_id":"cjopirm93002b2cwmbjd9aymh"},{"post_id":"cjopirm7c000o2cwm6ro92f50","tag_id":"cjopirm8u00262cwm40imfmlq","_id":"cjopirm94002c2cwmilidaoo1"},{"post_id":"cjopirm7f000s2cwm9vmn1mii","tag_id":"cjopirm6700052cwmnv2th5do","_id":"cjopirm96002e2cwmhqpayham"},{"post_id":"cjopirm7f000s2cwm9vmn1mii","tag_id":"cjopirm8z00272cwmycyb92vg","_id":"cjopirm97002f2cwmsnuljwvc"},{"post_id":"cjopirm7k000v2cwmslwrh2lw","tag_id":"cjopirm92002a2cwm47m1zdd6","_id":"cjopirm98002g2cwmwagxdv1t"},{"post_id":"cjopirm7k000v2cwmslwrh2lw","tag_id":"cjopirm89001m2cwmi6blkf59","_id":"cjopirm98002h2cwme4na7eqw"},{"post_id":"cjopirm7k000v2cwmslwrh2lw","tag_id":"cjopirm6g000b2cwmaksnfg5t","_id":"cjopirm99002i2cwmcfgutep6"}],"Tag":[{"name":"记录","_id":"cjopirm6700052cwmnv2th5do"},{"name":"服务器","_id":"cjopirm6g000b2cwmaksnfg5t"},{"name":"linux","_id":"cjopirm6u000h2cwmct7wzqa6"},{"name":"CenterOS","_id":"cjopirm79000m2cwmreovuqyk"},{"name":"前端","_id":"cjopirm7p000z2cwm8u9qzhey"},{"name":"Linux","_id":"cjopirm7t00162cwman93hls5"},{"name":"Docker","_id":"cjopirm7x001b2cwm1az0vkq1"},{"name":"命令","_id":"cjopirm87001k2cwm68nlhp9j"},{"name":"MySQL","_id":"cjopirm89001m2cwmi6blkf59"},{"name":"Ubuntu","_id":"cjopirm8c001p2cwmbvedjn4p"},{"name":"博客","_id":"cjopirm8l001x2cwme52a3iuw"},{"name":"Nginx","_id":"cjopirm8q00232cwmsh6mpbig"},{"name":"FastCGI","_id":"cjopirm8s00252cwmrcai9wm4"},{"name":"PHP-FPM","_id":"cjopirm8u00262cwm40imfmlq"},{"name":"爬虫","_id":"cjopirm8z00272cwmycyb92vg"},{"name":"PHP","_id":"cjopirm92002a2cwm47m1zdd6"}]}}